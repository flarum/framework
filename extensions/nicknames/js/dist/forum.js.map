{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/nicknames/webpack/bootstrap","webpack://@flarum/nicknames/webpack/runtime/compat get default export","webpack://@flarum/nicknames/webpack/runtime/define property getters","webpack://@flarum/nicknames/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/nicknames/webpack/runtime/make namespace object","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/utils/extractText')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/FormModal')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/Form')\"","webpack://@flarum/nicknames/./src/forum/components/NicknameModal.js","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@flarum/nicknames/./src/forum/extend.ts","webpack://@flarum/nicknames/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/extractText');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/FormModal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Form');","import app from 'flarum/forum/app';\nimport FormModal from 'flarum/common/components/FormModal';\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nimport Form from 'flarum/common/components/Form';\nexport default class NicknameModal extends FormModal {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.nickname = Stream(app.session.user.displayName());\n  }\n  className() {\n    return 'NickameModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('flarum-nicknames.forum.change_nickname.title');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\"\n    }, m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"input\", {\n      type: \"text\",\n      autocomplete: \"off\",\n      name: \"nickname\",\n      className: \"FormControl\",\n      bidi: this.nickname,\n      disabled: this.loading\n    })), m(\"div\", {\n      className: \"Form-group Form-controls\"\n    }, m(Button, {\n      className: \"Button Button--primary Button--block\",\n      type: \"submit\",\n      loading: this.loading\n    }, app.translator.trans('flarum-nicknames.forum.change_nickname.submit_button')))));\n  }\n  onsubmit(e) {\n    e.preventDefault();\n    if (this.nickname() === app.session.user.displayName()) {\n      this.hide();\n      return;\n    }\n    this.loading = true;\n    app.session.user.save({\n      nickname: this.nickname()\n    }, {\n      errorHandler: this.onerror.bind(this)\n    }).then(this.hide.bind(this)).catch(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n}\nflarum.reg.add('flarum-nicknames', 'forum/components/NicknameModal', NicknameModal);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","import Extend from 'flarum/common/extenders';\nimport User from 'flarum/common/models/User';\nexport default [new Extend.Model(User) //\n.attribute('canEditNickname')];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport extractText from 'flarum/common/utils/extractText';\nimport Stream from 'flarum/common/utils/Stream';\nimport NickNameModal from './components/NicknameModal';\nexport { default as extend } from './extend';\napp.initializers.add('flarum-nicknames', () => {\n  extend('flarum/forum/components/SettingsPage', 'accountItems', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (this.user.canEditNickname()) {\n      items.add('changeNickname', m(Button, {\n        className: \"Button\",\n        onclick: () => app.modal.show(NickNameModal)\n      }, app.translator.trans('flarum-nicknames.forum.settings.change_nickname_button')));\n    }\n  });\n  extend('flarum/common/components/EditUserModal', 'oninit', function () {\n    this.nickname = Stream(this.attrs.user.displayName());\n  });\n  extend('flarum/common/components/EditUserModal', 'fields', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (!this.attrs.user.canEditNickname()) return;\n    items.add('nickname', m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"label\", null, app.translator.trans('flarum-nicknames.forum.edit_user.nicknames_heading')), m(\"input\", {\n      className: \"FormControl\",\n      placeholder: extractText(app.translator.trans('flarum-nicknames.forum.edit_user.nicknames_text')),\n      bidi: this.nickname\n    })), 100);\n  });\n  extend('flarum/common/components/EditUserModal', 'data', function (data) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (!this.attrs.user.canEditNickname()) return;\n    if (this.nickname() !== this.attrs.user.displayName()) {\n      data.nickname = this.nickname();\n    }\n  });\n  extend('flarum/forum/components/SignUpModal', 'oninit', function () {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    this.nickname = Stream(this.attrs.username || '');\n  });\n  extend('flarum/forum/components/SignUpModal', 'onready', function () {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration') && app.forum.attribute('randomizeUsernameOnRegistration')) {\n      this.$('[name=nickname]').select();\n    }\n  });\n  extend('flarum/forum/components/SignUpModal', 'fields', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration')) {\n      items.add('nickname', m(\"div\", {\n        className: \"Form-group\"\n      }, m(\"input\", {\n        className: \"FormControl\",\n        name: \"nickname\",\n        type: \"text\",\n        placeholder: extractText(app.translator.trans('flarum-nicknames.forum.sign_up.nickname_placeholder')),\n        bidi: this.nickname,\n        disabled: this.loading || this.isProvided('nickname'),\n        required: app.forum.attribute('randomizeUsernameOnRegistration')\n      })), 25);\n      if (app.forum.attribute('randomizeUsernameOnRegistration')) {\n        items.remove('username');\n      }\n    }\n  });\n  extend('flarum/forum/components/SignUpModal', 'submitData', function (data) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration')) {\n      data.nickname = this.nickname();\n      if (app.forum.attribute('randomizeUsernameOnRegistration')) {\n        const arr = new Uint32Array(2);\n        crypto.getRandomValues(arr);\n        data.username = arr.join('');\n      }\n    }\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","NicknameModal","oninit","vnode","super","this","nickname","user","displayName","className","title","trans","content","m","type","autocomplete","name","bidi","disabled","loading","onsubmit","e","preventDefault","save","errorHandler","onerror","bind","then","hide","catch","redraw","add","attribute","extend","items","canEditNickname","onclick","show","attrs","placeholder","data","username","$","select","isProvided","required","remove","arr","Uint32Array","crypto","getRandomValues","join"],"sourceRoot":""}