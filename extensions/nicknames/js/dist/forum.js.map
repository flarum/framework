{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/nicknames/webpack/bootstrap","webpack://@flarum/nicknames/webpack/runtime/compat get default export","webpack://@flarum/nicknames/webpack/runtime/define property getters","webpack://@flarum/nicknames/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/nicknames/webpack/runtime/make namespace object","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'forum/app')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/EditUserModal')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'forum/components/SignUpModal')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'forum/components/SettingsPage')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/utils/extractText')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/components/Modal')\"","webpack://@flarum/nicknames/./src/forum/components/NicknameModal.js","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@flarum/nicknames/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@flarum/nicknames/./src/forum/extend.ts","webpack://@flarum/nicknames/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/EditUserModal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/SignUpModal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'forum/components/SettingsPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/extractText');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Modal');","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Stream from 'flarum/common/utils/Stream';\nexport default class NicknameModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.nickname = Stream(app.session.user.displayName());\n  }\n  className() {\n    return 'NickameModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('flarum-nicknames.forum.change_nickname.title');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(\"div\", {\n      className: \"Form Form--centered\"\n    }, m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"input\", {\n      type: \"text\",\n      autocomplete: \"off\",\n      name: \"nickname\",\n      className: \"FormControl\",\n      bidi: this.nickname,\n      disabled: this.loading\n    })), m(\"div\", {\n      className: \"Form-group\"\n    }, m(Button, {\n      className: \"Button Button--primary Button--block\",\n      type: \"submit\",\n      loading: this.loading\n    }, app.translator.trans('flarum-nicknames.forum.change_nickname.submit_button')))));\n  }\n  onsubmit(e) {\n    e.preventDefault();\n    if (this.nickname() === app.session.user.displayName()) {\n      this.hide();\n      return;\n    }\n    this.loading = true;\n    app.session.user.save({\n      nickname: this.nickname()\n    }, {\n      errorHandler: this.onerror.bind(this)\n    }).then(this.hide.bind(this)).catch(() => {\n      this.loading = false;\n      m.redraw();\n    });\n  }\n}\nflarum.reg.add('flarum-nicknames', 'forum/components/NicknameModal', NicknameModal)","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","import Extend from 'flarum/common/extenders';\nimport User from 'flarum/common/models/User';\nexport default [new Extend.Model(User) //\n.attribute('canEditNickname')];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport EditUserModal from 'flarum/common/components/EditUserModal';\nimport SignUpModal from 'flarum/forum/components/SignUpModal';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport extractText from 'flarum/common/utils/extractText';\nimport Stream from 'flarum/common/utils/Stream';\nimport NickNameModal from './components/NicknameModal';\nexport { default as extend } from './extend';\napp.initializers.add('flarum/nicknames', () => {\n  extend(SettingsPage.prototype, 'accountItems', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (this.user.canEditNickname()) {\n      items.add('changeNickname', m(Button, {\n        className: \"Button\",\n        onclick: () => app.modal.show(NickNameModal)\n      }, app.translator.trans('flarum-nicknames.forum.settings.change_nickname_button')));\n    }\n  });\n  extend(EditUserModal.prototype, 'oninit', function () {\n    this.nickname = Stream(this.attrs.user.displayName());\n  });\n  extend(EditUserModal.prototype, 'fields', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (!this.attrs.user.canEditNickname()) return;\n    items.add('nickname', m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"label\", null, app.translator.trans('flarum-nicknames.forum.edit_user.nicknames_heading')), m(\"input\", {\n      className: \"FormControl\",\n      placeholder: extractText(app.translator.trans('flarum-nicknames.forum.edit_user.nicknames_text')),\n      bidi: this.nickname\n    })), 100);\n  });\n  extend(EditUserModal.prototype, 'data', function (data) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (!this.attrs.user.canEditNickname()) return;\n    if (this.nickname() !== this.attrs.user.displayName()) {\n      data.nickname = this.nickname();\n    }\n  });\n  extend(SignUpModal.prototype, 'oninit', function () {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    this.nickname = Stream(this.attrs.username || '');\n  });\n  extend(SignUpModal.prototype, 'onready', function () {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration') && app.forum.attribute('randomizeUsernameOnRegistration')) {\n      this.$('[name=nickname]').select();\n    }\n  });\n  extend(SignUpModal.prototype, 'fields', function (items) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration')) {\n      items.add('nickname', m(\"div\", {\n        className: \"Form-group\"\n      }, m(\"input\", {\n        className: \"FormControl\",\n        name: \"nickname\",\n        type: \"text\",\n        placeholder: extractText(app.translator.trans('flarum-nicknames.forum.sign_up.nickname_placeholder')),\n        bidi: this.nickname,\n        disabled: this.loading || this.isProvided('nickname'),\n        required: app.forum.attribute('randomizeUsernameOnRegistration')\n      })), 25);\n      if (app.forum.attribute('randomizeUsernameOnRegistration')) {\n        items.remove('username');\n      }\n    }\n  });\n  extend(SignUpModal.prototype, 'submitData', function (data) {\n    if (app.forum.attribute('displayNameDriver') !== 'nickname') return;\n    if (app.forum.attribute('setNicknameOnRegistration')) {\n      data.nickname = this.nickname();\n      if (app.forum.attribute('randomizeUsernameOnRegistration')) {\n        const arr = new Uint32Array(2);\n        crypto.getRandomValues(arr);\n        data.username = arr.join('');\n      }\n    }\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","NicknameModal","oninit","vnode","super","this","nickname","className","title","content","m","type","autocomplete","name","bidi","disabled","loading","onsubmit","e","preventDefault","errorHandler","onerror","bind","then","hide","catch","redraw","add","attribute","extend","items","user","canEditNickname","onclick","attrs","displayName","placeholder","data","username","$","select","isProvided","required","remove","arr","Uint32Array","crypto","getRandomValues","join"],"sourceRoot":""}