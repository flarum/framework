(()=>{var t={810:()=>{},347:(t,s,e)=>{"use strict";e.d(s,{l:()=>Ht});const a=flarum.core.compat["forum/app"];var n=e.n(a);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,s,e){return(s=function(t){var s=function(t,s){if("object"!==o(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var a=e.call(t,s);if("object"!==o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===o(s)?s:String(s)}(s))in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}const r=flarum.core.compat["common/app"];var l=e.n(r);class c{constructor(){i(this,"loadedIncludes",void 0)}async load(t){if(void 0===t&&(t=[]),!this.loadedIncludes)return this.query(t);const s=t.filter((t=>!this.loadedIncludes.has(t)));return 0===s.length?Promise.resolve(l().store.all("tags")):this.query(s)}async query(t){return void 0===t&&(t=[]),null!=this.loadedIncludes||(this.loadedIncludes=new Set),l().store.find("tags",{include:t.join(",")}).then((s=>(t.forEach((t=>this.loadedIncludes.add(t))),s)))}}const u=flarum.core.compat["common/extend"],d=flarum.core.compat["forum/components/IndexPage"];var g=e.n(d);const h=flarum.core.compat["common/components/Separator"];var p=e.n(h);const f=flarum.core.compat["common/components/LinkButton"];var T=e.n(f);const y=flarum.core.compat["common/components/Link"];var b=e.n(y);const v=flarum.core.compat["common/utils/classList"];var x=e.n(v);function N(t,s,e){void 0===s&&(s={}),void 0===e&&(e={});const a=t&&t.icon(),{useColor:n=!0}=e;return s.className=x()([s.className,"icon",a?t.icon():"TagIcon"]),t&&n?(s.style=s.style||{},s.style["--color"]=t.color(),a&&(s.style.color=t.color())):t||(s.className+=" untagged"),a?m("i",s):m("span",s)}class w extends(T()){view(t){const s=this.attrs.model,e=s&&s.description(),a=x()("TagLinkButton hasIcon",{child:s.isChild()},this.attrs.className);return m(b(),{className:a,href:this.attrs.route,style:s?{"--color":s.color()}:void 0,title:e||void 0},N(s,{className:"Button-icon"}),m("span",{className:"Button-label"},s?s.name():app.translator.trans("flarum-tags.forum.index.untagged_link")))}static initAttrs(t){super.initAttrs(t);const s=t.model;t.params.tags=s?s.slug():"untagged",t.route=app.route("tag",t.params)}}const _=flarum.core.compat["common/components/Page"];var I=e.n(_);const C=flarum.core.compat["common/components/LoadingIndicator"];var S=e.n(C);const P=flarum.core.compat["common/helpers/listItems"];var D=e.n(P);const L=flarum.core.compat["common/utils/ItemList"];var k=e.n(L);const A=flarum.core.compat["common/helpers/humanTime"];var R=e.n(A);const M=flarum.core.compat["common/helpers/textContrastClass"];var q=e.n(M);const B=flarum.core.compat["common/utils/extract"];var O=e.n(B);function E(t,s){void 0===s&&(s={}),s.style=s.style||{},s.className="TagLabel "+(s.className||"");const e=O()(s,"link"),a=t?t.name():app.translator.trans("flarum-tags.lib.deleted_tag_text");if(t){const a=t.color();a&&(s.style["--tag-bg"]=a,s.className=x()(s.className,"colored",q()(a))),e&&(s.title=t.description()||"",s.href=app.route("tag",{tags:t.slug()})),t.isChild()&&(s.className+=" TagLabel--child")}else s.className+=" untagged";return m(e?b():"span",s,m("span",{className:"TagLabel-text"},t&&t.icon()&&N(t,{className:"TagLabel-icon"},{useColor:!1}),m("span",{className:"TagLabel-name"},a)))}function H(t){return t.slice(0).sort(((t,s)=>{const e=t.position(),a=s.position();if(null===e&&null===a)return s.discussionCount()-t.discussionCount();if(null===a)return-1;if(null===e)return 1;const n=t.parent(),o=s.parent();return n===o?e-a:n&&o?n.position()-o.position():n?n===s?1:n.position()-a:o?o===t?-1:e-o.position():0}))}class j extends(I()){oninit(t){super.oninit(t),app.history.push("tags",app.translator.trans("flarum-tags.forum.header.back_to_tags_tooltip")),this.tags=[];const s=app.preloadedApiDocument();s?this.tags=H(s.filter((t=>!t.isChild()))):(this.loading=!0,app.tagList.load(["children","lastPostedDiscussion","parent"]).then((()=>{this.tags=H(app.store.all("tags").filter((t=>!t.isChild()))),this.loading=!1,m.redraw()})))}oncreate(t){super.oncreate(t),app.setTitle(app.translator.trans("flarum-tags.forum.all_tags.meta_title_text")),app.setTitleCount(0)}view(){return m("div",{className:"TagsPage"},this.pageContent().toArray())}pageContent(){const t=new(k());return t.add("hero",this.hero(),100),t.add("main",m("div",{className:"container"},this.mainContent().toArray()),10),t}mainContent(){const t=new(k());return t.add("sidebar",this.sidebar(),100),t.add("content",this.content(),10),t}content(){return m("div",{className:"TagsPage-content sideNavOffset"},this.contentItems().toArray())}contentItems(){const t=new(k());if(this.loading)t.add("loading",m(S(),null));else{const s=this.tags.filter((t=>null!==t.position())),e=this.tags.filter((t=>null===t.position()));t.add("tagTiles",this.tagTileListView(s),100),e.length&&t.add("cloud",this.cloudView(e),10)}return t}hero(){return g().prototype.hero()}sidebar(){return m("nav",{className:"TagsPage-nav IndexPage-nav sideNav"},m("ul",null,D()(this.sidebarItems().toArray())))}sidebarItems(){return g().prototype.sidebarItems()}tagTileListView(t){return m("ul",{className:"TagTiles"},t.map(this.tagTileView.bind(this)))}tagTileView(t){const s=t.lastPostedDiscussion(),e=H(t.children()||[]);return m("li",{className:x()("TagTile",{colored:t.color()},q()(t.color())),style:{"--tag-bg":t.color()}},m(b(),{className:"TagTile-info",href:app.route.tag(t)},t.icon()&&N(t,{},{useColor:!1}),m("h3",{className:"TagTile-name"},t.name()),m("p",{className:"TagTile-description"},t.description()),!!e&&m("div",{className:"TagTile-children"},e.map((t=>[m(b(),{href:app.route.tag(t)},t.name())," "])))),s?m(b(),{className:"TagTile-lastPostedDiscussion",href:app.route.discussion(s,s.lastPostNumber())},m("span",{className:"TagTile-lastPostedDiscussion-title"},s.title()),R()(s.lastPostedAt())):m("span",{className:"TagTile-lastPostedDiscussion"}))}cloudView(t){return m("div",{className:"TagCloud"},t.map((t=>[E(t,{link:!0})," "])))}}function V(){(0,u.extend)(g().prototype,"navItems",(function(t){if(t.add("tags",m(T(),{icon:"fas fa-th-large",href:n().route("tags")},n().translator.trans("flarum-tags.forum.index.tags_link")),-10),n().current.matches(j))return;t.add("separator",m(p(),null),-12);const s=n().search.stickyParams(),e=n().store.all("tags"),a=this.currentTag(),o=e=>{let n=a===e;!n&&a&&(n=a.parent()===e),t.add("tag"+e.id(),m(w,{model:e,params:s,active:n},null==e?void 0:e.name()),-14)};H(e).filter((t=>null!==t.position()&&(!t.isChild()||a&&(t.parent()===a||t.parent()===a.parent())))).forEach(o);const i=e.filter((t=>null===t.position())).sort(((t,s)=>s.discussionCount()-t.discussionCount()));i.splice(0,3).forEach(o),i.length&&t.add("moreTags",m(T(),{href:n().route("tags")},n().translator.trans("flarum-tags.forum.index.more_link")),-16)}))}const F=flarum.core.compat["forum/states/DiscussionListState"];var K=e.n(F);const $=flarum.core.compat["forum/states/GlobalSearchState"];var U=e.n($);const z=flarum.core.compat["common/Component"];var G=e.n(z);class J extends(G()){view(){const t=this.attrs.model,s=t.color();return m("header",{className:x()("Hero","TagHero",{"TagHero--colored":s,[q()(s)]:s}),style:s?{"--hero-bg":s}:void 0},m("div",{className:"container"},m("div",{className:"containerNarrow"},m("h1",{className:"Hero-title"},t.icon()&&N(t,{},{useColor:!1})," ",t.name()),m("div",{className:"Hero-subtitle"},t.description()))))}}const Q=t=>n().store.all("tags").find((s=>0===s.slug().localeCompare(t,void 0,{sensitivity:"base"})));function W(){g().prototype.currentTag=function(){if(this.currentActiveTag)return this.currentActiveTag;const t=n().search.params().tags;let s=null;if(t&&(s=Q(t)),t&&!s||s&&!s.isChild()&&!s.children()){if(this.currentTagLoading)return;this.currentTagLoading=!0,n().store.find("tags",t,{include:"children,children.parent,parent,state"}).then((()=>{this.currentActiveTag=Q(t),m.redraw()})).finally((()=>{this.currentTagLoading=!1}))}return s?(this.currentActiveTag=s,this.currentActiveTag):void 0},(0,u.override)(g().prototype,"hero",(function(t){const s=this.currentTag();return s?m(J,{model:s}):t()})),(0,u.extend)(g().prototype,"view",(function(t){const s=this.currentTag();s&&(t.attrs.className+=" IndexPage--tag"+s.id())})),(0,u.extend)(g().prototype,"setTitle",(function(){const t=this.currentTag();t&&n().setTitle(t.name())})),(0,u.extend)(g().prototype,"sidebarItems",(function(t){const s=this.currentTag();if(s){const e=s.color(),a=s.canStartDiscussion()||!n().session.user,o=t.get("newDiscussion");e&&(o.attrs.className=x()([o.attrs.className,"Button--tagColored",q()(e)]),o.attrs.style={"--color":e}),o.attrs.disabled=!a,o.children=n().translator.trans(a?"core.forum.index.start_discussion_button":"core.forum.index.cannot_start_discussion_button")}})),(0,u.extend)(U().prototype,"params",(function(t){t.tags=m.route.param("tags")})),(0,u.extend)(K().prototype,"requestParams",(function(t){var s;if("string"==typeof t.include?t.include=[t.include]:null==(s=t.include)||s.push("tags","tags.parent"),this.params.tags){var e;const s=null!=(e=t.filter)?e:{};s.tag=this.params.tags;const a=s.q;a&&(s.q="".concat(a," tag:").concat(this.params.tags)),t.filter=s}}))}const X=flarum.core.compat["forum/components/DiscussionListItem"];var Y=e.n(X);const Z=flarum.core.compat["forum/components/DiscussionHero"];var tt=e.n(Z);function st(t,s){void 0===s&&(s={});const e=[],{link:a,...n}=s;return n.className=x()("TagsLabel",n.className),t?H(t).forEach((s=>{(s||1===t.length)&&e.push(E(s,{link:a}))})):e.push(E()),m("span",n,e)}function et(){(0,u.extend)(Y().prototype,"infoItems",(function(t){const s=this.attrs.discussion.tags();s&&s.length&&t.add("tags",st(s),10)})),(0,u.extend)(tt().prototype,"view",(function(t){const s=H(this.attrs.discussion.tags());if(s&&s.length){const e=s[0].color();e&&(t.attrs.style={"--hero-bg":e},t.attrs.className=x()(t.attrs.className,"DiscussionHero--colored",q()(e)))}})),(0,u.extend)(tt().prototype,"items",(function(t){const s=this.attrs.discussion.tags();s&&s.length&&t.add("tags",st(s,{link:!0}),5)}))}const at=flarum.core.compat["forum/utils/DiscussionControls"];var nt=e.n(at);const ot=flarum.core.compat["common/components/Button"];var it=e.n(ot);const rt=flarum.core.compat["forum/components/DiscussionPage"];var lt=e.n(rt);const ct=flarum.core.compat["common/utils/extractText"];var mt=e.n(ct);function ut(t){let s=app.store.all("tags");return s=t?s.filter((s=>s.canAddToDiscussion()||-1!==t.tags().indexOf(s))):s.filter((t=>t.canStartDiscussion())),s}const dt=flarum.core.compat["common/helpers/highlight"];var gt=e.n(dt);const ht=flarum.core.compat["common/utils/KeyboardNavigatable"];var pt=e.n(ht);const ft=flarum.core.compat["common/components/Modal"];var Tt=e.n(ft);const yt=flarum.core.compat["common/utils/Stream"];var bt=e.n(yt);class vt extends(G()){view(t){const{className:s,isToggled:e,...a}=this.attrs,n=e?"far fa-check-circle":"far fa-circle";return m(it(),Object.assign({},a,{icon:n,className:x()([s,e&&"Button--toggled"])}),t.children)}}class xt extends(Tt()){constructor(){super(...arguments),i(this,"loading",!0),i(this,"tags",void 0),i(this,"selected",[]),i(this,"bypassReqs",!1),i(this,"filter",bt()("")),i(this,"focused",!1),i(this,"navigator",new(pt())),i(this,"indexTag",void 0)}static initAttrs(t){var s,e,a,n,o,i,r,c,m,u,d,g,h,p,f,T,y,b;super.initAttrs(t),t.title||(t.title=mt()(l().translator.trans("flarum-tags.lib.tag_selection_modal.title"))),t.canSelect||(t.canSelect=()=>!0),null!=t.allowResetting||(t.allowResetting=!0),t.limits={min:{total:null!=(s=null==(e=t.limits)||null==(a=e.min)?void 0:a.total)?s:-1/0,primary:null!=(n=null==(o=t.limits)||null==(i=o.min)?void 0:i.primary)?n:-1/0,secondary:null!=(r=null==(c=t.limits)||null==(m=c.min)?void 0:m.secondary)?r:-1/0},max:{total:null!=(u=null==(d=t.limits)||null==(g=d.max)?void 0:g.total)?u:1/0,primary:null!=(h=null==(p=t.limits)||null==(f=p.max)?void 0:f.primary)?h:1/0,secondary:null!=(T=null==(y=t.limits)||null==(b=y.max)?void 0:b.secondary)?T:1/0}},function(t){if(t.min.primary>t.max.primary)throw new Error("The minimum number of primary tags allowed cannot be more than the maximum number of primary tags allowed.");if(t.min.secondary>t.max.secondary)throw new Error("The minimum number of secondary tags allowed cannot be more than the maximum number of secondary tags allowed.");if(t.min.total>t.max.primary+t.max.secondary)throw new Error("The minimum number of tags allowed cannot be more than the maximum number of primary and secondary tags allowed together.");if(t.max.total<t.min.primary+t.min.secondary)throw new Error("The maximum number of tags allowed cannot be less than the minimum number of primary and secondary tags allowed together.");if(t.min.total>t.max.total)throw new Error("The minimum number of tags allowed cannot be more than the maximum number of tags allowed.")}(t.limits)}oninit(t){super.oninit(t),this.navigator.onUp((()=>this.setIndex(this.getCurrentNumericIndex()-1,!0))).onDown((()=>this.setIndex(this.getCurrentNumericIndex()+1,!0))).onSelect(this.select.bind(this)).onRemove((()=>this.selected.splice(this.selected.length-1,1))),l().tagList.load(["parent"]).then((t=>{this.loading=!1,this.attrs.selectableTags&&(t=this.attrs.selectableTags(t)),this.tags=H(t),this.attrs.selectedTags&&this.attrs.selectedTags.map(this.addTag.bind(this)),this.indexTag=t[0],m.redraw()}))}className(){return x()("TagSelectionModal",this.attrs.className)}title(){return this.attrs.title}content(){if(this.loading||!this.tags)return m(S(),null);const t=this.filter().toLowerCase(),s=this.primaryCount(),e=this.secondaryCount(),a=this.getFilteredTags(),n=Math.max(mt()(this.getInstruction(s,e)).length,this.filter().length);return[m("div",{className:"Modal-body"},m("div",{className:"TagSelectionModal-form"},m("div",{className:"TagSelectionModal-form-input"},m("div",{className:"TagsInput FormControl "+(this.focused?"focus":""),onclick:()=>this.$(".TagsInput input").focus()},m("span",{className:"TagsInput-selected"},this.selected.map((t=>m("span",{className:"TagsInput-tag",onclick:()=>{this.removeTag(t),this.onready()}},E(t))))),m("input",{className:"FormControl",placeholder:mt()(this.getInstruction(s,e)),bidi:this.filter,style:{width:n+"ch"},onkeydown:this.navigator.navigate.bind(this.navigator),onfocus:()=>this.focused=!0,onblur:()=>this.focused=!1}))),m("div",{className:"TagSelectionModal-form-submit App-primaryControl"},m(it(),{type:"submit",className:"Button Button--primary",disabled:!this.meetsRequirements(s,e),icon:"fas fa-check"},l().translator.trans("flarum-tags.lib.tag_selection_modal.submit_button"))))),m("div",{className:"Modal-footer"},m("ul",{className:"TagSelectionModal-list SelectTagList"},a.map((s=>m("li",{"data-index":s.id(),className:x()({pinned:null!==s.position(),child:!!s.parent(),colored:!!s.color(),selected:this.selected.includes(s),active:this.indexTag===s}),style:{color:s.color()},onmouseover:()=>this.indexTag=s,onclick:this.toggleTag.bind(this,s)},N(s),m("span",{className:"SelectTagListItem-name"},gt()(s.name(),t)),s.description()?m("span",{className:"SelectTagListItem-description"},s.description()):"")))),this.attrs.limits.allowBypassing&&m("div",{className:"TagSelectionModal-controls"},m(vt,{className:"Button",onclick:()=>this.bypassReqs=!this.bypassReqs,isToggled:this.bypassReqs},l().translator.trans("flarum-tags.lib.tag_selection_modal.bypass_requirements"))))]}getFilteredTags(){const t=this.filter().toLowerCase(),s=this.primaryCount(),e=this.secondaryCount();let a=this.tags;return this.attrs.requireParentTag&&(a=a.filter((t=>{const s=t.parent();return null!==s&&(!1===s||this.selected.includes(s))}))),this.bypassReqs||(this.selected.length>=this.attrs.limits.max.total?a=a.filter((t=>this.selected.includes(t))):(s>=this.attrs.limits.max.primary&&(a=a.filter((t=>!t.isPrimary()||this.selected.includes(t)))),e>=this.attrs.limits.max.secondary&&(a=a.filter((t=>t.isPrimary()||this.selected.includes(t)))))),t&&(a=a.filter((s=>s.name().toLowerCase().includes(t)))),this.indexTag&&a.includes(this.indexTag)||(this.indexTag=a[0]),a}primaryCount(){return this.selected.filter((t=>t.isPrimary())).length}secondaryCount(){return this.selected.filter((t=>!t.isPrimary())).length}meetsRequirements(t,s){return!!(this.bypassReqs||this.attrs.allowResetting&&0===this.selected.length)||!(this.selected.length<this.attrs.limits.min.total)&&t>=this.attrs.limits.min.primary&&s>=this.attrs.limits.min.secondary}addTag(t){if(t&&this.attrs.canSelect(t)){if(this.attrs.onSelect&&this.attrs.onSelect(t,this.selected),this.attrs.requireParentTag){const s=t.parent();s&&!this.selected.includes(s)&&this.selected.push(s)}this.selected.includes(t)||this.selected.push(t)}}removeTag(t){const s=this.selected.indexOf(t);-1!==s&&(this.selected.splice(s,1),this.attrs.requireParentTag&&this.selected.filter((s=>s.parent()===t)).forEach(this.removeTag.bind(this)),this.attrs.onDeselect&&this.attrs.onDeselect(t,this.selected))}toggleTag(t){this.tags&&(this.selected.includes(t)?this.removeTag(t):this.addTag(t),this.filter()&&(this.filter(""),this.indexTag=this.tags[0]),this.onready())}getInstruction(t,s){if(this.bypassReqs)return"";if(t<this.attrs.limits.min.primary){const s=this.attrs.limits.min.primary-t;return mt()(l().translator.trans("flarum-tags.lib.tag_selection_modal.choose_primary_placeholder",{count:s}))}if(s<this.attrs.limits.min.secondary){const t=this.attrs.limits.min.secondary-s;return mt()(l().translator.trans("flarum-tags.lib.tag_selection_modal.choose_secondary_placeholder",{count:t}))}if(this.selected.length<this.attrs.limits.min.total){const t=this.attrs.limits.min.total-this.selected.length;return mt()(l().translator.trans("flarum-tags.lib.tag_selection_modal.choose_tags_placeholder",{count:t}))}return""}onsubmit(t){t.preventDefault(),this.attrs.onsubmit&&this.attrs.onsubmit(this.selected),this.hide()}select(t){t.metaKey||t.ctrlKey||this.indexTag&&this.selected.includes(this.indexTag)?this.selected.length&&this.$('button[type="submit"]').click():this.indexTag&&this.getItem(this.indexTag)[0].dispatchEvent(new Event("click"))}selectableItems(){return this.$(".TagSelectionModal-list > li")}getCurrentNumericIndex(){return this.indexTag?this.selectableItems().index(this.getItem(this.indexTag)):-1}getItem(t){return this.selectableItems().filter('[data-index="'.concat(t.id(),'"]'))}setIndex(t,s){const e=this.selectableItems(),a=e.parent();t<0?t=e.length-1:t>=e.length&&(t=0);const n=e.eq(t);if(this.indexTag=l().store.getById("tags",n.attr("data-index")),m.redraw(),s&&this.indexTag){const t=a.scrollTop(),s=a.offset().top,e=s+a.outerHeight(),o=n.offset().top,i=o+n.outerHeight();let r;o<s?r=t-s+o-parseInt(a.css("padding-top"),10):i>e&&(r=t-e+i+parseInt(a.css("padding-bottom"),10)),void 0!==r&&a.stop(!0).animate({scrollTop:r},100)}}}class Nt extends xt{static initAttrs(t){var s;super.initAttrs(t);const e=t.discussion?n().translator.trans("flarum-tags.forum.choose_tags.edit_title",{title:m("em",null,t.discussion.title())}):n().translator.trans("flarum-tags.forum.choose_tags.title");t.className=x()(t.className,"TagDiscussionModal"),t.title=mt()(e),t.allowResetting=!!n().forum.attribute("canBypassTagCounts"),t.limits={allowBypassing:t.allowResetting,max:{primary:n().forum.attribute("maxPrimaryTags"),secondary:n().forum.attribute("maxSecondaryTags")},min:{primary:n().forum.attribute("minPrimaryTags"),secondary:n().forum.attribute("minSecondaryTags")}},t.requireParentTag=!0,t.selectableTags=()=>ut(t.discussion),null!=t.selectedTags||(t.selectedTags=(null==(s=t.discussion)?void 0:s.tags())||[]),t.canSelect=t=>t.canStartDiscussion();const a=t.onsubmit||null;t.onsubmit=function(s){const e=t.discussion;e&&e.save({relationships:{tags:s}}).then((()=>{n().current.matches(lt())&&n().current.get("stream").update(),m.redraw()})),a&&a(s)}}}function wt(){(0,u.extend)(nt(),"moderationControls",(function(t,s){s.canTag()&&t.add("tags",m(it(),{icon:"fas fa-tag",onclick:()=>app.modal.show(Nt,{discussion:s})},app.translator.trans("flarum-tags.forum.discussion_controls.edit_tags_button")))}))}const _t=flarum.core.compat["forum/components/DiscussionComposer"];var It=e.n(_t);function Ct(){(0,u.extend)(g().prototype,"newDiscussionAction",(function(t){const s=this.currentTag();if(s){const e=s.parent(),a=e?[e,s]:[s];t.then((t=>t.fields.tags=a))}else app.composer.fields.tags=[]})),(0,u.extend)(It().prototype,"oninit",(function(){app.tagList.load(["parent"]).then((()=>m.redraw()))})),It().prototype.chooseTags=function(){ut().length&&app.modal.show(Nt,{selectedTags:(this.composer.fields.tags||[]).slice(0),onsubmit:t=>{this.composer.fields.tags=t,this.$("textarea").focus()}})},(0,u.extend)(It().prototype,"headerItems",(function(t){const s=this.composer.fields.tags||[],e=ut();t.add("tags",m("a",{className:x()(["DiscussionComposer-changeTags",!e.length&&"disabled"]),onclick:this.chooseTags.bind(this)},s.length?st(s):m("span",{className:"TagLabel untagged"},app.translator.trans("flarum-tags.forum.composer_discussion.choose_tags_link"))),10)})),(0,u.override)(It().prototype,"onsubmit",(function(t){const s=this.composer.fields.tags||[],e=s.filter((t=>null!==t.position()&&!t.isChild())),a=s.filter((t=>null===t.position())),n=ut(),o=parseInt(app.forum.attribute("minPrimaryTags")),i=parseInt(app.forum.attribute("minSecondaryTags")),r=parseInt(app.forum.attribute("maxPrimaryTags")),l=parseInt(app.forum.attribute("maxSecondaryTags"));(!s.length&&0!==r&&0!==l||e.length<o||a.length<i)&&n.length?app.modal.show(Nt,{selectedTags:s,onsubmit:s=>{this.composer.fields.tags=s,t()}}):t()})),(0,u.extend)(It().prototype,"data",(function(t){t.relationships=t.relationships||{},t.relationships.tags=this.composer.fields.tags}))}const St=flarum.core.compat["common/extenders"];var Pt=e.n(St);const Dt=flarum.core.compat["common/models/Discussion"];var Lt=e.n(Dt);const kt=flarum.core.compat["forum/components/EventPost"];var At=e.n(kt);class Rt extends(At()){static initAttrs(t){super.initAttrs(t);const s=t.post.content()[0],e=t.post.content()[1];function a(t,s){return t.filter((t=>-1===s.indexOf(t))).map((t=>app.store.getById("tags",t)))}t.tagsAdded=a(e,s),t.tagsRemoved=a(s,e)}icon(){return"fas fa-tag"}descriptionKey(){return this.attrs.tagsAdded.length?this.attrs.tagsRemoved.length?"flarum-tags.forum.post_stream.added_and_removed_tags_text":"flarum-tags.forum.post_stream.added_tags_text":"flarum-tags.forum.post_stream.removed_tags_text"}descriptionData(){const t={};return this.attrs.tagsAdded.length&&(t.tagsAdded=app.translator.trans("flarum-tags.forum.post_stream.tags_text",{tags:st(this.attrs.tagsAdded,{link:!0}),count:this.attrs.tagsAdded.length})),this.attrs.tagsRemoved.length&&(t.tagsRemoved=app.translator.trans("flarum-tags.forum.post_stream.tags_text",{tags:st(this.attrs.tagsRemoved,{link:!0}),count:this.attrs.tagsRemoved.length})),t}}const Mt=flarum.core.compat["common/utils/computed"];var qt=e.n(Mt);const Bt=flarum.core.compat["common/Model"];var Ot=e.n(Bt);class Et extends(Ot()){name(){return Ot().attribute("name").call(this)}slug(){return Ot().attribute("slug").call(this)}description(){return Ot().attribute("description").call(this)}color(){return Ot().attribute("color").call(this)}backgroundUrl(){return Ot().attribute("backgroundUrl").call(this)}backgroundMode(){return Ot().attribute("backgroundMode").call(this)}icon(){return Ot().attribute("icon").call(this)}position(){return Ot().attribute("position").call(this)}parent(){return Ot().hasOne("parent").call(this)}children(){return Ot().hasMany("children").call(this)}defaultSort(){return Ot().attribute("defaultSort").call(this)}isChild(){return Ot().attribute("isChild").call(this)}isHidden(){return Ot().attribute("isHidden").call(this)}discussionCount(){return Ot().attribute("discussionCount").call(this)}lastPostedAt(){return Ot().attribute("lastPostedAt",Ot().transformDate).call(this)}lastPostedDiscussion(){return Ot().hasOne("lastPostedDiscussion").call(this)}isRestricted(){return Ot().attribute("isRestricted").call(this)}canStartDiscussion(){return Ot().attribute("canStartDiscussion").call(this)}canAddToDiscussion(){return Ot().attribute("canAddToDiscussion").call(this)}isPrimary(){return qt()("position","parent",((t,s)=>null!==t&&!1===s)).call(this)}}const Ht=[(new(Pt().Store)).add("tags",Et),(new(Pt().Routes)).add("tags","/tags",j).add("tag","/t/:tags",g()).helper("tag",(t=>n().route("tag",{tags:t.slug()}))),(new(Pt().PostTypes)).add("discussionTagged",Rt),new(Pt().Model)(Lt()).hasMany("tags").attribute("canTag")],jt={"tags/utils/sortTags":H,"tags/models/Tag":Et,"tags/helpers/tagsLabel":st,"tags/helpers/tagIcon":N,"tags/helpers/tagLabel":E,"tags/components/TagSelectionModal":xt,"tags/states/TagListState":c},Vt=Object.assign(jt,{"tags/addTagFilter":W,"tags/addTagControl":wt,"tags/components/TagHero":J,"tags/components/TagDiscussionModal":Nt,"tags/components/TagsPage":j,"tags/components/DiscussionTaggedPost":Rt,"tags/components/TagLinkButton":w,"tags/addTagList":V,"tags/addTagLabels":et,"tags/addTagComposer":Ct,"tags/utils/getSelectableTags":ut}),Ft=flarum.core;n().initializers.add("flarum-tags",(function(){n().tagList=new c,V(),W(),et(),wt(),Ct()})),Object.assign(Ft.compat,Vt)}},s={};function e(a){var n=s[a];if(void 0!==n)return n.exports;var o=s[a]={exports:{}};return t[a](o,o.exports,e),o.exports}e.n=t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},e.d=(t,s)=>{for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},e.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{"use strict";e.r(a),e.d(a,{extend:()=>n.l});var t=e(810),s={};for(const e in t)"default"!==e&&(s[e]=()=>t[e]);e.d(a,s);var n=e(347)})(),module.exports=a})();
//# sourceMappingURL=forum.js.map