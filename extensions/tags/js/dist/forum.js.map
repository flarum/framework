{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/tags/./src/common/compat.js","webpack://@flarum/tags/./src/common/components/TagSelectionModal.tsx","webpack://@flarum/tags/./src/common/helpers/tagIcon.js","webpack://@flarum/tags/./src/common/helpers/tagLabel.js","webpack://@flarum/tags/./src/common/helpers/tagsLabel.js","webpack://@flarum/tags/./src/common/models/Tag.ts","webpack://@flarum/tags/./src/common/states/TagListState.ts","webpack://@flarum/tags/./src/common/utils/sortTags.tsx","webpack://@flarum/tags/./src/forum/addComposerAutocomplete.js","webpack://@flarum/tags/./src/forum/addTagComposer.js","webpack://@flarum/tags/./src/forum/addTagControl.js","webpack://@flarum/tags/./src/forum/addTagFilter.tsx","webpack://@flarum/tags/./src/forum/addTagLabels.js","webpack://@flarum/tags/./src/forum/addTagList.js","webpack://@flarum/tags/./src/forum/compat.js","webpack://@flarum/tags/./src/forum/components/DiscussionTaggedPost.js","webpack://@flarum/tags/./src/forum/components/TagDiscussionModal.tsx","webpack://@flarum/tags/./src/forum/components/TagHero.js","webpack://@flarum/tags/./src/forum/components/TagLinkButton.js","webpack://@flarum/tags/./src/forum/components/TagsPage.js","webpack://@flarum/tags/./src/forum/components/ToggleButton.js","webpack://@flarum/tags/./src/forum/fragments/AutocompleteDropdown.js","webpack://@flarum/tags/./src/forum/index.ts","webpack://@flarum/tags/./src/forum/utils/TagMentionTextGenerator.ts","webpack://@flarum/tags/./src/forum/utils/getSelectableTags.js","webpack://@flarum/tags/./src/forum/utils/textFormatter.js","webpack://@flarum/tags/external assign \"flarum.core\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Component']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Fragment']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Model']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/app']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Separator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/extend']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/KeyboardNavigatable']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/computed']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extract']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/isDark']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/throttleDebounce']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/app']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/EventPost']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/typeof.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/regenerator/index.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/tags/webpack/bootstrap","webpack://@flarum/tags/webpack/runtime/compat get default export","webpack://@flarum/tags/webpack/runtime/define property getters","webpack://@flarum/tags/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/tags/webpack/runtime/make namespace object","webpack://@flarum/tags/./forum.ts"],"sourcesContent":["import sortTags from './utils/sortTags';\nimport Tag from './models/Tag';\nimport tagsLabel from './helpers/tagsLabel';\nimport tagIcon from './helpers/tagIcon';\nimport tagLabel from './helpers/tagLabel';\nimport TagSelectionModal from './components/TagSelectionModal';\nimport TagListState from './states/TagListState';\n\nexport default {\n  'tags/utils/sortTags': sortTags,\n  'tags/models/Tag': Tag,\n  'tags/helpers/tagsLabel': tagsLabel,\n  'tags/helpers/tagIcon': tagIcon,\n  'tags/helpers/tagLabel': tagLabel,\n  'tags/components/TagSelectionModal': TagSelectionModal,\n  'tags/states/TagListState': TagListState,\n};\n","import app from 'flarum/common/app';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport highlight from 'flarum/common/helpers/highlight';\nimport KeyboardNavigatable from 'flarum/common/utils/KeyboardNavigatable';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Modal from 'flarum/common/components/Modal';\nimport Stream from 'flarum/common/utils/Stream';\n\nimport sortTags from '../utils/sortTags';\nimport tagLabel from '../helpers/tagLabel';\nimport tagIcon from '../helpers/tagIcon';\nimport ToggleButton from '../../forum/components/ToggleButton';\n\nimport type Tag from '../models/Tag';\nimport type { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport type Mithril from 'mithril';\n\nexport interface ITagSelectionModalLimits {\n  /** Whether to allow bypassing the limits set here. This will show a toggle button to bypass limits. */\n  allowBypassing?: boolean;\n  /** Maximum number of primary/secondary tags allowed. */\n  max?: {\n    total?: number;\n    primary?: number;\n    secondary?: number;\n  };\n  /** Minimum number of primary/secondary tags to be selected. */\n  min?: {\n    total?: number;\n    primary?: number;\n    secondary?: number;\n  };\n}\n\nexport interface ITagSelectionModalAttrs extends IInternalModalAttrs {\n  /** Custom modal className to use. */\n  className?: string;\n  /** Modal title, defaults to 'Choose Tags'. */\n  title?: string;\n  /** Initial tag selection value. */\n  selectedTags?: Tag[];\n  /** Limits set based on minimum and maximum number of primary/secondary tags that can be selected. */\n  limits?: ITagSelectionModalLimits;\n  /** Whether to allow resetting the value. Defaults to true. */\n  allowResetting?: boolean;\n  /** Whether to require the parent tag of a selected tag to be selected as well. */\n  requireParentTag?: boolean;\n  /** Filter tags that can be selected. */\n  selectableTags?: (tags: Tag[]) => Tag[];\n  /** Whether a tag can be selected. */\n  canSelect: (tag: Tag) => boolean;\n  /** Callback for when a tag is selected. */\n  onSelect?: (tag: Tag, selected: Tag[]) => void;\n  /** Callback for when a tag is deselected. */\n  onDeselect?: (tag: Tag, selected: Tag[]) => void;\n  /** Callback for when the selection is submitted. */\n  onsubmit?: (selected: Tag[]) => void;\n}\n\nexport type ITagSelectionModalState = undefined;\n\nexport default class TagSelectionModal<\n  CustomAttrs extends ITagSelectionModalAttrs = ITagSelectionModalAttrs,\n  CustomState extends ITagSelectionModalState = ITagSelectionModalState\n> extends Modal<CustomAttrs, CustomState> {\n  protected loading = true;\n  protected tags!: Tag[];\n  protected selected: Tag[] = [];\n  protected bypassReqs: boolean = false;\n\n  protected filter = Stream('');\n  protected focused = false;\n  protected navigator = new KeyboardNavigatable();\n  protected indexTag?: Tag;\n\n  static initAttrs(attrs: ITagSelectionModalAttrs) {\n    super.initAttrs(attrs);\n\n    // Default values for optional attributes.\n    attrs.title ||= extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.title'));\n    attrs.canSelect ||= () => true;\n    attrs.allowResetting ??= true;\n    attrs.limits = {\n      min: {\n        total: attrs.limits?.min?.total ?? -Infinity,\n        primary: attrs.limits?.min?.primary ?? -Infinity,\n        secondary: attrs.limits?.min?.secondary ?? -Infinity,\n      },\n      max: {\n        total: attrs.limits?.max?.total ?? Infinity,\n        primary: attrs.limits?.max?.primary ?? Infinity,\n        secondary: attrs.limits?.max?.secondary ?? Infinity,\n      },\n    };\n\n    // Prevent illogical limits from being provided.\n    catchInvalidLimits(attrs.limits);\n  }\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.navigator\n      .onUp(() => this.setIndex(this.getCurrentNumericIndex() - 1, true))\n      .onDown(() => this.setIndex(this.getCurrentNumericIndex() + 1, true))\n      .onSelect(this.select.bind(this))\n      .onRemove(() => this.selected.splice(this.selected.length - 1, 1));\n\n    app.tagList.load(['parent']).then((tags) => {\n      this.loading = false;\n\n      if (this.attrs.selectableTags) {\n        tags = this.attrs.selectableTags(tags);\n      }\n\n      this.tags = sortTags(tags);\n\n      if (this.attrs.selectedTags) {\n        this.attrs.selectedTags.map(this.addTag.bind(this));\n      }\n\n      this.indexTag = tags[0];\n\n      m.redraw();\n    });\n  }\n\n  className() {\n    return classList('TagSelectionModal', this.attrs.className);\n  }\n\n  title() {\n    return this.attrs.title;\n  }\n\n  content() {\n    if (this.loading || !this.tags) {\n      return <LoadingIndicator />;\n    }\n\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n    const tags = this.getFilteredTags();\n\n    const inputWidth = Math.max(extractText(this.getInstruction(primaryCount, secondaryCount)).length, this.filter().length);\n\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"TagSelectionModal-form\">\n          <div className=\"TagSelectionModal-form-input\">\n            <div className={'TagsInput FormControl ' + (this.focused ? 'focus' : '')} onclick={() => this.$('.TagsInput input').focus()}>\n              <span className=\"TagsInput-selected\">\n                {this.selected.map((tag) => (\n                  <span\n                    className=\"TagsInput-tag\"\n                    onclick={() => {\n                      this.removeTag(tag);\n                      this.onready();\n                    }}\n                  >\n                    {tagLabel(tag)}\n                  </span>\n                ))}\n              </span>\n              <input\n                className=\"FormControl\"\n                placeholder={extractText(this.getInstruction(primaryCount, secondaryCount))}\n                bidi={this.filter}\n                style={{ width: inputWidth + 'ch' }}\n                onkeydown={this.navigator.navigate.bind(this.navigator)}\n                onfocus={() => (this.focused = true)}\n                onblur={() => (this.focused = false)}\n              />\n            </div>\n          </div>\n          <div className=\"TagSelectionModal-form-submit App-primaryControl\">\n            <Button\n              type=\"submit\"\n              className=\"Button Button--primary\"\n              disabled={!this.meetsRequirements(primaryCount, secondaryCount)}\n              icon=\"fas fa-check\"\n            >\n              {app.translator.trans('flarum-tags.lib.tag_selection_modal.submit_button')}\n            </Button>\n          </div>\n        </div>\n      </div>,\n\n      <div className=\"Modal-footer\">\n        <ul className=\"TagSelectionModal-list SelectTagList\">\n          {tags.map((tag) => (\n            <li\n              data-index={tag.id()}\n              className={classList({\n                pinned: tag.position() !== null,\n                child: !!tag.parent(),\n                colored: !!tag.color(),\n                selected: this.selected.includes(tag),\n                active: this.indexTag === tag,\n              })}\n              style={{ color: tag.color() }}\n              onmouseover={() => (this.indexTag = tag)}\n              onclick={this.toggleTag.bind(this, tag)}\n            >\n              {tagIcon(tag)}\n              <span className=\"SelectTagListItem-name\">{highlight(tag.name(), filter)}</span>\n              {tag.description() ? <span className=\"SelectTagListItem-description\">{tag.description()}</span> : ''}\n            </li>\n          ))}\n        </ul>\n        {this.attrs.limits!.allowBypassing && (\n          <div className=\"TagSelectionModal-controls\">\n            <ToggleButton className=\"Button\" onclick={() => (this.bypassReqs = !this.bypassReqs)} isToggled={this.bypassReqs}>\n              {app.translator.trans('flarum-tags.lib.tag_selection_modal.bypass_requirements')}\n            </ToggleButton>\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  /**\n   * Filters the available tags on every state change.\n   */\n  private getFilteredTags(): Tag[] {\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n    let tags = this.tags;\n\n    if (this.attrs.requireParentTag) {\n      // Filter out all child tags whose parents have not been selected. This\n      // makes it impossible to select a child if its parent hasn't been selected.\n      tags = tags.filter((tag) => {\n        const parent = tag.parent();\n        return parent !== null && (parent === false || this.selected.includes(parent));\n      });\n    }\n\n    if (!this.bypassReqs) {\n      // If we reached the total maximum number of tags, we can't select anymore.\n      if (this.selected.length >= this.attrs.limits!.max!.total!) {\n        tags = tags.filter((tag) => this.selected.includes(tag));\n      }\n      // If the number of selected primary/secondary tags is at the maximum, then\n      // we'll filter out all other tags of that type.\n      else {\n        if (primaryCount >= this.attrs.limits!.max!.primary!) {\n          tags = tags.filter((tag) => !tag.isPrimary() || this.selected.includes(tag));\n        }\n        if (secondaryCount >= this.attrs.limits!.max!.secondary!) {\n          tags = tags.filter((tag) => tag.isPrimary() || this.selected.includes(tag));\n        }\n      }\n    }\n\n    // If the user has entered text in the filter input, then filter by tags\n    // whose name matches what they've entered.\n    if (filter) {\n      tags = tags.filter((tag) => tag.name().substring(0, filter.length).toLowerCase() === filter);\n    }\n\n    if (!this.indexTag || !tags.includes(this.indexTag)) this.indexTag = tags[0];\n\n    return tags;\n  }\n\n  /**\n   * Counts the number of selected primary tags.\n   */\n  protected primaryCount(): number {\n    return this.selected.filter((tag) => tag.isPrimary()).length;\n  }\n\n  /**\n   * Counts the number of selected secondary tags.\n   */\n  protected secondaryCount(): number {\n    return this.selected.filter((tag) => !tag.isPrimary()).length;\n  }\n\n  /**\n   * Validates the number of selected primary/secondary tags against the set min max limits.\n   */\n  protected meetsRequirements(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs || (this.attrs.allowResetting && this.selected.length === 0)) {\n      return true;\n    }\n\n    if (this.selected.length < this.attrs.limits!.min!.total!) {\n      return false;\n    }\n\n    return primaryCount >= this.attrs.limits!.min!.primary! && secondaryCount >= this.attrs.limits!.min!.secondary!;\n  }\n\n  /**\n   * Add the given tag to the list of selected tags.\n   */\n  protected addTag(tag: Tag | undefined) {\n    if (!tag || !this.attrs.canSelect(tag)) return;\n\n    if (this.attrs.onSelect) {\n      this.attrs.onSelect(tag, this.selected);\n    }\n\n    // If this tag has a parent, we'll also need to add the parent tag to the\n    // selected list if it's not already in there.\n    if (this.attrs.requireParentTag) {\n      const parent = tag.parent();\n      if (parent && !this.selected.includes(parent)) {\n        this.selected.push(parent);\n      }\n    }\n\n    if (!this.selected.includes(tag)) {\n      this.selected.push(tag);\n    }\n  }\n\n  /**\n   * Remove the given tag from the list of selected tags.\n   */\n  protected removeTag(tag: Tag) {\n    const index = this.selected.indexOf(tag);\n\n    if (index !== -1) {\n      this.selected.splice(index, 1);\n\n      // Look through the list of selected tags for any tags which have the tag\n      // we just removed as their parent. We'll need to remove them too.\n      if (this.attrs.requireParentTag) {\n        this.selected.filter((t) => t.parent() === tag).forEach(this.removeTag.bind(this));\n      }\n\n      if (this.attrs.onDeselect) {\n        this.attrs.onDeselect(tag, this.selected);\n      }\n    }\n  }\n\n  protected toggleTag(tag: Tag) {\n    // Won't happen, needed for type safety.\n    if (!this.tags) return;\n\n    if (this.selected.includes(tag)) {\n      this.removeTag(tag);\n    } else {\n      this.addTag(tag);\n    }\n\n    if (this.filter()) {\n      this.filter('');\n      this.indexTag = this.tags[0];\n    }\n\n    this.onready();\n  }\n\n  /**\n   * Gives human text instructions based on the current number of selected tags and set limits.\n   */\n  protected getInstruction(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs) {\n      return '';\n    }\n\n    if (primaryCount < this.attrs.limits!.min!.primary!) {\n      const remaining = this.attrs.limits!.min!.primary! - primaryCount;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_primary_placeholder', { count: remaining }));\n    } else if (secondaryCount < this.attrs.limits!.min!.secondary!) {\n      const remaining = this.attrs.limits!.min!.secondary! - secondaryCount;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_secondary_placeholder', { count: remaining }));\n    } else if (this.selected.length < this.attrs.limits!.min!.total!) {\n      const remaining = this.attrs.limits!.min!.total! - this.selected.length;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_tags_placeholder', { count: remaining }));\n    }\n\n    return '';\n  }\n\n  /**\n   * Submit tag selection.\n   */\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    if (this.attrs.onsubmit) this.attrs.onsubmit(this.selected);\n\n    this.hide();\n  }\n\n  protected select(e: KeyboardEvent) {\n    // Ctrl + Enter submits the selection, just Enter completes the current entry\n    if (e.metaKey || e.ctrlKey || (this.indexTag && this.selected.includes(this.indexTag))) {\n      if (this.selected.length) {\n        // The DOM submit method doesn't emit a `submit event, so we\n        // simulate a manual submission so our `onsubmit` logic is run.\n        this.$('button[type=\"submit\"]').click();\n      }\n    } else if (this.indexTag) {\n      this.getItem(this.indexTag)[0].dispatchEvent(new Event('click'));\n    }\n  }\n\n  protected selectableItems() {\n    return this.$('.TagSelectionModal-list > li');\n  }\n\n  protected getCurrentNumericIndex() {\n    if (!this.indexTag) return -1;\n\n    return this.selectableItems().index(this.getItem(this.indexTag));\n  }\n\n  protected getItem(selectedTag: Tag) {\n    return this.selectableItems().filter(`[data-index=\"${selectedTag.id()}\"]`);\n  }\n\n  protected setIndex(index: number, scrollToItem: boolean) {\n    const $items = this.selectableItems();\n    const $dropdown = $items.parent();\n\n    if (index < 0) {\n      index = $items.length - 1;\n    } else if (index >= $items.length) {\n      index = 0;\n    }\n\n    const $item = $items.eq(index);\n\n    this.indexTag = app.store.getById('tags', $item.attr('data-index')!);\n\n    m.redraw();\n\n    if (scrollToItem && this.indexTag) {\n      const dropdownScroll = $dropdown.scrollTop()!;\n      const dropdownTop = $dropdown.offset()!.top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight()!;\n      const itemTop = $item.offset()!.top;\n      const itemBottom = itemTop + $item.outerHeight()!;\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n\n/**\n * Catch invalid limits provided to the tag selection modal.\n */\nfunction catchInvalidLimits(limits: ITagSelectionModalLimits) {\n  if (limits.min!.primary! > limits.max!.primary!) {\n    throw new Error('The minimum number of primary tags allowed cannot be more than the maximum number of primary tags allowed.');\n  }\n\n  if (limits.min!.secondary! > limits.max!.secondary!) {\n    throw new Error('The minimum number of secondary tags allowed cannot be more than the maximum number of secondary tags allowed.');\n  }\n\n  if (limits.min!.total! > limits.max!.primary! + limits.max!.secondary!) {\n    throw new Error('The minimum number of tags allowed cannot be more than the maximum number of primary and secondary tags allowed together.');\n  }\n\n  if (limits.max!.total! < limits.min!.primary! + limits.min!.secondary!) {\n    throw new Error('The maximum number of tags allowed cannot be less than the minimum number of primary and secondary tags allowed together.');\n  }\n\n  if (limits.min!.total! > limits.max!.total!) {\n    throw new Error('The minimum number of tags allowed cannot be more than the maximum number of tags allowed.');\n  }\n}\n","import classList from 'flarum/common/utils/classList';\n\nexport default function tagIcon(tag, attrs = {}, settings = {}) {\n  const hasIcon = tag && tag.icon();\n  const { useColor = true } = settings;\n\n  attrs.className = classList([attrs.className, 'icon', hasIcon ? tag.icon() : 'TagIcon']);\n\n  if (tag && useColor) {\n    attrs.style = attrs.style || {};\n    attrs.style['--color'] = tag.color();\n\n    if (hasIcon) {\n      attrs.style.color = tag.color();\n    }\n  } else if (!tag) {\n    attrs.className += ' untagged';\n  }\n\n  return hasIcon ? <i {...attrs} /> : <span {...attrs} />;\n}\n","import extract from 'flarum/common/utils/extract';\nimport Link from 'flarum/common/components/Link';\nimport tagIcon from './tagIcon';\n\nexport default function tagLabel(tag, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'TagLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n  const tagText = tag ? tag.name() : app.translator.trans('flarum-tags.lib.deleted_tag_text');\n\n  if (tag) {\n    const color = tag.color();\n    if (color) {\n      attrs.style['--tag-bg'] = color;\n      attrs.className += ' colored';\n    }\n\n    if (link) {\n      attrs.title = tag.description() || '';\n      attrs.href = app.route('tag', { tags: tag.slug() });\n    }\n\n    if (tag.isChild()) {\n      attrs.className += ' TagLabel--child';\n    }\n  } else {\n    attrs.className += ' untagged';\n  }\n\n  return m(\n    link ? Link : 'span',\n    attrs,\n    <span className=\"TagLabel-text\">\n      {tag && tag.icon() && tagIcon(tag, {}, { useColor: false })} {tagText}\n    </span>\n  );\n}\n","import extract from 'flarum/common/utils/extract';\nimport tagLabel from './tagLabel';\nimport sortTags from '../utils/sortTags';\n\nexport default function tagsLabel(tags, attrs = {}) {\n  const children = [];\n  const link = extract(attrs, 'link');\n\n  attrs.className = 'TagsLabel ' + (attrs.className || '');\n\n  if (tags) {\n    sortTags(tags).forEach((tag) => {\n      if (tag || tags.length === 1) {\n        children.push(tagLabel(tag, { link }));\n      }\n    });\n  } else {\n    children.push(tagLabel());\n  }\n\n  return <span {...attrs}>{children}</span>;\n}\n","import computed from 'flarum/common/utils/computed';\nimport Model from 'flarum/common/Model';\nimport type Discussion from 'flarum/common/models/Discussion';\n\nexport default class Tag extends Model {\n  name() {\n    return Model.attribute<string>('name').call(this);\n  }\n  slug() {\n    return Model.attribute<string>('slug').call(this);\n  }\n  description() {\n    return Model.attribute<string | null>('description').call(this);\n  }\n\n  color() {\n    return Model.attribute<string | null>('color').call(this);\n  }\n  backgroundUrl() {\n    return Model.attribute<string | null>('backgroundUrl').call(this);\n  }\n  backgroundMode() {\n    return Model.attribute<string | null>('backgroundMode').call(this);\n  }\n  icon() {\n    return Model.attribute<string | null>('icon').call(this);\n  }\n\n  position() {\n    return Model.attribute<number | null>('position').call(this);\n  }\n  parent() {\n    return Model.hasOne<Tag | null>('parent').call(this);\n  }\n  children() {\n    return Model.hasMany<Tag>('children').call(this);\n  }\n  defaultSort() {\n    return Model.attribute<string | null>('defaultSort').call(this);\n  }\n  isChild() {\n    return Model.attribute<boolean>('isChild').call(this);\n  }\n  isHidden() {\n    return Model.attribute<boolean>('isHidden').call(this);\n  }\n\n  discussionCount() {\n    return Model.attribute<number>('discussionCount').call(this);\n  }\n  lastPostedAt() {\n    return Model.attribute('lastPostedAt', Model.transformDate).call(this);\n  }\n  lastPostedDiscussion() {\n    return Model.hasOne<Discussion | null>('lastPostedDiscussion').call(this);\n  }\n\n  isRestricted() {\n    return Model.attribute<boolean>('isRestricted').call(this);\n  }\n  canStartDiscussion() {\n    return Model.attribute<boolean>('canStartDiscussion').call(this);\n  }\n  canAddToDiscussion() {\n    return Model.attribute<boolean>('canAddToDiscussion').call(this);\n  }\n\n  isPrimary() {\n    return computed<boolean, this>('position', 'parent', (position, parent) => position !== null && parent === false).call(this);\n  }\n}\n","import app from 'flarum/common/app';\nimport type Tag from '../../common/models/Tag';\n\nexport default class TagListState {\n  loadedIncludes = new Set();\n\n  async load(includes: string[] = []): Promise<Tag[]> {\n    const unloadedIncludes = includes.filter((include) => !this.loadedIncludes.has(include));\n\n    if (unloadedIncludes.length === 0) {\n      return Promise.resolve(app.store.all<Tag>('tags'));\n    }\n\n    return app.store.find<Tag[]>('tags', { include: unloadedIncludes.join(',') }).then((val) => {\n      unloadedIncludes.forEach((include) => this.loadedIncludes.add(include));\n      return val;\n    });\n  }\n}\n","import Tag from '../models/Tag';\n\nexport default function sortTags(tags: Tag[]) {\n  return tags.slice(0).sort((a, b) => {\n    const aPos = a.position();\n    const bPos = b.position();\n\n    // If they're both secondary tags, sort them by their discussions count,\n    // descending.\n    if (aPos === null && bPos === null) return b.discussionCount() - a.discussionCount();\n\n    // If just one is a secondary tag, then the primary tag should\n    // come first.\n    if (bPos === null) return -1;\n    if (aPos === null) return 1;\n\n    // If we've made it this far, we know they're both primary tags. So we'll\n    // need to see if they have parents.\n    const aParent = a.parent();\n    const bParent = b.parent();\n\n    // If they both have the same parent, then their positions are local,\n    // so we can compare them directly.\n    if (aParent === bParent) return aPos - bPos;\n    // If they are both child tags, then we will compare the positions of their\n    // parents.\n    else if (aParent && bParent) return aParent.position()! - bParent.position()!;\n    // If we are comparing a child tag with its parent, then we let the parent\n    // come first. If we are comparing an unrelated parent/child, then we\n    // compare both of the parents.\n    else if (aParent) return aParent === b ? 1 : aParent.position()! - bPos;\n    else if (bParent) return bParent === a ? -1 : aPos - bParent.position()!;\n\n    return 0;\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport highlight from 'flarum/common/helpers/highlight';\nimport KeyboardNavigatable from 'flarum/common/utils/KeyboardNavigatable';\nimport { throttle } from 'flarum/common/utils/throttleDebounce';\nimport Badge from 'flarum/common/components/Badge';\n\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport TagMentionTextGenerator from './utils/TagMentionTextGenerator';\n\nconst throttledSearch = throttle(\n  250, // 250ms timeout\n  function (typed, searched, returnedTags, returnedTagIds, dropdown, buildSuggestions) {\n    const typedLower = typed.toLowerCase();\n    if (!searched.includes(typedLower)) {\n      app.store.find('tags', { filter: { q: typed }, page: { limit: 5 } }).then((results) => {\n        results.forEach((u) => {\n          if (!returnedTagIds.has(u.id())) {\n            returnedTagIds.add(u.id());\n            returnedTags.push(u);\n          }\n        });\n\n        buildSuggestions();\n      });\n\n      searched.push(typedLower);\n    }\n  }\n);\n\nexport default function addComposerAutocomplete() {\n  const $container = $('<div class=\"ComposerBody-mentionsDropdownContainer\"></div>');\n  const dropdown = new AutocompleteDropdown();\n\n  extend(TextEditor.prototype, 'oncreate', function () {\n    const $editor = this.$('.TextEditor-editor').wrap('<div class=\"ComposerBody-mentionsWrapper\"></div>');\n\n    this.navigator = new KeyboardNavigatable();\n    this.navigator\n      .when(() => dropdown.active)\n      .onUp(() => dropdown.navigate(-1))\n      .onDown(() => dropdown.navigate(1))\n      .onSelect(dropdown.complete.bind(dropdown))\n      .onCancel(dropdown.hide.bind(dropdown))\n      .bindTo($editor);\n\n    $editor.after($container);\n  });\n\n  extend(TextEditor.prototype, 'buildEditorParams', function (params) {\n    const searched = [];\n    let relMentionStart;\n    let absMentionStart;\n    let typed;\n    let matchTyped;\n\n    const mentionTextGenerator = new TagMentionTextGenerator();\n\n    // Store tags..\n    const returnedTags = Array.from(app.store.all('tags'));\n    const returnedTagIds = new Set(returnedTags.map((t) => t.id()));\n\n    const applySuggestion = (replacement) => {\n      this.attrs.composer.editor.replaceBeforeCursor(absMentionStart - 1, replacement + ' ');\n\n      dropdown.hide();\n    };\n\n    params.inputListeners.push(() => {\n      const selection = this.attrs.composer.editor.getSelectionRange();\n\n      const cursor = selection[0];\n\n      if (selection[1] - cursor > 0) return;\n\n      // Search backwards from the cursor for an '#' symbol. If we find one,\n      // we will want to show the autocomplete dropdown!\n      const lastChunk = this.attrs.composer.editor.getLastNChars(30);\n      absMentionStart = 0;\n      for (let i = lastChunk.length - 1; i >= 0; i--) {\n        const character = lastChunk.substr(i, 1);\n        if (character === '#' && (i == 0 || /\\s/.test(lastChunk.substr(i - 1, 1)))) {\n          relMentionStart = i + 1;\n          absMentionStart = cursor - lastChunk.length + i + 1;\n          break;\n        }\n      }\n\n      dropdown.hide();\n      dropdown.active = false;\n\n      if (absMentionStart) {\n        typed = lastChunk.substring(relMentionStart).toLowerCase();\n        matchTyped = typed.match(/^[\"|]((?:(?!\"#).)+)$/);\n        typed = (matchTyped && matchTyped[1]) || typed;\n\n        const makeTagSuggestion = function (tag, replacement, content, className = '') {\n          let tagName = tag.name().toLowerCase();\n\n          if (typed) {\n            tagName = highlight(tagName, typed);\n          }\n\n          return (\n            <button\n              className={'PostPreview ' + className}\n              onclick={() => applySuggestion(replacement)}\n              onmouseenter={function () {\n                dropdown.setIndex($(this).parent().index());\n              }}\n            >\n              <span className=\"PostPreview-content\">\n                <Badge class={`Avatar Badge Badge--tag--${tag.id()} Badge-icon `} color={tag.color()} type=\"tag\" icon={tag.icon()} />\n                <span className=\"username\">{tagName}</span>\n              </span>\n            </button>\n          );\n        };\n\n        const tagMatches = function (tag) {\n          const names = [tag.name()];\n\n          return names.some((name) => name.toLowerCase().substr(0, typed.length) === typed);\n        };\n\n        const buildSuggestions = () => {\n          const suggestions = [];\n\n          // If the user has started to type a tag name, then suggest tags\n          // matching that name.\n          if (typed) {\n            returnedTags.forEach((tag) => {\n              if (!tagMatches(tag)) return;\n\n              suggestions.push(makeTagSuggestion(tag, mentionTextGenerator.forTag(tag), '', 'MentionsDropdown-tag'));\n            });\n          }\n\n          if (suggestions.length) {\n            dropdown.items = suggestions;\n            m.render($container[0], dropdown.render());\n\n            dropdown.show();\n            const coordinates = this.attrs.composer.editor.getCaretCoordinates(absMentionStart);\n            const width = dropdown.$().outerWidth();\n            const height = dropdown.$().outerHeight();\n            const parent = dropdown.$().offsetParent();\n            let left = coordinates.left;\n            let top = coordinates.top + 15;\n\n            // Keep the dropdown inside the editor.\n            if (top + height > parent.height()) {\n              top = coordinates.top - height - 15;\n            }\n            if (left + width > parent.width()) {\n              left = parent.width() - width;\n            }\n\n            // Prevent the dropdown from going off screen on mobile\n            top = Math.max(-(parent.offset().top - $(document).scrollTop()), top);\n            left = Math.max(-parent.offset().left, left);\n\n            dropdown.show(left, top);\n          } else {\n            dropdown.active = false;\n            dropdown.hide();\n          }\n        };\n\n        dropdown.active = true;\n\n        buildSuggestions();\n\n        dropdown.setIndex(0);\n        dropdown.$().scrollTop(0);\n\n        // Don't send API calls searching for users or tags until at least 2 characters have been typed.\n        // This focuses the mention results on users and posts in the discussion.\n        if (typed.length > 1) {\n          throttledSearch(typed, searched, returnedTags, returnedTagIds, dropdown, buildSuggestions);\n        }\n      }\n    });\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    items.add(\n      'mentionTag',\n      <TextEditorButton onclick={() => this.attrs.composer.editor.insertAtCursor(' #')} icon=\"fas fa-tags\">\n        {app.translator.trans('flarum-tags.forum.composer.mention_tooltip')}\n      </TextEditorButton>\n    );\n  });\n}\n","import { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport classList from 'flarum/common/utils/classList';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport getSelectableTags from './utils/getSelectableTags';\n\nexport default function () {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    // From `addTagFilter\n    const tag = this.currentTag();\n\n    if (tag) {\n      const parent = tag.parent();\n      const tags = parent ? [parent, tag] : [tag];\n      promise.then((composer) => (composer.fields.tags = tags));\n    } else {\n      app.composer.fields.tags = [];\n    }\n  });\n\n  extend(DiscussionComposer.prototype, 'oninit', function () {\n    app.tagList.load(['parent']).then(() => m.redraw());\n  });\n\n  // Add tag-selection abilities to the discussion composer.\n  DiscussionComposer.prototype.chooseTags = function () {\n    const selectableTags = getSelectableTags();\n\n    if (!selectableTags.length) return;\n\n    app.modal.show(TagDiscussionModal, {\n      selectedTags: (this.composer.fields.tags || []).slice(0),\n      onsubmit: (tags) => {\n        this.composer.fields.tags = tags;\n        this.$('textarea').focus();\n      },\n    });\n  };\n\n  // Add a tag-selection menu to the discussion composer's header, after the\n  // title.\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    const tags = this.composer.fields.tags || [];\n    const selectableTags = getSelectableTags();\n\n    items.add(\n      'tags',\n      <a className={classList(['DiscussionComposer-changeTags', !selectableTags.length && 'disabled'])} onclick={this.chooseTags.bind(this)}>\n        {tags.length ? (\n          tagsLabel(tags)\n        ) : (\n          <span className=\"TagLabel untagged\">{app.translator.trans('flarum-tags.forum.composer_discussion.choose_tags_link')}</span>\n        )}\n      </a>,\n      10\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    const chosenTags = this.composer.fields.tags || [];\n    const chosenPrimaryTags = chosenTags.filter((tag) => tag.position() !== null && !tag.isChild());\n    const chosenSecondaryTags = chosenTags.filter((tag) => tag.position() === null);\n    const selectableTags = getSelectableTags();\n\n    const minPrimaryTags = parseInt(app.forum.attribute('minPrimaryTags'));\n    const minSecondaryTags = parseInt(app.forum.attribute('minSecondaryTags'));\n    const maxPrimaryTags = parseInt(app.forum.attribute('maxPrimaryTags'));\n    const maxSecondaryTags = parseInt(app.forum.attribute('maxSecondaryTags'));\n\n    if (\n      ((!chosenTags.length && maxPrimaryTags !== 0 && maxSecondaryTags !== 0) ||\n        chosenPrimaryTags.length < minPrimaryTags ||\n        chosenSecondaryTags.length < minSecondaryTags) &&\n      selectableTags.length\n    ) {\n      app.modal.show(TagDiscussionModal, {\n        selectedTags: chosenTags,\n        onsubmit: (tags) => {\n          this.composer.fields.tags = tags;\n          original();\n        },\n      });\n    } else {\n      original();\n    }\n  });\n\n  // Add the selected tags as data to submit to the server.\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    data.relationships = data.relationships || {};\n    data.relationships.tags = this.composer.fields.tags;\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\n\nexport default function () {\n  // Add a control allowing the discussion to be moved to another category.\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canTag()) {\n      items.add(\n        'tags',\n        <Button icon=\"fas fa-tag\" onclick={() => app.modal.show(TagDiscussionModal, { discussion })}>\n          {app.translator.trans('flarum-tags.forum.discussion_controls.edit_tags_button')}\n        </Button>\n      );\n    }\n  });\n}\n","import app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\nimport { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport classList from 'flarum/common/utils/classList';\n\nimport TagHero from './components/TagHero';\nimport Tag from '../common/models/Tag';\nimport { ComponentAttrs } from 'flarum/common/Component';\n\nconst findTag = (slug: string) => app.store.all<Tag>('tags').find((tag) => tag.slug().localeCompare(slug, undefined, { sensitivity: 'base' }) === 0);\n\nexport default function () {\n  IndexPage.prototype.currentTag = function () {\n    if (this.currentActiveTag) {\n      return this.currentActiveTag;\n    }\n\n    const slug = app.search.params().tags;\n    let tag = null;\n\n    if (slug) {\n      tag = findTag(slug);\n    }\n\n    if ((slug && !tag) || (tag && !tag.isChild() && !tag.children())) {\n      if (this.currentTagLoading) {\n        return;\n      }\n\n      this.currentTagLoading = true;\n\n      // Unlike the backend, no need to fetch parent.children because if we're on\n      // a child tag page, then either:\n      //    - We loaded in that child tag (and its siblings) in the API document\n      //    - We first navigated to the current tag's parent, which would have loaded in the current tag's siblings.\n      app.store\n        .find('tags', slug, { include: 'children,children.parent,parent,state' })\n        .then(() => {\n          this.currentActiveTag = findTag(slug);\n\n          m.redraw();\n        })\n        .finally(() => {\n          this.currentTagLoading = false;\n        });\n    }\n\n    if (tag) {\n      this.currentActiveTag = tag;\n      return this.currentActiveTag;\n    }\n\n    return;\n  };\n\n  // If currently viewing a tag, insert a tag hero at the top of the view.\n  override(IndexPage.prototype, 'hero', function (original) {\n    const tag = this.currentTag();\n\n    if (tag) return <TagHero model={tag} />;\n\n    return original();\n  });\n\n  extend(IndexPage.prototype, 'view', function (vdom: Mithril.Vnode<ComponentAttrs, {}>) {\n    const tag = this.currentTag();\n\n    if (tag) vdom.attrs.className += ' IndexPage--tag' + tag.id();\n  });\n\n  extend(IndexPage.prototype, 'setTitle', function () {\n    const tag = this.currentTag();\n\n    if (tag) {\n      app.setTitle(tag.name());\n    }\n  });\n\n  // If currently viewing a tag, restyle the 'new discussion' button to use\n  // the tag's color, and disable if the user isn't allowed to edit.\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\n    const tag = this.currentTag();\n\n    if (tag) {\n      const color = tag.color();\n      const canStartDiscussion = tag.canStartDiscussion() || !app.session.user;\n      const newDiscussion = items.get('newDiscussion') as Mithril.Vnode<ComponentAttrs, {}>;\n\n      if (color) {\n        newDiscussion.attrs.className = classList([newDiscussion.attrs.className, 'Button--tagColored']);\n        newDiscussion.attrs.style = { '--color': color };\n      }\n\n      newDiscussion.attrs.disabled = !canStartDiscussion;\n      newDiscussion.children = app.translator.trans(\n        canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'\n      );\n    }\n  });\n\n  // Add a parameter for the global search state to pass on to the\n  // DiscussionListState that will let us filter discussions by tag.\n  extend(GlobalSearchState.prototype, 'params', function (params) {\n    params.tags = m.route.param('tags');\n  });\n\n  // Translate that parameter into a gambit appended to the search query.\n  extend(DiscussionListState.prototype, 'requestParams', function (this: DiscussionListState, params) {\n    if (typeof params.include === 'string') {\n      params.include = [params.include];\n    } else {\n      params.include?.push('tags', 'tags.parent');\n    }\n\n    if (this.params.tags) {\n      const filter = params.filter ?? {};\n      filter.tag = this.params.tags;\n      // TODO: replace this with a more robust system.\n      const q = filter.q;\n      if (q) {\n        filter.q = `${q} tag:${this.params.tags}`;\n      }\n      params.filter = filter;\n    }\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\n\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add tag labels to each discussion in the discussion list.\n  extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags), 10);\n    }\n  });\n\n  // Restyle a discussion's hero to use its first tag's color.\n  extend(DiscussionHero.prototype, 'view', function (view) {\n    const tags = sortTags(this.attrs.discussion.tags());\n\n    if (tags && tags.length) {\n      const color = tags[0].color();\n      if (color) {\n        view.attrs.style = { '--hero-bg': color };\n        view.attrs.className += ' DiscussionHero--colored';\n      }\n    }\n  });\n\n  // Add a list of a discussion's tags to the discussion hero, displayed\n  // before the title. Put the title on its own line.\n  extend(DiscussionHero.prototype, 'items', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags, { link: true }), 5);\n    }\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Separator from 'flarum/common/components/Separator';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nimport TagLinkButton from './components/TagLinkButton';\nimport TagsPage from './components/TagsPage';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add a link to the tags page, as well as a list of all the tags,\n  // to the index page's sidebar.\n  extend(IndexPage.prototype, 'navItems', function (items) {\n    items.add(\n      'tags',\n      <LinkButton icon=\"fas fa-th-large\" href={app.route('tags')}>\n        {app.translator.trans('flarum-tags.forum.index.tags_link')}\n      </LinkButton>,\n      -10\n    );\n\n    if (app.current.matches(TagsPage)) return;\n\n    items.add('separator', Separator.component(), -12);\n\n    const params = app.search.stickyParams();\n    const tags = app.store.all('tags');\n    const currentTag = this.currentTag();\n\n    const addTag = (tag) => {\n      let active = currentTag === tag;\n\n      if (!active && currentTag) {\n        active = currentTag.parent() === tag;\n      }\n\n      // tag.name() is passed here as children even though it isn't used directly\n      // because when we need to get the active child in SelectDropdown, we need to\n      // use its children to populate the dropdown. The problem here is that `view`\n      // on TagLinkButton is only called AFTER SelectDropdown, so no children are available\n      // for SelectDropdown to use at the time.\n      items.add('tag' + tag.id(), TagLinkButton.component({ model: tag, params, active }, tag?.name()), -14);\n    };\n\n    sortTags(tags)\n      .filter(\n        (tag) => tag.position() !== null && (!tag.isChild() || (currentTag && (tag.parent() === currentTag || tag.parent() === currentTag.parent())))\n      )\n      .forEach(addTag);\n\n    const more = tags.filter((tag) => tag.position() === null).sort((a, b) => b.discussionCount() - a.discussionCount());\n\n    more.splice(0, 3).forEach(addTag);\n\n    if (more.length) {\n      items.add('moreTags', <LinkButton href={app.route('tags')}>{app.translator.trans('flarum-tags.forum.index.more_link')}</LinkButton>, -16);\n    }\n  });\n}\n","import compat from '../common/compat';\n\nimport addTagFilter from './addTagFilter';\nimport addTagControl from './addTagControl';\nimport TagHero from './components/TagHero';\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\nimport TagLinkButton from './components/TagLinkButton';\nimport addTagList from './addTagList';\nimport addTagLabels from './addTagLabels';\nimport addTagComposer from './addTagComposer';\nimport getSelectableTags from './utils/getSelectableTags';\nimport * as textFormatter from './utils/textFormatter';\n\nexport default Object.assign(compat, {\n  'tags/addTagFilter': addTagFilter,\n  'tags/addTagControl': addTagControl,\n  'tags/components/TagHero': TagHero,\n  'tags/components/TagDiscussionModal': TagDiscussionModal,\n  'tags/components/TagsPage': TagsPage,\n  'tags/components/DiscussionTaggedPost': DiscussionTaggedPost,\n  'tags/components/TagLinkButton': TagLinkButton,\n  'tags/addTagList': addTagList,\n  'tags/addTagLabels': addTagLabels,\n  'tags/addTagComposer': addTagComposer,\n  'tags/utils/getSelectableTags': getSelectableTags,\n  'tags/utils/textFormatter': textFormatter,\n});\n","import EventPost from 'flarum/forum/components/EventPost';\nimport tagsLabel from '../../common/helpers/tagsLabel';\n\nexport default class DiscussionTaggedPost extends EventPost {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const oldTags = attrs.post.content()[0];\n    const newTags = attrs.post.content()[1];\n\n    function diffTags(tags1, tags2) {\n      return tags1.filter((tag) => tags2.indexOf(tag) === -1).map((id) => app.store.getById('tags', id));\n    }\n\n    attrs.tagsAdded = diffTags(newTags, oldTags);\n    attrs.tagsRemoved = diffTags(oldTags, newTags);\n  }\n\n  icon() {\n    return 'fas fa-tag';\n  }\n\n  descriptionKey() {\n    if (this.attrs.tagsAdded.length) {\n      if (this.attrs.tagsRemoved.length) {\n        return 'flarum-tags.forum.post_stream.added_and_removed_tags_text';\n      }\n\n      return 'flarum-tags.forum.post_stream.added_tags_text';\n    }\n\n    return 'flarum-tags.forum.post_stream.removed_tags_text';\n  }\n\n  descriptionData() {\n    const data = {};\n\n    if (this.attrs.tagsAdded.length) {\n      data.tagsAdded = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsAdded, { link: true }),\n        count: this.attrs.tagsAdded.length,\n      });\n    }\n\n    if (this.attrs.tagsRemoved.length) {\n      data.tagsRemoved = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsRemoved, { link: true }),\n        count: this.attrs.tagsRemoved.length,\n      });\n    }\n\n    return data;\n  }\n}\n","import app from 'flarum/forum/app';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\n\nimport getSelectableTags from '../utils/getSelectableTags';\nimport TagSelectionModal, { ITagSelectionModalAttrs } from '../../common/components/TagSelectionModal';\n\nimport type Discussion from 'flarum/common/models/Discussion';\nimport type Tag from '../../common/models/Tag';\n\nexport interface TagDiscussionModalAttrs extends ITagSelectionModalAttrs {\n  discussion?: Discussion;\n}\n\nexport default class TagDiscussionModal extends TagSelectionModal<TagDiscussionModalAttrs> {\n  static initAttrs(attrs: TagDiscussionModalAttrs) {\n    super.initAttrs(attrs);\n\n    const title = attrs.discussion\n      ? app.translator.trans('flarum-tags.forum.choose_tags.edit_title', { title: <em>{attrs.discussion.title()}</em> })\n      : app.translator.trans('flarum-tags.forum.choose_tags.title');\n\n    attrs.className = classList(attrs.className, 'TagDiscussionModal');\n    attrs.title = extractText(title);\n    attrs.allowResetting = !!app.forum.attribute('canBypassTagCounts');\n    attrs.limits = {\n      allowBypassing: attrs.allowResetting,\n      max: {\n        primary: app.forum.attribute<number>('minPrimaryTags'),\n        secondary: app.forum.attribute<number>('maxSecondaryTags'),\n      },\n      min: {\n        primary: app.forum.attribute<number>('maxPrimaryTags'),\n        secondary: app.forum.attribute<number>('minSecondaryTags'),\n      },\n    };\n    attrs.requireParentTag = true;\n    attrs.selectableTags = () => getSelectableTags(attrs.discussion);\n    attrs.selectedTags ??= (attrs.discussion?.tags() as Tag[]) || [];\n    attrs.canSelect = (tag) => tag.canStartDiscussion();\n\n    const suppliedOnsubmit = attrs.onsubmit || null;\n\n    // Save changes.\n    attrs.onsubmit = function (tags) {\n      const discussion = attrs.discussion;\n\n      if (discussion) {\n        discussion.save({ relationships: { tags } }).then(() => {\n          if (app.current.matches(DiscussionPage)) {\n            app.current.get('stream').update();\n          }\n\n          m.redraw();\n        });\n      }\n\n      if (suppliedOnsubmit) suppliedOnsubmit(tags);\n    };\n  }\n}\n","import Component from 'flarum/common/Component';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagHero extends Component {\n  view() {\n    const tag = this.attrs.model;\n    const color = tag.color();\n\n    return (\n      <header className={'Hero TagHero' + (color ? ' TagHero--colored' : '')} style={color ? { '--hero-bg': color } : ''}>\n        <div className=\"container\">\n          <div className=\"containerNarrow\">\n            <h2 className=\"Hero-title\">\n              {tag.icon() && tagIcon(tag, {}, { useColor: false })} {tag.name()}\n            </h2>\n            <div className=\"Hero-subtitle\">{tag.description()}</div>\n          </div>\n        </div>\n      </header>\n    );\n  }\n}\n","import Link from 'flarum/common/components/Link';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport classList from 'flarum/common/utils/classList';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagLinkButton extends LinkButton {\n  view(vnode) {\n    const tag = this.attrs.model;\n    const active = this.constructor.isActive(this.attrs);\n    const description = tag && tag.description();\n    const className = classList(['TagLinkButton', 'hasIcon', this.attrs.className, tag.isChild() && 'child']);\n\n    return (\n      <Link className={className} href={this.attrs.route} style={tag ? { '--color': tag.color() } : ''} title={description || ''}>\n        {tagIcon(tag, { className: 'Button-icon' })}\n        <span className=\"Button-label\">{tag ? tag.name() : app.translator.trans('flarum-tags.forum.index.untagged_link')}</span>\n      </Link>\n    );\n  }\n\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const tag = attrs.model;\n\n    attrs.params.tags = tag ? tag.slug() : 'untagged';\n    attrs.route = app.route('tag', attrs.params);\n  }\n}\n","import Page from 'flarum/common/components/Page';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Link from 'flarum/common/components/Link';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport listItems from 'flarum/common/helpers/listItems';\nimport humanTime from 'flarum/common/helpers/humanTime';\n\nimport tagIcon from '../../common/helpers/tagIcon';\nimport tagLabel from '../../common/helpers/tagLabel';\nimport sortTags from '../../common/utils/sortTags';\n\nexport default class TagsPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.history.push('tags', app.translator.trans('flarum-tags.forum.header.back_to_tags_tooltip'));\n\n    this.tags = [];\n\n    const preloaded = app.preloadedApiDocument();\n\n    if (preloaded) {\n      this.tags = sortTags(preloaded.filter((tag) => !tag.isChild()));\n      return;\n    }\n\n    this.loading = true;\n\n    app.tagList.load(['children', 'lastPostedDiscussion', 'parent']).then(() => {\n      this.tags = sortTags(app.store.all('tags').filter((tag) => !tag.isChild()));\n\n      this.loading = false;\n\n      m.redraw();\n    });\n  }\n\n  view() {\n    if (this.loading) {\n      return <LoadingIndicator />;\n    }\n\n    const pinned = this.tags.filter((tag) => tag.position() !== null);\n    const cloud = this.tags.filter((tag) => tag.position() === null);\n\n    return (\n      <div className=\"TagsPage\">\n        {IndexPage.prototype.hero()}\n        <div className=\"container\">\n          <nav className=\"TagsPage-nav IndexPage-nav sideNav\">\n            <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\n          </nav>\n\n          <div className=\"TagsPage-content sideNavOffset\">\n            <ul className=\"TagTiles\">\n              {pinned.map((tag) => {\n                const lastPostedDiscussion = tag.lastPostedDiscussion();\n                const children = sortTags(tag.children() || []);\n\n                return (\n                  <li className={'TagTile ' + (tag.color() ? 'colored' : '')} style={{ '--tag-bg': tag.color() }}>\n                    <Link className=\"TagTile-info\" href={app.route.tag(tag)}>\n                      {tag.icon() && tagIcon(tag, {}, { useColor: false })}\n                      <h3 className=\"TagTile-name\">{tag.name()}</h3>\n                      <p className=\"TagTile-description\">{tag.description()}</p>\n                      {children ? (\n                        <div className=\"TagTile-children\">\n                          {children.map((child) => [<Link href={app.route.tag(child)}>{child.name()}</Link>, ' '])}\n                        </div>\n                      ) : (\n                        ''\n                      )}\n                    </Link>\n                    {lastPostedDiscussion ? (\n                      <Link\n                        className=\"TagTile-lastPostedDiscussion\"\n                        href={app.route.discussion(lastPostedDiscussion, lastPostedDiscussion.lastPostNumber())}\n                      >\n                        <span className=\"TagTile-lastPostedDiscussion-title\">{lastPostedDiscussion.title()}</span>\n                        {humanTime(lastPostedDiscussion.lastPostedAt())}\n                      </Link>\n                    ) : (\n                      <span className=\"TagTile-lastPostedDiscussion\" />\n                    )}\n                  </li>\n                );\n              })}\n            </ul>\n\n            {cloud.length ? <div className=\"TagCloud\">{cloud.map((tag) => [tagLabel(tag, { link: true }), ' '])}</div> : ''}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    app.setTitle(app.translator.trans('flarum-tags.forum.all_tags.meta_title_text'));\n    app.setTitleCount(0);\n  }\n}\n","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\n\n/**\n * @TODO move to core\n */\nexport default class ToggleButton extends Component {\n  view(vnode) {\n    const { className, isToggled, ...attrs } = this.attrs;\n    const icon = isToggled ? 'far fa-check-circle' : 'far fa-circle';\n\n    return (\n      <Button {...attrs} icon={icon} className={classList([className, isToggled && 'Button--toggled'])}>\n        {vnode.children}\n      </Button>\n    );\n  }\n}\n","import Fragment from 'flarum/common/Fragment';\n\nexport default class AutocompleteDropdown extends Fragment {\n  items = [];\n  active = false;\n  index = 0;\n  keyWasJustPressed = false;\n\n  view() {\n    return (\n      <ul className=\"Dropdown-menu MentionsDropdown\">\n        {this.items.map((item) => (\n          <li>{item}</li>\n        ))}\n      </ul>\n    );\n  }\n\n  show(left, top) {\n    this.$()\n      .show()\n      .css({\n        left: left + 'px',\n        top: top + 'px',\n      });\n    this.active = true;\n  }\n\n  hide() {\n    this.$().hide();\n    this.active = false;\n  }\n\n  navigate(delta) {\n    this.keyWasJustPressed = true;\n    this.setIndex(this.index + delta, true);\n    clearTimeout(this.keyWasJustPressedTimeout);\n    this.keyWasJustPressedTimeout = setTimeout(() => (this.keyWasJustPressed = false), 500);\n  }\n\n  complete() {\n    this.$('li').eq(this.index).find('button').click();\n  }\n\n  setIndex(index, scrollToItem) {\n    if (this.keyWasJustPressed && !scrollToItem) return;\n\n    const $dropdown = this.$();\n    const $items = $dropdown.find('li');\n    let rangedIndex = index;\n\n    if (rangedIndex < 0) {\n      rangedIndex = $items.length - 1;\n    } else if (rangedIndex >= $items.length) {\n      rangedIndex = 0;\n    }\n\n    this.index = rangedIndex;\n\n    const $item = $items.removeClass('active').eq(rangedIndex).addClass('active');\n\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n","import app from 'flarum/forum/app';\nimport Model from 'flarum/common/Model';\nimport Discussion from 'flarum/common/models/Discussion';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport User from 'flarum/common/models/User';\n\nimport TagListState from '../common/states/TagListState';\nimport Tag from '../common/models/Tag';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\n\nimport addTagList from './addTagList';\nimport addTagFilter from './addTagFilter';\nimport addTagLabels from './addTagLabels';\nimport addTagControl from './addTagControl';\nimport addTagComposer from './addTagComposer';\n\napp.initializers.add('flarum-tags', function () {\n  app.routes.tags = { path: '/tags', component: TagsPage };\n  app.routes.tag = { path: '/t/:tags', component: IndexPage };\n\n  app.route.tag = (tag: Tag) => app.route('tag', { tags: tag.slug() });\n\n  app.postComponents.discussionTagged = DiscussionTaggedPost;\n\n  app.store.models.tags = Tag;\n\n  app.tagList = new TagListState();\n\n  Discussion.prototype.tags = Model.hasMany<Tag>('tags');\n  Discussion.prototype.canTag = Model.attribute<boolean>('canTag');\n\n  addTagList();\n  addTagFilter();\n  addTagLabels();\n  addTagControl();\n  addTagComposer();\n  addComposerAutocomplete();\n});\n\nexport * from './utils/textFormatter';\n\n// Expose compat API\nimport tagsCompat from './compat';\nimport { compat } from '@flarum/core/forum';\nimport addComposerAutocomplete from './addComposerAutocomplete';\n\nObject.assign(compat, tagsCompat);\n","import type Tag from '../../common/models/Tag';\n\n/**\n * Fetches the mention text for a specified model.\n */\nexport default class TagMentionTextGenerator {\n  /**\n   * Generates the mention syntax for a tag mention.\n   *\n   * @example <caption>Tag mention</caption>\n   * // '#\"General\"#t1'\n   * // #\"Name\"#tTagID\n   * forTag(tag) // Tag display name is 'General', tag ID is 1\n   *\n   * @param tag\n   * @returns\n   */\n  forTag(tag: Tag): string {\n    return `#\"${tag.name()}\"#t${tag.id()}`;\n  }\n}\n","export default function getSelectableTags(discussion) {\n  let tags = app.store.all('tags');\n\n  if (discussion) {\n    tags = tags.filter((tag) => tag.canAddToDiscussion() || discussion.tags().indexOf(tag) !== -1);\n  } else {\n    tags = tags.filter((tag) => tag.canStartDiscussion());\n  }\n\n  return tags;\n}\n","import app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\nimport isDark from 'flarum/common/utils/isDark';\n\nexport function filterTagMentions(tag) {\n  const tagModel = app.store.getById('tags', tag.getAttribute('id'));\n\n  if (tagModel) {\n    tag.setAttribute('tagname', extractText(tagModel.name()));\n    tag.setAttribute('icon', tagModel.icon());\n    tag.setAttribute('color', tagModel.color());\n    tag.setAttribute('slug', tagModel.slug());\n    tag.setAttribute('class', isDark(tagModel.color()) ? 'TagMention--light' : 'TagMention--dark');\n\n    return true;\n  }\n\n  tag.invalidate();\n}\n","module.exports = flarum.core;","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/Fragment'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/app'];","module.exports = flarum.core.compat['common/components/Badge'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Separator'];","module.exports = flarum.core.compat['common/components/TextEditor'];","module.exports = flarum.core.compat['common/components/TextEditorButton'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/highlight'];","module.exports = flarum.core.compat['common/helpers/humanTime'];","module.exports = flarum.core.compat['common/helpers/listItems'];","module.exports = flarum.core.compat['common/models/Discussion'];","module.exports = flarum.core.compat['common/utils/KeyboardNavigatable'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['common/utils/classList'];","module.exports = flarum.core.compat['common/utils/computed'];","module.exports = flarum.core.compat['common/utils/extract'];","module.exports = flarum.core.compat['common/utils/extractText'];","module.exports = flarum.core.compat['common/utils/isDark'];","module.exports = flarum.core.compat['common/utils/throttleDebounce'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/DiscussionComposer'];","module.exports = flarum.core.compat['forum/components/DiscussionHero'];","module.exports = flarum.core.compat['forum/components/DiscussionListItem'];","module.exports = flarum.core.compat['forum/components/DiscussionPage'];","module.exports = flarum.core.compat['forum/components/EventPost'];","module.exports = flarum.core.compat['forum/components/IndexPage'];","module.exports = flarum.core.compat['forum/states/DiscussionListState'];","module.exports = flarum.core.compat['forum/states/GlobalSearchState'];","module.exports = flarum.core.compat['forum/utils/DiscussionControls'];","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n      return ContinueSentinel;\n    }\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) {\n              if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            }\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/common';\nexport * from './src/forum';\n"],"names":["sortTags","Tag","tagsLabel","tagIcon","tagLabel","TagSelectionModal","TagListState","app","Button","classList","extractText","highlight","KeyboardNavigatable","LoadingIndicator","Modal","Stream","ToggleButton","loading","tags","selected","bypassReqs","filter","focused","navigator","indexTag","initAttrs","attrs","title","translator","trans","canSelect","allowResetting","limits","min","total","Infinity","primary","secondary","max","catchInvalidLimits","oninit","vnode","onUp","setIndex","getCurrentNumericIndex","onDown","onSelect","select","bind","onRemove","splice","length","tagList","load","then","selectableTags","selectedTags","map","addTag","m","redraw","className","content","toLowerCase","primaryCount","secondaryCount","getFilteredTags","inputWidth","Math","getInstruction","$","focus","tag","removeTag","onready","width","navigate","meetsRequirements","id","pinned","position","child","parent","colored","color","includes","active","toggleTag","name","description","allowBypassing","requireParentTag","isPrimary","substring","push","index","indexOf","t","forEach","onDeselect","remaining","count","onsubmit","e","preventDefault","hide","metaKey","ctrlKey","click","getItem","dispatchEvent","Event","selectableItems","selectedTag","scrollToItem","$items","$dropdown","$item","eq","store","getById","attr","dropdownScroll","scrollTop","dropdownTop","offset","top","dropdownBottom","outerHeight","itemTop","itemBottom","parseInt","css","stop","animate","Error","settings","hasIcon","icon","useColor","style","extract","Link","link","tagText","href","route","slug","isChild","children","computed","Model","attribute","call","backgroundUrl","backgroundMode","hasOne","hasMany","defaultSort","isHidden","discussionCount","lastPostedAt","transformDate","lastPostedDiscussion","isRestricted","canStartDiscussion","canAddToDiscussion","loadedIncludes","Set","unloadedIncludes","include","has","Promise","resolve","all","find","join","val","add","slice","sort","a","b","aPos","bPos","aParent","bParent","extend","TextEditor","TextEditorButton","throttle","Badge","AutocompleteDropdown","TagMentionTextGenerator","throttledSearch","typed","searched","returnedTags","returnedTagIds","dropdown","buildSuggestions","typedLower","q","page","limit","results","u","addComposerAutocomplete","$container","prototype","$editor","wrap","when","complete","onCancel","bindTo","after","params","relMentionStart","absMentionStart","matchTyped","mentionTextGenerator","Array","from","applySuggestion","replacement","composer","editor","replaceBeforeCursor","inputListeners","selection","getSelectionRange","cursor","lastChunk","getLastNChars","i","character","substr","test","match","makeTagSuggestion","tagName","tagMatches","names","some","suggestions","forTag","items","render","show","coordinates","getCaretCoordinates","outerWidth","height","offsetParent","left","document","insertAtCursor","override","IndexPage","DiscussionComposer","TagDiscussionModal","getSelectableTags","promise","currentTag","fields","chooseTags","modal","original","chosenTags","chosenPrimaryTags","chosenSecondaryTags","minPrimaryTags","forum","minSecondaryTags","maxPrimaryTags","maxSecondaryTags","data","relationships","DiscussionControls","discussion","canTag","DiscussionListState","GlobalSearchState","TagHero","findTag","localeCompare","undefined","sensitivity","currentActiveTag","search","currentTagLoading","vdom","setTitle","session","user","newDiscussion","get","disabled","param","DiscussionListItem","DiscussionHero","view","Separator","LinkButton","TagLinkButton","TagsPage","current","matches","component","stickyParams","model","more","compat","addTagFilter","addTagControl","DiscussionTaggedPost","addTagList","addTagLabels","addTagComposer","textFormatter","Object","assign","EventPost","oldTags","post","newTags","diffTags","tags1","tags2","tagsAdded","tagsRemoved","descriptionKey","descriptionData","DiscussionPage","suppliedOnsubmit","save","update","Component","constructor","isActive","Page","listItems","humanTime","history","preloaded","preloadedApiDocument","cloud","hero","sidebarItems","toArray","lastPostNumber","oncreate","setTitleCount","isToggled","Fragment","keyWasJustPressed","item","delta","clearTimeout","keyWasJustPressedTimeout","setTimeout","rangedIndex","removeClass","addClass","Discussion","initializers","routes","path","postComponents","discussionTagged","models","tagsCompat","isDark","filterTagMentions","tagModel","getAttribute","setAttribute","invalidate","_typeof","require","_regeneratorRuntime","module","exports","__esModule","Op","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","reject","record","result","__await","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","finish","_catch","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_inheritsLoose","subClass","superClass","_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","_setPrototypeOf","o","p"],"sourceRoot":""}