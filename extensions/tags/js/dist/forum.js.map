{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/tags/external root \"flarum.core.compat['forum/app']\"","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/app']\"","webpack://@flarum/tags/./src/common/states/TagListState.ts","webpack://@flarum/tags/external root \"flarum.core.compat['common/extend']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Separator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flarum/tags/./src/common/helpers/tagIcon.js","webpack://@flarum/tags/./src/forum/components/TagLinkButton.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Page']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/listItems']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/humanTime']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/textContrastClass']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extract']\"","webpack://@flarum/tags/./src/common/helpers/tagLabel.js","webpack://@flarum/tags/./src/common/utils/sortTags.tsx","webpack://@flarum/tags/./src/forum/components/TagsPage.js","webpack://@flarum/tags/./src/forum/addTagList.js","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/DiscussionListState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/states/GlobalSearchState']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Component']\"","webpack://@flarum/tags/./src/forum/components/TagHero.js","webpack://@flarum/tags/./src/forum/addTagFilter.tsx","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionListItem']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionHero']\"","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@flarum/tags/./src/common/helpers/tagsLabel.js","webpack://@flarum/tags/./src/forum/addTagLabels.js","webpack://@flarum/tags/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flarum/tags/./src/forum/utils/getSelectableTags.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/KeyboardNavigatable']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@flarum/tags/./src/forum/components/ToggleButton.js","webpack://@flarum/tags/./src/common/components/TagSelectionModal.tsx","webpack://@flarum/tags/./src/forum/components/TagDiscussionModal.tsx","webpack://@flarum/tags/./src/forum/addTagControl.js","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@flarum/tags/./src/forum/addTagComposer.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/extenders']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@flarum/tags/external root \"flarum.core.compat['forum/components/EventPost']\"","webpack://@flarum/tags/./src/forum/components/DiscussionTaggedPost.js","webpack://@flarum/tags/external root \"flarum.core.compat['common/utils/computed']\"","webpack://@flarum/tags/external root \"flarum.core.compat['common/Model']\"","webpack://@flarum/tags/./src/common/models/Tag.ts","webpack://@flarum/tags/./src/common/extend.ts","webpack://@flarum/tags/./src/forum/extend.ts","webpack://@flarum/tags/./src/common/compat.js","webpack://@flarum/tags/./src/forum/compat.js","webpack://@flarum/tags/external assign \"flarum.core\"","webpack://@flarum/tags/./src/forum/index.ts","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/helpers/typeof.js","webpack://@flarum/tags/../../../node_modules/@babel/runtime/regenerator/index.js","webpack://@flarum/tags/webpack/bootstrap","webpack://@flarum/tags/webpack/runtime/compat get default export","webpack://@flarum/tags/webpack/runtime/define property getters","webpack://@flarum/tags/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/tags/webpack/runtime/make namespace object"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\nimport type Tag from '../../common/models/Tag';\n\nexport default class TagListState {\n  loadedIncludes?: Set<string>;\n\n  async load(includes: string[] = []): Promise<Tag[]> {\n    if (!this.loadedIncludes) {\n      return this.query(includes);\n    }\n\n    const unloadedIncludes = includes.filter((include) => !this.loadedIncludes!.has(include));\n\n    if (unloadedIncludes.length === 0) {\n      return Promise.resolve(app.store.all<Tag>('tags'));\n    }\n\n    return this.query(unloadedIncludes);\n  }\n\n  async query(includes: string[] = []): Promise<Tag[]> {\n    this.loadedIncludes ??= new Set();\n\n    return app.store.find<Tag[]>('tags', { include: includes.join(',') }).then((val) => {\n      includes.forEach((include) => this.loadedIncludes!.add(include));\n      return val;\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Separator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import classList from 'flarum/common/utils/classList';\n\nexport default function tagIcon(tag, attrs = {}, settings = {}) {\n  const hasIcon = tag && tag.icon();\n  const { useColor = true } = settings;\n\n  attrs.className = classList([attrs.className, 'icon', hasIcon ? tag.icon() : 'TagIcon']);\n\n  if (tag && useColor) {\n    attrs.style = attrs.style || {};\n    attrs.style['--color'] = tag.color();\n\n    if (hasIcon) {\n      attrs.style.color = tag.color();\n    }\n  } else if (!tag) {\n    attrs.className += ' untagged';\n  }\n\n  return hasIcon ? <i {...attrs} /> : <span {...attrs} />;\n}\n","import Link from 'flarum/common/components/Link';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport classList from 'flarum/common/utils/classList';\nimport tagIcon from '../../common/helpers/tagIcon';\n\nexport default class TagLinkButton extends LinkButton {\n  view(vnode) {\n    const tag = this.attrs.model;\n    const description = tag && tag.description();\n    const className = classList('TagLinkButton hasIcon', { child: tag.isChild() }, this.attrs.className);\n\n    return (\n      <Link className={className} href={this.attrs.route} style={tag ? { '--color': tag.color() } : undefined} title={description || undefined}>\n        {tagIcon(tag, { className: 'Button-icon' })}\n        <span className=\"Button-label\">{tag ? tag.name() : app.translator.trans('flarum-tags.forum.index.untagged_link')}</span>\n      </Link>\n    );\n  }\n\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const tag = attrs.model;\n\n    attrs.params.tags = tag ? tag.slug() : 'untagged';\n    attrs.route = app.route('tag', attrs.params);\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/listItems'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/humanTime'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/textContrastClass'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extract'];","import extract from 'flarum/common/utils/extract';\nimport Link from 'flarum/common/components/Link';\nimport classList from 'flarum/common/utils/classList';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport tagIcon from './tagIcon';\n\nexport default function tagLabel(tag, attrs = {}) {\n  attrs.style = attrs.style || {};\n  attrs.className = 'TagLabel ' + (attrs.className || '');\n\n  const link = extract(attrs, 'link');\n  const tagText = tag ? tag.name() : app.translator.trans('flarum-tags.lib.deleted_tag_text');\n\n  if (tag) {\n    const color = tag.color();\n    if (color) {\n      attrs.style['--tag-bg'] = color;\n      attrs.className = classList(attrs.className, 'colored', textContrastClass(color));\n    }\n\n    if (link) {\n      attrs.title = tag.description() || '';\n      attrs.href = app.route('tag', { tags: tag.slug() });\n    }\n\n    if (tag.isChild()) {\n      attrs.className += ' TagLabel--child';\n    }\n  } else {\n    attrs.className += ' untagged';\n  }\n\n  return m(\n    link ? Link : 'span',\n    attrs,\n    <span className=\"TagLabel-text\">\n      {tag && tag.icon() && tagIcon(tag, { className: 'TagLabel-icon' }, { useColor: false })}\n      <span className=\"TagLabel-name\">{tagText}</span>\n    </span>\n  );\n}\n","import Tag from '../models/Tag';\n\nexport default function sortTags(tags: Tag[]) {\n  return tags.slice(0).sort((a, b) => {\n    const aPos = a.position();\n    const bPos = b.position();\n\n    // If they're both secondary tags, sort them by their discussions count,\n    // descending.\n    if (aPos === null && bPos === null) return b.discussionCount() - a.discussionCount();\n\n    // If just one is a secondary tag, then the primary tag should\n    // come first.\n    if (bPos === null) return -1;\n    if (aPos === null) return 1;\n\n    // If we've made it this far, we know they're both primary tags. So we'll\n    // need to see if they have parents.\n    const aParent = a.parent();\n    const bParent = b.parent();\n\n    // If they both have the same parent, then their positions are local,\n    // so we can compare them directly.\n    if (aParent === bParent) return aPos - bPos;\n    // If they are both child tags, then we will compare the positions of their\n    // parents.\n    else if (aParent && bParent) return aParent.position()! - bParent.position()!;\n    // If we are comparing a child tag with its parent, then we let the parent\n    // come first. If we are comparing an unrelated parent/child, then we\n    // compare both of the parents.\n    else if (aParent) return aParent === b ? 1 : aParent.position()! - bPos;\n    else if (bParent) return bParent === a ? -1 : aPos - bParent.position()!;\n\n    return 0;\n  });\n}\n","import Page from 'flarum/common/components/Page';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Link from 'flarum/common/components/Link';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport listItems from 'flarum/common/helpers/listItems';\nimport ItemList from 'flarum/common/utils/ItemList';\nimport humanTime from 'flarum/common/helpers/humanTime';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport classList from 'flarum/common/utils/classList';\n\nimport tagIcon from '../../common/helpers/tagIcon';\nimport tagLabel from '../../common/helpers/tagLabel';\nimport sortTags from '../../common/utils/sortTags';\n\nexport default class TagsPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    app.history.push('tags', app.translator.trans('flarum-tags.forum.header.back_to_tags_tooltip'));\n\n    this.tags = [];\n\n    const preloaded = app.preloadedApiDocument();\n\n    if (preloaded) {\n      this.tags = sortTags(preloaded.filter((tag) => !tag.isChild()));\n      return;\n    }\n\n    this.loading = true;\n\n    app.tagList.load(['children', 'lastPostedDiscussion', 'parent']).then(() => {\n      this.tags = sortTags(app.store.all('tags').filter((tag) => !tag.isChild()));\n\n      this.loading = false;\n\n      m.redraw();\n    });\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n\n    app.setTitle(app.translator.trans('flarum-tags.forum.all_tags.meta_title_text'));\n    app.setTitleCount(0);\n  }\n\n  view() {\n    return <div className=\"TagsPage\">{this.pageContent().toArray()}</div>;\n  }\n\n  pageContent() {\n    const items = new ItemList();\n\n    items.add('hero', this.hero(), 100);\n    items.add('main', <div className=\"container\">{this.mainContent().toArray()}</div>, 10);\n\n    return items;\n  }\n\n  mainContent() {\n    const items = new ItemList();\n\n    items.add('sidebar', this.sidebar(), 100);\n    items.add('content', this.content(), 10);\n\n    return items;\n  }\n\n  content() {\n    return <div className=\"TagsPage-content sideNavOffset\">{this.contentItems().toArray()}</div>;\n  }\n\n  contentItems() {\n    const items = new ItemList();\n\n    if (this.loading) {\n      items.add('loading', <LoadingIndicator />);\n    } else {\n      const pinned = this.tags.filter((tag) => tag.position() !== null);\n      const cloud = this.tags.filter((tag) => tag.position() === null);\n\n      items.add('tagTiles', this.tagTileListView(pinned), 100);\n\n      if (cloud.length) {\n        items.add('cloud', this.cloudView(cloud), 10);\n      }\n    }\n\n    return items;\n  }\n\n  hero() {\n    return IndexPage.prototype.hero();\n  }\n\n  sidebar() {\n    return (\n      <nav className=\"TagsPage-nav IndexPage-nav sideNav\">\n        <ul>{listItems(this.sidebarItems().toArray())}</ul>\n      </nav>\n    );\n  }\n\n  sidebarItems() {\n    return IndexPage.prototype.sidebarItems();\n  }\n\n  tagTileListView(pinned) {\n    return <ul className=\"TagTiles\">{pinned.map(this.tagTileView.bind(this))}</ul>;\n  }\n\n  tagTileView(tag) {\n    const lastPostedDiscussion = tag.lastPostedDiscussion();\n    const children = sortTags(tag.children() || []);\n\n    return (\n      <li className={classList('TagTile', { colored: tag.color() }, textContrastClass(tag.color()))} style={{ '--tag-bg': tag.color() }}>\n        <Link className=\"TagTile-info\" href={app.route.tag(tag)}>\n          {tag.icon() && tagIcon(tag, {}, { useColor: false })}\n          <h3 className=\"TagTile-name\">{tag.name()}</h3>\n          <p className=\"TagTile-description\">{tag.description()}</p>\n          {!!children && (\n            <div className=\"TagTile-children\">{children.map((child) => [<Link href={app.route.tag(child)}>{child.name()}</Link>, ' '])}</div>\n          )}\n        </Link>\n        {lastPostedDiscussion ? (\n          <Link className=\"TagTile-lastPostedDiscussion\" href={app.route.discussion(lastPostedDiscussion, lastPostedDiscussion.lastPostNumber())}>\n            <span className=\"TagTile-lastPostedDiscussion-title\">{lastPostedDiscussion.title()}</span>\n            {humanTime(lastPostedDiscussion.lastPostedAt())}\n          </Link>\n        ) : (\n          <span className=\"TagTile-lastPostedDiscussion\" />\n        )}\n      </li>\n    );\n  }\n\n  cloudView(cloud) {\n    return <div className=\"TagCloud\">{cloud.map((tag) => [tagLabel(tag, { link: true }), ' '])}</div>;\n  }\n}\n","import { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Separator from 'flarum/common/components/Separator';\nimport LinkButton from 'flarum/common/components/LinkButton';\n\nimport TagLinkButton from './components/TagLinkButton';\nimport TagsPage from './components/TagsPage';\nimport app from 'flarum/forum/app';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add a link to the tags page, as well as a list of all the tags,\n  // to the index page's sidebar.\n  extend(IndexPage.prototype, 'navItems', function (items) {\n    items.add(\n      'tags',\n      <LinkButton icon=\"fas fa-th-large\" href={app.route('tags')}>\n        {app.translator.trans('flarum-tags.forum.index.tags_link')}\n      </LinkButton>,\n      -10\n    );\n\n    if (app.current.matches(TagsPage)) return;\n\n    items.add('separator', <Separator />, -12);\n\n    const params = app.search.stickyParams();\n    const tags = app.store.all('tags');\n    const currentTag = this.currentTag();\n\n    const addTag = (tag) => {\n      let active = currentTag === tag;\n\n      if (!active && currentTag) {\n        active = currentTag.parent() === tag;\n      }\n\n      // tag.name() is passed here as children even though it isn't used directly\n      // because when we need to get the active child in SelectDropdown, we need to\n      // use its children to populate the dropdown. The problem here is that `view`\n      // on TagLinkButton is only called AFTER SelectDropdown, so no children are available\n      // for SelectDropdown to use at the time.\n      items.add(\n        'tag' + tag.id(),\n        <TagLinkButton model={tag} params={params} active={active}>\n          {tag?.name()}\n        </TagLinkButton>,\n        -14\n      );\n    };\n\n    sortTags(tags)\n      .filter(\n        (tag) => tag.position() !== null && (!tag.isChild() || (currentTag && (tag.parent() === currentTag || tag.parent() === currentTag.parent())))\n      )\n      .forEach(addTag);\n\n    const more = tags.filter((tag) => tag.position() === null).sort((a, b) => b.discussionCount() - a.discussionCount());\n\n    more.splice(0, 3).forEach(addTag);\n\n    if (more.length) {\n      items.add('moreTags', <LinkButton href={app.route('tags')}>{app.translator.trans('flarum-tags.forum.index.more_link')}</LinkButton>, -16);\n    }\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/DiscussionListState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/states/GlobalSearchState'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component from 'flarum/common/Component';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport tagIcon from '../../common/helpers/tagIcon';\nimport classList from 'flarum/common/utils/classList';\n\nexport default class TagHero extends Component {\n  view() {\n    const tag = this.attrs.model;\n    const color = tag.color();\n\n    return (\n      <header\n        className={classList('Hero', 'TagHero', { 'TagHero--colored': color, [textContrastClass(color)]: color })}\n        style={color ? { '--hero-bg': color } : undefined}\n      >\n        <div className=\"container\">\n          <div className=\"containerNarrow\">\n            <h1 className=\"Hero-title\">\n              {tag.icon() && tagIcon(tag, {}, { useColor: false })} {tag.name()}\n            </h1>\n            <div className=\"Hero-subtitle\">{tag.description()}</div>\n          </div>\n        </div>\n      </header>\n    );\n  }\n}\n","import app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\nimport { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionListState from 'flarum/forum/states/DiscussionListState';\nimport GlobalSearchState from 'flarum/forum/states/GlobalSearchState';\nimport classList from 'flarum/common/utils/classList';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\n\nimport TagHero from './components/TagHero';\nimport Tag from '../common/models/Tag';\nimport { ComponentAttrs } from 'flarum/common/Component';\n\nconst findTag = (slug: string) => app.store.all<Tag>('tags').find((tag) => tag.slug().localeCompare(slug, undefined, { sensitivity: 'base' }) === 0);\n\nexport default function () {\n  IndexPage.prototype.currentTag = function () {\n    if (this.currentActiveTag) {\n      return this.currentActiveTag;\n    }\n\n    const slug = app.search.params().tags;\n    let tag = null;\n\n    if (slug) {\n      tag = findTag(slug);\n    }\n\n    if ((slug && !tag) || (tag && !tag.isChild() && !tag.children())) {\n      if (this.currentTagLoading) {\n        return;\n      }\n\n      this.currentTagLoading = true;\n\n      // Unlike the backend, no need to fetch parent.children because if we're on\n      // a child tag page, then either:\n      //    - We loaded in that child tag (and its siblings) in the API document\n      //    - We first navigated to the current tag's parent, which would have loaded in the current tag's siblings.\n      app.store\n        .find('tags', slug, { include: 'children,children.parent,parent,state' })\n        .then(() => {\n          this.currentActiveTag = findTag(slug);\n\n          m.redraw();\n        })\n        .finally(() => {\n          this.currentTagLoading = false;\n        });\n    }\n\n    if (tag) {\n      this.currentActiveTag = tag;\n      return this.currentActiveTag;\n    }\n\n    return;\n  };\n\n  // If currently viewing a tag, insert a tag hero at the top of the view.\n  override(IndexPage.prototype, 'hero', function (original) {\n    const tag = this.currentTag();\n\n    if (tag) return <TagHero model={tag} />;\n\n    return original();\n  });\n\n  extend(IndexPage.prototype, 'view', function (vdom: Mithril.Vnode<ComponentAttrs, {}>) {\n    const tag = this.currentTag();\n\n    if (tag) vdom.attrs.className += ' IndexPage--tag' + tag.id();\n  });\n\n  extend(IndexPage.prototype, 'setTitle', function () {\n    const tag = this.currentTag();\n\n    if (tag) {\n      app.setTitle(tag.name());\n    }\n  });\n\n  // If currently viewing a tag, restyle the 'new discussion' button to use\n  // the tag's color, and disable if the user isn't allowed to edit.\n  extend(IndexPage.prototype, 'sidebarItems', function (items) {\n    const tag = this.currentTag();\n\n    if (tag) {\n      const color = tag.color();\n      const canStartDiscussion = tag.canStartDiscussion() || !app.session.user;\n      const newDiscussion = items.get('newDiscussion') as Mithril.Vnode<ComponentAttrs, {}>;\n\n      if (color) {\n        newDiscussion.attrs.className = classList([newDiscussion.attrs.className, 'Button--tagColored', textContrastClass(color)]);\n        newDiscussion.attrs.style = { '--color': color };\n      }\n\n      newDiscussion.attrs.disabled = !canStartDiscussion;\n      newDiscussion.children = app.translator.trans(\n        canStartDiscussion ? 'core.forum.index.start_discussion_button' : 'core.forum.index.cannot_start_discussion_button'\n      );\n    }\n  });\n\n  // Add a parameter for the global search state to pass on to the\n  // DiscussionListState that will let us filter discussions by tag.\n  extend(GlobalSearchState.prototype, 'params', function (params) {\n    params.tags = m.route.param('tags');\n  });\n\n  // Translate that parameter into a gambit appended to the search query.\n  extend(DiscussionListState.prototype, 'requestParams', function (this: DiscussionListState, params) {\n    if (typeof params.include === 'string') {\n      params.include = [params.include];\n    } else {\n      params.include?.push('tags', 'tags.parent');\n    }\n\n    if (this.params.tags) {\n      const filter = params.filter ?? {};\n      filter.tag = this.params.tags;\n      // TODO: replace this with a more robust system.\n      const q = filter.q;\n      if (q) {\n        filter.q = `${q} tag:${this.params.tags}`;\n      }\n      params.filter = filter;\n    }\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionListItem'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionHero'];","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import extract from 'flarum/common/utils/extract';\nimport tagLabel from './tagLabel';\nimport sortTags from '../utils/sortTags';\nimport classList from 'flarum/common/utils/classList';\n\nexport default function tagsLabel(tags, attrs = {}) {\n  const children = [];\n  const { link, ...otherAttrs } = attrs;\n\n  otherAttrs.className = classList('TagsLabel', otherAttrs.className);\n\n  if (tags) {\n    sortTags(tags).forEach((tag) => {\n      if (tag || tags.length === 1) {\n        children.push(tagLabel(tag, { link }));\n      }\n    });\n  } else {\n    children.push(tagLabel());\n  }\n\n  return <span {...otherAttrs}>{children}</span>;\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionListItem from 'flarum/forum/components/DiscussionListItem';\nimport DiscussionHero from 'flarum/forum/components/DiscussionHero';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport classList from 'flarum/common/utils/classList';\n\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport sortTags from '../common/utils/sortTags';\n\nexport default function () {\n  // Add tag labels to each discussion in the discussion list.\n  extend(DiscussionListItem.prototype, 'infoItems', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags), 10);\n    }\n  });\n\n  // Restyle a discussion's hero to use its first tag's color.\n  extend(DiscussionHero.prototype, 'view', function (view) {\n    const tags = sortTags(this.attrs.discussion.tags());\n\n    if (tags && tags.length) {\n      const color = tags[0].color();\n      if (color) {\n        view.attrs.style = { '--hero-bg': color };\n        view.attrs.className = classList(view.attrs.className, 'DiscussionHero--colored', textContrastClass(color));\n      }\n    }\n  });\n\n  // Add a list of a discussion's tags to the discussion hero, displayed\n  // before the title. Put the title on its own line.\n  extend(DiscussionHero.prototype, 'items', function (items) {\n    const tags = this.attrs.discussion.tags();\n\n    if (tags && tags.length) {\n      items.add('tags', tagsLabel(tags, { link: true }), 5);\n    }\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","export default function getSelectableTags(discussion) {\n  let tags = app.store.all('tags');\n\n  if (discussion) {\n    tags = tags.filter((tag) => tag.canAddToDiscussion() || discussion.tags().indexOf(tag) !== -1);\n  } else {\n    tags = tags.filter((tag) => tag.canStartDiscussion());\n  }\n\n  return tags;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/KeyboardNavigatable'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\n\n/**\n * @TODO move to core\n */\nexport default class ToggleButton extends Component {\n  view(vnode) {\n    const { className, isToggled, ...attrs } = this.attrs;\n    const icon = isToggled ? 'far fa-check-circle' : 'far fa-circle';\n\n    return (\n      <Button {...attrs} icon={icon} className={classList([className, isToggled && 'Button--toggled'])}>\n        {vnode.children}\n      </Button>\n    );\n  }\n}\n","import app from 'flarum/common/app';\nimport Button from 'flarum/common/components/Button';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\nimport highlight from 'flarum/common/helpers/highlight';\nimport KeyboardNavigatable from 'flarum/common/utils/KeyboardNavigatable';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Modal from 'flarum/common/components/Modal';\nimport Stream from 'flarum/common/utils/Stream';\n\nimport sortTags from '../utils/sortTags';\nimport tagLabel from '../helpers/tagLabel';\nimport tagIcon from '../helpers/tagIcon';\nimport ToggleButton from '../../forum/components/ToggleButton';\n\nimport type Tag from '../models/Tag';\nimport type { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport type Mithril from 'mithril';\n\nexport interface ITagSelectionModalLimits {\n  /** Whether to allow bypassing the limits set here. This will show a toggle button to bypass limits. */\n  allowBypassing?: boolean;\n  /** Maximum number of primary/secondary tags allowed. */\n  max?: {\n    total?: number;\n    primary?: number;\n    secondary?: number;\n  };\n  /** Minimum number of primary/secondary tags to be selected. */\n  min?: {\n    total?: number;\n    primary?: number;\n    secondary?: number;\n  };\n}\n\nexport interface ITagSelectionModalAttrs extends IInternalModalAttrs {\n  /** Custom modal className to use. */\n  className?: string;\n  /** Modal title, defaults to 'Choose Tags'. */\n  title?: string;\n  /** Initial tag selection value. */\n  selectedTags?: Tag[];\n  /** Limits set based on minimum and maximum number of primary/secondary tags that can be selected. */\n  limits?: ITagSelectionModalLimits;\n  /** Whether to allow resetting the value. Defaults to true. */\n  allowResetting?: boolean;\n  /** Whether to require the parent tag of a selected tag to be selected as well. */\n  requireParentTag?: boolean;\n  /** Filter tags that can be selected. */\n  selectableTags?: (tags: Tag[]) => Tag[];\n  /** Whether a tag can be selected. */\n  canSelect: (tag: Tag) => boolean;\n  /** Callback for when a tag is selected. */\n  onSelect?: (tag: Tag, selected: Tag[]) => void;\n  /** Callback for when a tag is deselected. */\n  onDeselect?: (tag: Tag, selected: Tag[]) => void;\n  /** Callback for when the selection is submitted. */\n  onsubmit?: (selected: Tag[]) => void;\n}\n\nexport type ITagSelectionModalState = undefined;\n\nexport default class TagSelectionModal<\n  CustomAttrs extends ITagSelectionModalAttrs = ITagSelectionModalAttrs,\n  CustomState extends ITagSelectionModalState = ITagSelectionModalState\n> extends Modal<CustomAttrs, CustomState> {\n  protected loading = true;\n  protected tags!: Tag[];\n  protected selected: Tag[] = [];\n  protected bypassReqs: boolean = false;\n\n  protected filter = Stream('');\n  protected focused = false;\n  protected navigator = new KeyboardNavigatable();\n  protected indexTag?: Tag;\n\n  static initAttrs(attrs: ITagSelectionModalAttrs) {\n    super.initAttrs(attrs);\n\n    // Default values for optional attributes.\n    attrs.title ||= extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.title'));\n    attrs.canSelect ||= () => true;\n    attrs.allowResetting ??= true;\n    attrs.limits = {\n      min: {\n        total: attrs.limits?.min?.total ?? -Infinity,\n        primary: attrs.limits?.min?.primary ?? -Infinity,\n        secondary: attrs.limits?.min?.secondary ?? -Infinity,\n      },\n      max: {\n        total: attrs.limits?.max?.total ?? Infinity,\n        primary: attrs.limits?.max?.primary ?? Infinity,\n        secondary: attrs.limits?.max?.secondary ?? Infinity,\n      },\n    };\n\n    // Prevent illogical limits from being provided.\n    catchInvalidLimits(attrs.limits);\n  }\n\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.navigator\n      .onUp(() => this.setIndex(this.getCurrentNumericIndex() - 1, true))\n      .onDown(() => this.setIndex(this.getCurrentNumericIndex() + 1, true))\n      .onSelect(this.select.bind(this))\n      .onRemove(() => this.selected.splice(this.selected.length - 1, 1));\n\n    app.tagList.load(['parent']).then((tags) => {\n      this.loading = false;\n\n      if (this.attrs.selectableTags) {\n        tags = this.attrs.selectableTags(tags);\n      }\n\n      this.tags = sortTags(tags);\n\n      if (this.attrs.selectedTags) {\n        this.attrs.selectedTags.map(this.addTag.bind(this));\n      }\n\n      this.indexTag = tags[0];\n\n      m.redraw();\n    });\n  }\n\n  className() {\n    return classList('TagSelectionModal', this.attrs.className);\n  }\n\n  title() {\n    return this.attrs.title;\n  }\n\n  content() {\n    if (this.loading || !this.tags) {\n      return <LoadingIndicator />;\n    }\n\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n    const tags = this.getFilteredTags();\n\n    const inputWidth = Math.max(extractText(this.getInstruction(primaryCount, secondaryCount)).length, this.filter().length);\n\n    return [\n      <div className=\"Modal-body\">\n        <div className=\"TagSelectionModal-form\">\n          <div className=\"TagSelectionModal-form-input\">\n            <div className={'TagsInput FormControl ' + (this.focused ? 'focus' : '')} onclick={() => this.$('.TagsInput input').focus()}>\n              <span className=\"TagsInput-selected\">\n                {this.selected.map((tag) => (\n                  <span\n                    className=\"TagsInput-tag\"\n                    onclick={() => {\n                      this.removeTag(tag);\n                      this.onready();\n                    }}\n                  >\n                    {tagLabel(tag)}\n                  </span>\n                ))}\n              </span>\n              <input\n                className=\"FormControl\"\n                placeholder={extractText(this.getInstruction(primaryCount, secondaryCount))}\n                bidi={this.filter}\n                style={{ width: inputWidth + 'ch' }}\n                onkeydown={this.navigator.navigate.bind(this.navigator)}\n                onfocus={() => (this.focused = true)}\n                onblur={() => (this.focused = false)}\n              />\n            </div>\n          </div>\n          <div className=\"TagSelectionModal-form-submit App-primaryControl\">\n            <Button\n              type=\"submit\"\n              className=\"Button Button--primary\"\n              disabled={!this.meetsRequirements(primaryCount, secondaryCount)}\n              icon=\"fas fa-check\"\n            >\n              {app.translator.trans('flarum-tags.lib.tag_selection_modal.submit_button')}\n            </Button>\n          </div>\n        </div>\n      </div>,\n\n      <div className=\"Modal-footer\">\n        <ul className=\"TagSelectionModal-list SelectTagList\">\n          {tags.map((tag) => (\n            <li\n              data-index={tag.id()}\n              className={classList({\n                pinned: tag.position() !== null,\n                child: !!tag.parent(),\n                colored: !!tag.color(),\n                selected: this.selected.includes(tag),\n                active: this.indexTag === tag,\n              })}\n              style={{ color: tag.color() }}\n              onmouseover={() => (this.indexTag = tag)}\n              onclick={this.toggleTag.bind(this, tag)}\n            >\n              {tagIcon(tag)}\n              <span className=\"SelectTagListItem-name\">{highlight(tag.name(), filter)}</span>\n              {tag.description() ? <span className=\"SelectTagListItem-description\">{tag.description()}</span> : ''}\n            </li>\n          ))}\n        </ul>\n        {this.attrs.limits!.allowBypassing && (\n          <div className=\"TagSelectionModal-controls\">\n            <ToggleButton className=\"Button\" onclick={() => (this.bypassReqs = !this.bypassReqs)} isToggled={this.bypassReqs}>\n              {app.translator.trans('flarum-tags.lib.tag_selection_modal.bypass_requirements')}\n            </ToggleButton>\n          </div>\n        )}\n      </div>,\n    ];\n  }\n\n  /**\n   * Filters the available tags on every state change.\n   */\n  private getFilteredTags(): Tag[] {\n    const filter = this.filter().toLowerCase();\n    const primaryCount = this.primaryCount();\n    const secondaryCount = this.secondaryCount();\n    let tags = this.tags;\n\n    if (this.attrs.requireParentTag) {\n      // Filter out all child tags whose parents have not been selected. This\n      // makes it impossible to select a child if its parent hasn't been selected.\n      tags = tags.filter((tag) => {\n        const parent = tag.parent();\n        return parent !== null && (parent === false || this.selected.includes(parent));\n      });\n    }\n\n    if (!this.bypassReqs) {\n      // If we reached the total maximum number of tags, we can't select anymore.\n      if (this.selected.length >= this.attrs.limits!.max!.total!) {\n        tags = tags.filter((tag) => this.selected.includes(tag));\n      }\n      // If the number of selected primary/secondary tags is at the maximum, then\n      // we'll filter out all other tags of that type.\n      else {\n        if (primaryCount >= this.attrs.limits!.max!.primary!) {\n          tags = tags.filter((tag) => !tag.isPrimary() || this.selected.includes(tag));\n        }\n        if (secondaryCount >= this.attrs.limits!.max!.secondary!) {\n          tags = tags.filter((tag) => tag.isPrimary() || this.selected.includes(tag));\n        }\n      }\n    }\n\n    // If the user has entered text in the filter input, then filter by tags\n    // whose name matches what they've entered.\n    if (filter) {\n      tags = tags.filter((tag) => tag.name().toLowerCase().includes(filter));\n    }\n\n    if (!this.indexTag || !tags.includes(this.indexTag)) this.indexTag = tags[0];\n\n    return tags;\n  }\n\n  /**\n   * Counts the number of selected primary tags.\n   */\n  protected primaryCount(): number {\n    return this.selected.filter((tag) => tag.isPrimary()).length;\n  }\n\n  /**\n   * Counts the number of selected secondary tags.\n   */\n  protected secondaryCount(): number {\n    return this.selected.filter((tag) => !tag.isPrimary()).length;\n  }\n\n  /**\n   * Validates the number of selected primary/secondary tags against the set min max limits.\n   */\n  protected meetsRequirements(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs || (this.attrs.allowResetting && this.selected.length === 0)) {\n      return true;\n    }\n\n    if (this.selected.length < this.attrs.limits!.min!.total!) {\n      return false;\n    }\n\n    return primaryCount >= this.attrs.limits!.min!.primary! && secondaryCount >= this.attrs.limits!.min!.secondary!;\n  }\n\n  /**\n   * Add the given tag to the list of selected tags.\n   */\n  protected addTag(tag: Tag | undefined) {\n    if (!tag || !this.attrs.canSelect(tag)) return;\n\n    if (this.attrs.onSelect) {\n      this.attrs.onSelect(tag, this.selected);\n    }\n\n    // If this tag has a parent, we'll also need to add the parent tag to the\n    // selected list if it's not already in there.\n    if (this.attrs.requireParentTag) {\n      const parent = tag.parent();\n      if (parent && !this.selected.includes(parent)) {\n        this.selected.push(parent);\n      }\n    }\n\n    if (!this.selected.includes(tag)) {\n      this.selected.push(tag);\n    }\n  }\n\n  /**\n   * Remove the given tag from the list of selected tags.\n   */\n  protected removeTag(tag: Tag) {\n    const index = this.selected.indexOf(tag);\n\n    if (index !== -1) {\n      this.selected.splice(index, 1);\n\n      // Look through the list of selected tags for any tags which have the tag\n      // we just removed as their parent. We'll need to remove them too.\n      if (this.attrs.requireParentTag) {\n        this.selected.filter((t) => t.parent() === tag).forEach(this.removeTag.bind(this));\n      }\n\n      if (this.attrs.onDeselect) {\n        this.attrs.onDeselect(tag, this.selected);\n      }\n    }\n  }\n\n  protected toggleTag(tag: Tag) {\n    // Won't happen, needed for type safety.\n    if (!this.tags) return;\n\n    if (this.selected.includes(tag)) {\n      this.removeTag(tag);\n    } else {\n      this.addTag(tag);\n    }\n\n    if (this.filter()) {\n      this.filter('');\n      this.indexTag = this.tags[0];\n    }\n\n    this.onready();\n  }\n\n  /**\n   * Gives human text instructions based on the current number of selected tags and set limits.\n   */\n  protected getInstruction(primaryCount: number, secondaryCount: number) {\n    if (this.bypassReqs) {\n      return '';\n    }\n\n    if (primaryCount < this.attrs.limits!.min!.primary!) {\n      const remaining = this.attrs.limits!.min!.primary! - primaryCount;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_primary_placeholder', { count: remaining }));\n    } else if (secondaryCount < this.attrs.limits!.min!.secondary!) {\n      const remaining = this.attrs.limits!.min!.secondary! - secondaryCount;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_secondary_placeholder', { count: remaining }));\n    } else if (this.selected.length < this.attrs.limits!.min!.total!) {\n      const remaining = this.attrs.limits!.min!.total! - this.selected.length;\n      return extractText(app.translator.trans('flarum-tags.lib.tag_selection_modal.choose_tags_placeholder', { count: remaining }));\n    }\n\n    return '';\n  }\n\n  /**\n   * Submit tag selection.\n   */\n  onsubmit(e: SubmitEvent) {\n    e.preventDefault();\n\n    if (this.attrs.onsubmit) this.attrs.onsubmit(this.selected);\n\n    this.hide();\n  }\n\n  protected select(e: KeyboardEvent) {\n    // Ctrl + Enter submits the selection, just Enter completes the current entry\n    if (e.metaKey || e.ctrlKey || (this.indexTag && this.selected.includes(this.indexTag))) {\n      if (this.selected.length) {\n        // The DOM submit method doesn't emit a `submit event, so we\n        // simulate a manual submission so our `onsubmit` logic is run.\n        this.$('button[type=\"submit\"]').click();\n      }\n    } else if (this.indexTag) {\n      this.getItem(this.indexTag)[0].dispatchEvent(new Event('click'));\n    }\n  }\n\n  protected selectableItems() {\n    return this.$('.TagSelectionModal-list > li');\n  }\n\n  protected getCurrentNumericIndex() {\n    if (!this.indexTag) return -1;\n\n    return this.selectableItems().index(this.getItem(this.indexTag));\n  }\n\n  protected getItem(selectedTag: Tag) {\n    return this.selectableItems().filter(`[data-index=\"${selectedTag.id()}\"]`);\n  }\n\n  protected setIndex(index: number, scrollToItem: boolean) {\n    const $items = this.selectableItems();\n    const $dropdown = $items.parent();\n\n    if (index < 0) {\n      index = $items.length - 1;\n    } else if (index >= $items.length) {\n      index = 0;\n    }\n\n    const $item = $items.eq(index);\n\n    this.indexTag = app.store.getById('tags', $item.attr('data-index')!);\n\n    m.redraw();\n\n    if (scrollToItem && this.indexTag) {\n      const dropdownScroll = $dropdown.scrollTop()!;\n      const dropdownTop = $dropdown.offset()!.top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight()!;\n      const itemTop = $item.offset()!.top;\n      const itemBottom = itemTop + $item.outerHeight()!;\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n\n/**\n * Catch invalid limits provided to the tag selection modal.\n */\nfunction catchInvalidLimits(limits: ITagSelectionModalLimits) {\n  if (limits.min!.primary! > limits.max!.primary!) {\n    throw new Error('The minimum number of primary tags allowed cannot be more than the maximum number of primary tags allowed.');\n  }\n\n  if (limits.min!.secondary! > limits.max!.secondary!) {\n    throw new Error('The minimum number of secondary tags allowed cannot be more than the maximum number of secondary tags allowed.');\n  }\n\n  if (limits.min!.total! > limits.max!.primary! + limits.max!.secondary!) {\n    throw new Error('The minimum number of tags allowed cannot be more than the maximum number of primary and secondary tags allowed together.');\n  }\n\n  if (limits.max!.total! < limits.min!.primary! + limits.min!.secondary!) {\n    throw new Error('The maximum number of tags allowed cannot be less than the minimum number of primary and secondary tags allowed together.');\n  }\n\n  if (limits.min!.total! > limits.max!.total!) {\n    throw new Error('The minimum number of tags allowed cannot be more than the maximum number of tags allowed.');\n  }\n}\n","import app from 'flarum/forum/app';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport classList from 'flarum/common/utils/classList';\nimport extractText from 'flarum/common/utils/extractText';\n\nimport getSelectableTags from '../utils/getSelectableTags';\nimport TagSelectionModal, { ITagSelectionModalAttrs } from '../../common/components/TagSelectionModal';\n\nimport type Discussion from 'flarum/common/models/Discussion';\nimport type Tag from '../../common/models/Tag';\n\nexport interface TagDiscussionModalAttrs extends ITagSelectionModalAttrs {\n  discussion?: Discussion;\n}\n\nexport default class TagDiscussionModal extends TagSelectionModal<TagDiscussionModalAttrs> {\n  static initAttrs(attrs: TagDiscussionModalAttrs) {\n    super.initAttrs(attrs);\n\n    const title = attrs.discussion\n      ? app.translator.trans('flarum-tags.forum.choose_tags.edit_title', { title: <em>{attrs.discussion.title()}</em> })\n      : app.translator.trans('flarum-tags.forum.choose_tags.title');\n\n    attrs.className = classList(attrs.className, 'TagDiscussionModal');\n    attrs.title = extractText(title);\n    attrs.allowResetting = !!app.forum.attribute('canBypassTagCounts');\n    attrs.limits = {\n      allowBypassing: attrs.allowResetting,\n      max: {\n        primary: app.forum.attribute<number>('maxPrimaryTags'),\n        secondary: app.forum.attribute<number>('maxSecondaryTags'),\n      },\n      min: {\n        primary: app.forum.attribute<number>('minPrimaryTags'),\n        secondary: app.forum.attribute<number>('minSecondaryTags'),\n      },\n    };\n    attrs.requireParentTag = true;\n    attrs.selectableTags = () => getSelectableTags(attrs.discussion);\n    attrs.selectedTags ??= (attrs.discussion?.tags() as Tag[]) || [];\n    attrs.canSelect = (tag) => tag.canStartDiscussion();\n\n    const suppliedOnsubmit = attrs.onsubmit || null;\n\n    // Save changes.\n    attrs.onsubmit = function (tags) {\n      const discussion = attrs.discussion;\n\n      if (discussion) {\n        discussion.save({ relationships: { tags } }).then(() => {\n          if (app.current.matches(DiscussionPage)) {\n            app.current.get('stream').update();\n          }\n\n          m.redraw();\n        });\n      }\n\n      if (suppliedOnsubmit) suppliedOnsubmit(tags);\n    };\n  }\n}\n","import { extend } from 'flarum/common/extend';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport Button from 'flarum/common/components/Button';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\n\nexport default function () {\n  // Add a control allowing the discussion to be moved to another category.\n  extend(DiscussionControls, 'moderationControls', function (items, discussion) {\n    if (discussion.canTag()) {\n      items.add(\n        'tags',\n        <Button icon=\"fas fa-tag\" onclick={() => app.modal.show(TagDiscussionModal, { discussion })}>\n          {app.translator.trans('flarum-tags.forum.discussion_controls.edit_tags_button')}\n        </Button>\n      );\n    }\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","import { extend, override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\nimport classList from 'flarum/common/utils/classList';\n\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport tagsLabel from '../common/helpers/tagsLabel';\nimport getSelectableTags from './utils/getSelectableTags';\n\nexport default function () {\n  extend(IndexPage.prototype, 'newDiscussionAction', function (promise) {\n    // From `addTagFilter\n    const tag = this.currentTag();\n\n    if (tag) {\n      const parent = tag.parent();\n      const tags = parent ? [parent, tag] : [tag];\n      promise.then((composer) => (composer.fields.tags = tags));\n    } else {\n      app.composer.fields.tags = [];\n    }\n  });\n\n  extend(DiscussionComposer.prototype, 'oninit', function () {\n    app.tagList.load(['parent']).then(() => m.redraw());\n  });\n\n  // Add tag-selection abilities to the discussion composer.\n  DiscussionComposer.prototype.chooseTags = function () {\n    const selectableTags = getSelectableTags();\n\n    if (!selectableTags.length) return;\n\n    app.modal.show(TagDiscussionModal, {\n      selectedTags: (this.composer.fields.tags || []).slice(0),\n      onsubmit: (tags) => {\n        this.composer.fields.tags = tags;\n        this.$('textarea').focus();\n      },\n    });\n  };\n\n  // Add a tag-selection menu to the discussion composer's header, after the\n  // title.\n  extend(DiscussionComposer.prototype, 'headerItems', function (items) {\n    const tags = this.composer.fields.tags || [];\n    const selectableTags = getSelectableTags();\n\n    items.add(\n      'tags',\n      <a className={classList(['DiscussionComposer-changeTags', !selectableTags.length && 'disabled'])} onclick={this.chooseTags.bind(this)}>\n        {tags.length ? (\n          tagsLabel(tags)\n        ) : (\n          <span className=\"TagLabel untagged\">{app.translator.trans('flarum-tags.forum.composer_discussion.choose_tags_link')}</span>\n        )}\n      </a>,\n      10\n    );\n  });\n\n  override(DiscussionComposer.prototype, 'onsubmit', function (original) {\n    const chosenTags = this.composer.fields.tags || [];\n    const chosenPrimaryTags = chosenTags.filter((tag) => tag.position() !== null && !tag.isChild());\n    const chosenSecondaryTags = chosenTags.filter((tag) => tag.position() === null);\n    const selectableTags = getSelectableTags();\n\n    const minPrimaryTags = parseInt(app.forum.attribute('minPrimaryTags'));\n    const minSecondaryTags = parseInt(app.forum.attribute('minSecondaryTags'));\n    const maxPrimaryTags = parseInt(app.forum.attribute('maxPrimaryTags'));\n    const maxSecondaryTags = parseInt(app.forum.attribute('maxSecondaryTags'));\n\n    if (\n      ((!chosenTags.length && maxPrimaryTags !== 0 && maxSecondaryTags !== 0) ||\n        chosenPrimaryTags.length < minPrimaryTags ||\n        chosenSecondaryTags.length < minSecondaryTags) &&\n      selectableTags.length\n    ) {\n      app.modal.show(TagDiscussionModal, {\n        selectedTags: chosenTags,\n        onsubmit: (tags) => {\n          this.composer.fields.tags = tags;\n          original();\n        },\n      });\n    } else {\n      original();\n    }\n  });\n\n  // Add the selected tags as data to submit to the server.\n  extend(DiscussionComposer.prototype, 'data', function (data) {\n    data.relationships = data.relationships || {};\n    data.relationships.tags = this.composer.fields.tags;\n  });\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/EventPost'];","import EventPost from 'flarum/forum/components/EventPost';\nimport tagsLabel from '../../common/helpers/tagsLabel';\n\nexport default class DiscussionTaggedPost extends EventPost {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n\n    const oldTags = attrs.post.content()[0];\n    const newTags = attrs.post.content()[1];\n\n    function diffTags(tags1, tags2) {\n      return tags1.filter((tag) => tags2.indexOf(tag) === -1).map((id) => app.store.getById('tags', id));\n    }\n\n    attrs.tagsAdded = diffTags(newTags, oldTags);\n    attrs.tagsRemoved = diffTags(oldTags, newTags);\n  }\n\n  icon() {\n    return 'fas fa-tag';\n  }\n\n  descriptionKey() {\n    if (this.attrs.tagsAdded.length) {\n      if (this.attrs.tagsRemoved.length) {\n        return 'flarum-tags.forum.post_stream.added_and_removed_tags_text';\n      }\n\n      return 'flarum-tags.forum.post_stream.added_tags_text';\n    }\n\n    return 'flarum-tags.forum.post_stream.removed_tags_text';\n  }\n\n  descriptionData() {\n    const data = {};\n\n    if (this.attrs.tagsAdded.length) {\n      data.tagsAdded = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsAdded, { link: true }),\n        count: this.attrs.tagsAdded.length,\n      });\n    }\n\n    if (this.attrs.tagsRemoved.length) {\n      data.tagsRemoved = app.translator.trans('flarum-tags.forum.post_stream.tags_text', {\n        tags: tagsLabel(this.attrs.tagsRemoved, { link: true }),\n        count: this.attrs.tagsRemoved.length,\n      });\n    }\n\n    return data;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/computed'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import computed from 'flarum/common/utils/computed';\nimport Model from 'flarum/common/Model';\nimport type Discussion from 'flarum/common/models/Discussion';\n\nexport default class Tag extends Model {\n  name() {\n    return Model.attribute<string>('name').call(this);\n  }\n  slug() {\n    return Model.attribute<string>('slug').call(this);\n  }\n  description() {\n    return Model.attribute<string | null>('description').call(this);\n  }\n\n  color() {\n    return Model.attribute<string | null>('color').call(this);\n  }\n  backgroundUrl() {\n    return Model.attribute<string | null>('backgroundUrl').call(this);\n  }\n  backgroundMode() {\n    return Model.attribute<string | null>('backgroundMode').call(this);\n  }\n  icon() {\n    return Model.attribute<string | null>('icon').call(this);\n  }\n\n  position() {\n    return Model.attribute<number | null>('position').call(this);\n  }\n  parent() {\n    return Model.hasOne<Tag | null>('parent').call(this);\n  }\n  children() {\n    return Model.hasMany<Tag>('children').call(this);\n  }\n  defaultSort() {\n    return Model.attribute<string | null>('defaultSort').call(this);\n  }\n  isChild() {\n    return Model.attribute<boolean>('isChild').call(this);\n  }\n  isHidden() {\n    return Model.attribute<boolean>('isHidden').call(this);\n  }\n\n  discussionCount() {\n    return Model.attribute<number>('discussionCount').call(this);\n  }\n  lastPostedAt() {\n    return Model.attribute('lastPostedAt', Model.transformDate).call(this);\n  }\n  lastPostedDiscussion() {\n    return Model.hasOne<Discussion | null>('lastPostedDiscussion').call(this);\n  }\n\n  isRestricted() {\n    return Model.attribute<boolean>('isRestricted').call(this);\n  }\n  canStartDiscussion() {\n    return Model.attribute<boolean>('canStartDiscussion').call(this);\n  }\n  canAddToDiscussion() {\n    return Model.attribute<boolean>('canAddToDiscussion').call(this);\n  }\n\n  isPrimary() {\n    return computed<boolean, this>('position', 'parent', (position, parent) => position !== null && parent === false).call(this);\n  }\n}\n","import Extend from 'flarum/common/extenders';\nimport Tag from './models/Tag';\n\nexport default [\n  new Extend.Store() //\n    .add('tags', Tag),\n];\n","import app from 'flarum/forum/app';\nimport Extend from 'flarum/common/extenders';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Discussion from 'flarum/common/models/Discussion';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\nimport TagsPage from './components/TagsPage';\nimport Tag from '../common/models/Tag';\n\nimport commonExtend from '../common/extend';\n\nexport default [\n  ...commonExtend,\n\n  new Extend.Routes() //\n    .add('tags', '/tags', TagsPage) //\n    .add('tag', '/t/:tags', IndexPage) //\n    .helper('tag', (tag) => app.route('tag', { tags: tag.slug() })),\n\n  new Extend.PostTypes() //\n    .add('discussionTagged', DiscussionTaggedPost),\n\n  new Extend.Model(Discussion) //\n    .hasMany<Tag>('tags') //\n    .attribute<boolean>('canTag'),\n];\n","import sortTags from './utils/sortTags';\nimport Tag from './models/Tag';\nimport tagsLabel from './helpers/tagsLabel';\nimport tagIcon from './helpers/tagIcon';\nimport tagLabel from './helpers/tagLabel';\nimport TagSelectionModal from './components/TagSelectionModal';\nimport TagListState from './states/TagListState';\n\nexport default {\n  'tags/utils/sortTags': sortTags,\n  'tags/models/Tag': Tag,\n  'tags/helpers/tagsLabel': tagsLabel,\n  'tags/helpers/tagIcon': tagIcon,\n  'tags/helpers/tagLabel': tagLabel,\n  'tags/components/TagSelectionModal': TagSelectionModal,\n  'tags/states/TagListState': TagListState,\n};\n","import compat from '../common/compat';\n\nimport addTagFilter from './addTagFilter';\nimport addTagControl from './addTagControl';\nimport TagHero from './components/TagHero';\nimport TagDiscussionModal from './components/TagDiscussionModal';\nimport TagsPage from './components/TagsPage';\nimport DiscussionTaggedPost from './components/DiscussionTaggedPost';\nimport TagLinkButton from './components/TagLinkButton';\nimport addTagList from './addTagList';\nimport addTagLabels from './addTagLabels';\nimport addTagComposer from './addTagComposer';\nimport getSelectableTags from './utils/getSelectableTags';\n\nexport default Object.assign(compat, {\n  'tags/addTagFilter': addTagFilter,\n  'tags/addTagControl': addTagControl,\n  'tags/components/TagHero': TagHero,\n  'tags/components/TagDiscussionModal': TagDiscussionModal,\n  'tags/components/TagsPage': TagsPage,\n  'tags/components/DiscussionTaggedPost': DiscussionTaggedPost,\n  'tags/components/TagLinkButton': TagLinkButton,\n  'tags/addTagList': addTagList,\n  'tags/addTagLabels': addTagLabels,\n  'tags/addTagComposer': addTagComposer,\n  'tags/utils/getSelectableTags': getSelectableTags,\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core;","import app from 'flarum/forum/app';\n\nimport TagListState from '../common/states/TagListState';\n\nimport addTagList from './addTagList';\nimport addTagFilter from './addTagFilter';\nimport addTagLabels from './addTagLabels';\nimport addTagControl from './addTagControl';\nimport addTagComposer from './addTagComposer';\n\nexport { default as extend } from './extend';\n\napp.initializers.add('flarum-tags', function () {\n  app.tagList = new TagListState();\n\n  addTagList();\n  addTagFilter();\n  addTagLabels();\n  addTagControl();\n  addTagComposer();\n});\n\n// Expose compat API\nimport tagsCompat from './compat';\nimport { compat } from '@flarum/core/forum';\n\nObject.assign(compat, tagsCompat);\n","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n      return ContinueSentinel;\n    }\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) {\n              if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            }\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["flarum","core","compat","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","TagListState","loadedIncludes","load","includes","query","unloadedIncludes","filter","include","has","length","app","Set","join","val","forEach","add","_setPrototypeOf","o","p","Object","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","prototype","create","constructor","tagIcon","tag","attrs","settings","hasIcon","icon","useColor","className","classList","style","color","TagLinkButton","view","vnode","model","description","child","isChild","href","route","title","name","translator","trans","initAttrs","params","tags","slug","LinkButton","tagLabel","link","extract","tagText","textContrastClass","m","Link","sortTags","slice","sort","a","b","aPos","position","bPos","discussionCount","aParent","parent","bParent","TagsPage","oninit","history","push","preloaded","preloadedApiDocument","loading","tagList","store","all","redraw","oncreate","setTitle","setTitleCount","pageContent","toArray","items","ItemList","hero","mainContent","sidebar","content","contentItems","pinned","cloud","tagTileListView","cloudView","IndexPage","listItems","sidebarItems","map","tagTileView","lastPostedDiscussion","children","colored","discussion","lastPostNumber","humanTime","lastPostedAt","Page","extend","currentTag","addTag","active","id","more","splice","TagHero","Component","findTag","find","localeCompare","sensitivity","currentActiveTag","currentTagLoading","override","original","vdom","canStartDiscussion","newDiscussion","get","disabled","GlobalSearchState","param","DiscussionListState","q","_objectWithoutPropertiesLoose","source","excluded","i","target","sourceKeys","keys","indexOf","tagsLabel","otherAttrs","DiscussionListItem","DiscussionHero","getSelectableTags","canAddToDiscussion","ToggleButton","isToggled","TagSelectionModal","selected","bypassReqs","Stream","focused","navigator","KeyboardNavigatable","indexTag","extractText","canSelect","allowResetting","limits","min","total","primary","secondary","max","Infinity","Error","catchInvalidLimits","onUp","setIndex","getCurrentNumericIndex","onDown","onSelect","select","onRemove","selectableTags","selectedTags","toLowerCase","primaryCount","secondaryCount","getFilteredTags","inputWidth","Math","getInstruction","onclick","$","focus","removeTag","onready","placeholder","bidi","width","onkeydown","navigate","onfocus","onblur","type","meetsRequirements","onmouseover","toggleTag","highlight","allowBypassing","requireParentTag","isPrimary","index","t","onDeselect","remaining","count","onsubmit","e","preventDefault","hide","metaKey","ctrlKey","click","getItem","dispatchEvent","Event","selectableItems","selectedTag","scrollToItem","$items","$dropdown","$item","eq","attr","scrollTop","dropdownScroll","dropdownTop","offset","top","dropdownBottom","outerHeight","itemTop","itemBottom","parseInt","css","stop","animate","Modal","TagDiscussionModal","suppliedOnsubmit","save","relationships","DiscussionPage","update","DiscussionControls","canTag","modal","show","promise","composer","fields","DiscussionComposer","chooseTags","chosenTags","chosenPrimaryTags","chosenSecondaryTags","minPrimaryTags","forum","attribute","minSecondaryTags","maxPrimaryTags","maxSecondaryTags","data","DiscussionTaggedPost","oldTags","post","newTags","diffTags","tags1","tags2","getById","tagsAdded","tagsRemoved","descriptionKey","descriptionData","EventPost","Tag","Model","call","backgroundUrl","backgroundMode","defaultSort","isHidden","isRestricted","computed","Extend","commonExtend","helper","Discussion","hasMany","assign","addTagFilter","addTagControl","addTagList","addTagLabels","addTagComposer","tagsCompat","_typeof","require","_regeneratorRuntime","module","exports","__esModule","Op","hasOwn","hasOwnProperty","defineProperty","obj","desc","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","makeInvokeMethod","tryCatch","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","record","result","__await","unwrapped","previousPromise","callInvokeWithMethodAndArg","state","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","iter","object","reverse","pop","skipTempReset","prev","charAt","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","definition","prop","r"],"sourceRoot":""}