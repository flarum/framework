{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/typeof.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/regenerator/index.js","webpack://@flarum/mentions/webpack/bootstrap","webpack://@flarum/mentions/webpack/runtime/compat get default export","webpack://@flarum/mentions/webpack/runtime/define property getters","webpack://@flarum/mentions/webpack/runtime/hasOwnProperty shorthand","webpack://@flarum/mentions/webpack/runtime/make namespace object","webpack://@flarum/mentions/external root \"flarum.core.compat['common/extend']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/app']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/NotificationGrid']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/utils/string']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/textContrastClass']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/Post']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/PostPreview']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/Link']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/punctuateSeries']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/Button']\"","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://@flarum/mentions/external root \"flarum.core.compat['common/states/PaginatedListState']\"","webpack://@flarum/mentions/./src/forum/state/MentionedByModalState.ts","webpack://@flarum/mentions/./src/forum/components/MentionedByModal.tsx","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/EditPostComposer']\"","webpack://@flarum/mentions/./src/forum/utils/reply.js","webpack://@flarum/mentions/external root \"flarum.core.compat['common/Fragment']\"","webpack://@flarum/mentions/./src/forum/fragments/PostQuoteButton.js","webpack://@flarum/mentions/./src/forum/utils/selectedText.js","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/utils/KeyboardNavigatable']\"","webpack://@flarum/mentions/./src/forum/fragments/AutocompleteDropdown.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack://@flarum/mentions/../../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://@flarum/mentions/external root \"flarum.core.compat['common/Component']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@flarum/mentions/./src/forum/components/MentionsDropdownItem.tsx","webpack://@flarum/mentions/external root \"flarum.core.compat['common/utils/throttleDebounce']\"","webpack://@flarum/mentions/./src/forum/mentionables/MentionableModels.tsx","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/Notification']\"","webpack://@flarum/mentions/./src/forum/components/PostMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/UserMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/GroupMentionedNotification.js","webpack://@flarum/mentions/./src/forum/mentionables/formats/MentionFormat.ts","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flarum/mentions/./src/forum/mentionables/MentionableModel.ts","webpack://@flarum/mentions/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@flarum/mentions/./src/forum/utils/getCleanDisplayName.js","webpack://@flarum/mentions/./src/forum/mentionables/UserMention.tsx","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@flarum/mentions/./src/forum/mentionables/PostMention.tsx","webpack://@flarum/mentions/external root \"flarum.core.compat['common/models/Group']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@flarum/mentions/./src/forum/mentionables/GroupMention.tsx","webpack://@flarum/mentions/./src/forum/mentionables/formats/AtMentionFormat.ts","webpack://@flarum/mentions/./src/forum/mentionables/TagMention.tsx","webpack://@flarum/mentions/./src/forum/mentionables/formats/HashMentionFormat.ts","webpack://@flarum/mentions/./src/forum/mentionables/formats/MentionFormats.ts","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/models/User']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/Model']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/extenders']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['common/models/Post']\"","webpack://@flarum/mentions/external root \"flarum.core.compat['forum/components/PostsUserPage']\"","webpack://@flarum/mentions/./src/forum/components/MentionsUserPage.js","webpack://@flarum/mentions/./src/forum/extend.ts","webpack://@flarum/mentions/./src/forum/utils/textFormatter.js","webpack://@flarum/mentions/./src/forum/compat.js","webpack://@flarum/mentions/./src/forum/utils/getMentionText.js","webpack://@flarum/mentions/./src/forum/extenders/Mentionables.ts","webpack://@flarum/mentions/external assign \"flarum.core\"","webpack://@flarum/mentions/./src/forum/index.js","webpack://@flarum/mentions/./src/forum/addComposerAutocomplete.js","webpack://@flarum/mentions/./src/forum/addPostMentionPreviews.js","webpack://@flarum/mentions/./src/forum/addMentionedByList.js","webpack://@flarum/mentions/./src/forum/addPostReplyAction.js","webpack://@flarum/mentions/./src/forum/addPostQuoteButton.js"],"sourcesContent":["var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (undefined === method) {\n      if (context.delegate = null, \"throw\" === context.method) {\n        if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel;\n        context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n      }\n      return ContinueSentinel;\n    }\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) {\n              if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            }\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) {\n        \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n      }\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/NotificationGrid'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/string'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/textContrastClass'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostPreview'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/punctuateSeries'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/states/PaginatedListState'];","import PaginatedListState, { PaginatedListParams } from 'flarum/common/states/PaginatedListState';\nimport Post from 'flarum/common/models/Post';\n\nexport interface MentionedByModalListParams extends PaginatedListParams {\n  filter: {\n    mentionedPost: string;\n  };\n  sort?: string;\n  page?: {\n    offset?: number;\n    limit: number;\n  };\n}\n\nexport default class MentionedByModalState<P extends MentionedByModalListParams = MentionedByModalListParams> extends PaginatedListState<Post, P> {\n  constructor(params: P, page: number = 1) {\n    const limit = 10;\n\n    params.page = { ...(params.page || {}), limit };\n\n    super(params, page, limit);\n  }\n\n  get type(): string {\n    return 'posts';\n  }\n}\n","import app from 'flarum/forum/app';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\nimport type Mithril from 'mithril';\nimport type Post from 'flarum/common/models/Post';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Button from 'flarum/common/components/Button';\nimport MentionedByModalState from '../state/MentionedByModalState';\n\nexport interface IMentionedByModalAttrs extends IInternalModalAttrs {\n  post: Post;\n}\n\nexport default class MentionedByModal<CustomAttrs extends IMentionedByModalAttrs = IMentionedByModalAttrs> extends Modal<\n  CustomAttrs,\n  MentionedByModalState\n> {\n  oninit(vnode: Mithril.Vnode<CustomAttrs, this>) {\n    super.oninit(vnode);\n\n    this.state = new MentionedByModalState({\n      filter: {\n        mentionedPost: this.attrs.post.id()!,\n      },\n      sort: 'number',\n    });\n\n    this.state.refresh();\n  }\n\n  className(): string {\n    return 'MentionedByModal';\n  }\n\n  title(): Mithril.Children {\n    return app.translator.trans('flarum-mentions.forum.mentioned_by.title');\n  }\n\n  content(): Mithril.Children {\n    return (\n      <>\n        <div className=\"Modal-body\">\n          {this.state.isInitialLoading() ? (\n            <LoadingIndicator />\n          ) : (\n            <>\n              <ul className=\"MentionedByModal-list Dropdown-menu Dropdown-menu--inline Post-mentionedBy-preview\">\n                {this.state.getPages().map((page) =>\n                  page.items.map((reply) => (\n                    <li data-number={reply.number()}>\n                      <PostPreview post={reply} onclick={() => app.modal.close()} />\n                    </li>\n                  ))\n                )}\n              </ul>\n            </>\n          )}\n        </div>\n        {this.state.hasNext() && (\n          <div className=\"Modal-footer\">\n            <div className=\"Form Form--centered\">\n              <div className=\"Form-group\">\n                <Button className=\"Button Button--block\" onclick={() => this.state.loadNext()} loading={this.state.isLoadingNext()}>\n                  {app.translator.trans('flarum-mentions.forum.mentioned_by.load_more_button')}\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/EditPostComposer'];","import app from 'flarum/forum/app';\nimport DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport EditPostComposer from 'flarum/forum/components/EditPostComposer';\n\nexport function insertMention(post, composer, quote) {\n  return new Promise((resolve) => {\n    const mention = app.mentionFormats.mentionable('post').replacement(post) + ' ';\n\n    // If the composer is empty, then assume we're starting a new reply.\n    // In which case we don't want the user to have to confirm if they\n    // close the composer straight away.\n    if (!composer.fields.content()) {\n      composer.body.attrs.originalContent = mention;\n    }\n\n    const cursorPosition = composer.editor.getSelectionRange()[0];\n    const preceding = composer.fields.content().slice(0, cursorPosition);\n    const precedingNewlines = preceding.length == 0 ? 0 : 3 - preceding.match(/(\\n{0,2})$/)[0].length;\n\n    composer.editor.insertAtCursor(\n      Array(precedingNewlines).join('\\n') + // Insert up to two newlines, depending on preceding whitespace\n        (quote ? '> ' + mention + quote.trim().replace(/\\n/g, '\\n> ') + '\\n\\n' : mention),\n      false\n    );\n    return resolve(composer);\n  });\n}\n\nexport default function reply(post, quote) {\n  if (app.composer.bodyMatches(EditPostComposer) && app.composer.body.attrs.post.discussion() === post.discussion()) {\n    // If we're already editing a post in the discussion of post we're quoting,\n    // insert the mention directly.\n    return insertMention(post, app.composer, quote);\n  } else {\n    // The default \"Reply\" action behavior will only open a new composer if\n    // necessary, but it will always be a ReplyComposer, hence the exceptional\n    // case above.\n    return DiscussionControls.replyAction.call(post.discussion()).then((composer) => insertMention(post, composer, quote));\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Fragment'];","import app from 'flarum/forum/app';\nimport Fragment from 'flarum/common/Fragment';\nimport icon from 'flarum/common/helpers/icon';\n\nimport reply from '../utils/reply';\n\nexport default class PostQuoteButton extends Fragment {\n  constructor(post) {\n    super();\n\n    this.post = post;\n  }\n\n  view() {\n    return (\n      <button\n        className=\"Button PostQuoteButton\"\n        onclick={() => {\n          reply(this.post, this.content);\n        }}\n      >\n        {icon('fas fa-quote-left', { className: 'Button-icon' })}\n        {app.translator.trans('flarum-mentions.forum.post.quote_button')}\n      </button>\n    );\n  }\n\n  show(left, top) {\n    const $this = this.$().show();\n    const parentOffset = $this.offsetParent().offset();\n\n    $this.css('left', left - parentOffset.left).css('top', top - parentOffset.top);\n\n    this.hideHandler = this.hide.bind(this);\n    $(document).on('mouseup', this.hideHandler);\n  }\n\n  showStart(left, top) {\n    const $this = this.$();\n\n    this.show(left, $(window).scrollTop() + top - $this.outerHeight() - 5);\n  }\n\n  showEnd(right, bottom) {\n    const $this = this.$();\n\n    this.show(right - $this.outerWidth(), $(window).scrollTop() + bottom + 5);\n  }\n\n  hide() {\n    this.$().hide();\n    $(document).off('mouseup', this.hideHandler);\n  }\n}\n","/**\n * Finds the selected text in the provided composer body.\n */\nexport default function selectedText(body) {\n  const selection = window.getSelection();\n\n  if (!selection.isCollapsed) {\n    const range = selection.getRangeAt(0);\n    const parent = range.commonAncestorContainer;\n\n    if (body[0] === parent || $.contains(body[0], parent)) {\n      const clone = $('<div>').append(range.cloneContents());\n\n      // Replace emoji images with their shortcode (found in alt attribute)\n      clone.find('img.emoji').replaceWith(function () {\n        return this.alt;\n      });\n\n      // Replace all other images with a Markdown image\n      clone.find('img').replaceWith(function () {\n        return `![](${this.src})`;\n      });\n\n      // Replace all links with a Markdown link\n      clone.find('a').replaceWith(function () {\n        return `[${this.innerText}](${this.href})`;\n      });\n\n      return clone.text();\n    }\n  }\n  return '';\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/KeyboardNavigatable'];","import Fragment from 'flarum/common/Fragment';\n\nexport default class AutocompleteDropdown extends Fragment {\n  items = [];\n  active = false;\n  index = 0;\n  keyWasJustPressed = false;\n\n  view() {\n    return (\n      <ul className=\"Dropdown-menu MentionsDropdown\">\n        {this.items.map((item) => (\n          <li>{item}</li>\n        ))}\n      </ul>\n    );\n  }\n\n  show(left, top) {\n    this.$()\n      .show()\n      .css({\n        left: left + 'px',\n        top: top + 'px',\n      });\n    this.active = true;\n  }\n\n  hide() {\n    this.$().hide();\n    this.active = false;\n  }\n\n  navigate(delta) {\n    this.keyWasJustPressed = true;\n    this.setIndex(this.index + delta, true);\n    clearTimeout(this.keyWasJustPressedTimeout);\n    this.keyWasJustPressedTimeout = setTimeout(() => (this.keyWasJustPressed = false), 500);\n  }\n\n  complete() {\n    this.$('li').eq(this.index).find('button').click();\n  }\n\n  setIndex(index, scrollToItem) {\n    if (this.keyWasJustPressed && !scrollToItem) return;\n\n    const $dropdown = this.$();\n    const $items = $dropdown.find('li');\n    let rangedIndex = index;\n\n    if (rangedIndex < 0) {\n      rangedIndex = $items.length - 1;\n    } else if (rangedIndex >= $items.length) {\n      rangedIndex = 0;\n    }\n\n    this.index = rangedIndex;\n\n    const $item = $items.removeClass('active').eq(rangedIndex).addClass('active');\n\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","import Component from 'flarum/common/Component';\nimport type { ComponentAttrs } from 'flarum/common/Component';\nimport classList from 'flarum/common/utils/classList';\nimport type MentionableModel from '../mentionables/MentionableModel';\nimport type Mithril from 'mithril';\n\nexport interface IMentionsDropdownItemAttrs extends ComponentAttrs {\n  mentionable: MentionableModel;\n  onclick: () => void;\n  onmouseenter: () => void;\n}\n\nexport default class MentionsDropdownItem<CustomAttrs extends IMentionsDropdownItemAttrs> extends Component<CustomAttrs> {\n  view(vnode: Mithril.Vnode<CustomAttrs>): Mithril.Children {\n    const { mentionable, ...attrs } = this.attrs;\n\n    const className = classList('MentionsDropdownItem', 'PostPreview', `MentionsDropdown-${mentionable.type()}`);\n\n    return (\n      <button className={className} {...attrs}>\n        <span className=\"PostPreview-content\">{vnode.children}</span>\n      </button>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/throttleDebounce'];","import type MentionableModel from './MentionableModel';\nimport type Model from 'flarum/common/Model';\nimport type Mithril from 'mithril';\nimport MentionsDropdownItem from '../components/MentionsDropdownItem';\nimport { throttle } from 'flarum/common/utils/throttleDebounce';\n\nexport default class MentionableModels {\n  protected mentionables?: MentionableModel[];\n  /**\n   * We store models returned from an API here to preserve order in which they are returned\n   * This prevents the list jumping around while models are returned.\n   * We also use a hashmap for model IDs to provide O(1) lookup for the users already in the list.\n   */\n  private results: Record<string, Map<string, Model>> = {};\n  public typed: string | null = null;\n  private searched: string[] = [];\n  private dropdownItemAttrs: Record<string, any> = {};\n\n  constructor(dropdownItemAttrs: Record<string, any>) {\n    this.dropdownItemAttrs = dropdownItemAttrs;\n  }\n\n  public init(mentionables: MentionableModel[]): void {\n    this.typed = null;\n    this.mentionables = mentionables;\n\n    for (const mentionable of this.mentionables) {\n      this.results[mentionable.type()] = new Map(mentionable.initialResults().map((result) => [result.id() as string, result]));\n    }\n  }\n\n  /**\n   * Don't send API calls searching for models until at least 2 characters have been typed.\n   * This focuses the mention results on models already loaded.\n   */\n  public readonly search = throttle(250, async (): Promise<void> => {\n    if (!this.typed || this.typed.length <= 1) return;\n\n    const typedLower = this.typed.toLowerCase();\n\n    if (this.searched.includes(typedLower)) return;\n\n    for (const mentionable of this.mentionables!) {\n      for (const model of await mentionable.search(typedLower)) {\n        if (!this.results[mentionable.type()].has(model.id() as string)) {\n          this.results[mentionable.type()].set(model.id() as string, model);\n        }\n      }\n    }\n\n    this.searched.push(typedLower);\n\n    return Promise.resolve();\n  });\n\n  public matches(mentionable: MentionableModel, model: Model): boolean {\n    return mentionable.matches(model, this.typed?.toLowerCase() || '');\n  }\n\n  public makeSuggestion(mentionable: MentionableModel, model: Model): Mithril.Children {\n    const content = mentionable.suggestion(model, this.typed!);\n    const replacement = mentionable.replacement(model);\n\n    const { onclick, ...attrs } = this.dropdownItemAttrs;\n\n    return (\n      <MentionsDropdownItem mentionable={mentionable} onclick={() => onclick(replacement)} {...attrs}>\n        {content}\n      </MentionsDropdownItem>\n    );\n  }\n\n  public buildSuggestions(): Mithril.Children {\n    const suggestions: Mithril.Children = [];\n\n    for (const mentionable of this.mentionables!) {\n      if (!mentionable.enabled()) continue;\n\n      let matches = Array.from(this.results[mentionable.type()].values()).filter((model) => this.matches(mentionable, model));\n\n      const max = mentionable.maxStoreMatchedResults();\n      if (max) matches = matches.splice(0, max);\n\n      for (const model of matches) {\n        const dropdownItem = this.makeSuggestion(mentionable, model);\n        suggestions.push(dropdownItem);\n      }\n    }\n\n    return suggestions;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Notification'];","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\n\nexport default class PostMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-reply';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const post = notification.subject();\n    const content = notification.content();\n\n    return app.route.discussion(post.discussion(), content && content.replyNumber);\n  }\n\n  content() {\n    const notification = this.attrs.notification;\n    const user = notification.fromUser();\n\n    return app.translator.trans('flarum-mentions.forum.notifications.post_mentioned_text', { user, count: 1 });\n  }\n\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain() || '', 200);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\n\nexport default class UserMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-at';\n  }\n\n  href() {\n    const post = this.attrs.notification.subject();\n\n    return app.route.discussion(post.discussion(), post.number());\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n\n    return app.translator.trans('flarum-mentions.forum.notifications.user_mentioned_text', { user });\n  }\n\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\nimport { truncate } from 'flarum/common/utils/string';\n\nexport default class GroupMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-at';\n  }\n\n  href() {\n    const post = this.attrs.notification.subject();\n\n    return app.route.discussion(post.discussion(), post.number());\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n\n    return app.translator.trans('flarum-mentions.forum.notifications.group_mentioned_text', { user });\n  }\n\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\n","import type MentionableModel from '../MentionableModel';\nimport type Model from 'flarum/common/Model';\n\nexport default abstract class MentionFormat {\n  protected instances?: MentionableModel[];\n\n  public makeMentionables(): MentionableModel[] {\n    return this.instances ?? (this.instances = this.mentionables.map((Mentionable) => new Mentionable(this)));\n  }\n\n  public getMentionable(type: string): MentionableModel | null {\n    return this.makeMentionables().find((mentionable) => mentionable.type() === type) ?? null;\n  }\n\n  public extend(mentionable: new (...args: any[]) => MentionableModel): void {\n    if (!this.extendable) throw new Error('This mention format does not allow extending.');\n\n    this.mentionables.push(mentionable);\n  }\n\n  abstract mentionables: (new (...args: any[]) => MentionableModel)[];\n\n  protected abstract extendable: boolean;\n\n  abstract trigger(): string;\n\n  /**\n   * Picks the term to search in the API from the typed text.\n   * @example:\n   *  * Full text = `Hello @\"John D`\n   *  * Typed text = `\"John D`\n   *  * Query = `John D`\n   */\n  abstract queryFromTyped(typed: string): string | null;\n\n  abstract format(...args: any): string;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/highlight'];","import type Mithril from 'mithril';\nimport type Model from 'flarum/common/Model';\nimport type MentionFormat from './formats/MentionFormat';\n\nexport default abstract class MentionableModel<M extends Model = Model, Format extends MentionFormat = MentionFormat> {\n  public format: Format;\n\n  public constructor(format: Format) {\n    this.format = format;\n  }\n\n  abstract type(): string;\n  abstract initialResults(): M[];\n  abstract search(typed: string): Promise<M[]>;\n  abstract replacement(model: M): string;\n  abstract suggestion(model: M, typed: string): Mithril.Children;\n  abstract matches(model: M, typed: string): boolean;\n  abstract maxStoreMatchedResults(): number | null;\n  abstract enabled(): boolean;\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","import app from 'flarum/forum/app';\nimport extractText from 'flarum/common/utils/extractText';\n\n/**\n * Whether to use the old mentions format.\n *\n * `'@username'` or `'@\"Display name\"'`\n */\nexport const shouldUseOldFormat = () => app.forum.attribute('allowUsernameMentionFormat') || false;\n\nconst getDeletedUserText = () => extractText(app.translator.trans('core.lib.username.deleted_text'));\n\n/**\n * Fetches a user's username or display name.\n *\n * Chooses based on the format option set in the admin settings page.\n *\n * @param user An instance of the User model to fetch the username for\n * @param useDisplayName If `true`, uses `user.displayName()`, otherwise, uses `user.username()`\n */\nexport default function getCleanDisplayName(user, useDisplayName = true) {\n  if (!user) return getDeletedUserText().replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n\n  const text = (useDisplayName ? user.displayName() : user.username()) || getDeletedUserText();\n\n  return text.replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n}\n","import app from 'flarum/forum/app';\nimport type Mithril from 'mithril';\nimport type User from 'flarum/common/models/User';\nimport usernameHelper from 'flarum/common/helpers/username';\nimport avatar from 'flarum/common/helpers/avatar';\nimport highlight from 'flarum/common/helpers/highlight';\nimport MentionableModel from './MentionableModel';\nimport getCleanDisplayName, { shouldUseOldFormat } from '../utils/getCleanDisplayName';\nimport AtMentionFormat from './formats/AtMentionFormat';\n\nexport default class UserMention extends MentionableModel<User, AtMentionFormat> {\n  type(): string {\n    return 'user';\n  }\n\n  initialResults(): User[] {\n    return Array.from(app.store.all<User>('users'));\n  }\n\n  /**\n   * Automatically determines which mention syntax to be used based on the option in the\n   * admin dashboard. Also performs display name clean-up automatically.\n   *\n   * @\"Display name\"#UserID or `@username`\n   *\n   * @example <caption>New display name syntax</caption>\n   * // '@\"user\"#1'\n   * forUser(User) // User is ID 1, display name is 'User'\n   *\n   * @example <caption>Using old syntax</caption>\n   * // '@username'\n   * forUser(user) // User's username is 'username'\n   */\n  public replacement(user: User): string {\n    if (shouldUseOldFormat()) {\n      const cleanText = getCleanDisplayName(user, false);\n      return this.format.format(cleanText);\n    }\n\n    const cleanText = getCleanDisplayName(user);\n    return this.format.format(cleanText, '', user.id());\n  }\n\n  suggestion(model: User, typed: string): Mithril.Children {\n    const username = usernameHelper(model);\n\n    if (typed) {\n      username.children = [highlight((username.text ?? '') as string, typed)];\n      delete username.text;\n    }\n\n    return (\n      <>\n        {avatar(model)}\n        {username}\n      </>\n    );\n  }\n\n  matches(model: User, typed: string): boolean {\n    if (!typed) return false;\n\n    const names = [model.username(), model.displayName()];\n\n    return names.some((name) => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n\n  maxStoreMatchedResults(): null {\n    return null;\n  }\n\n  async search(typed: string): Promise<User[]> {\n    return await app.store.find<User[]>('users', { filter: { q: typed }, page: { limit: 5 } });\n  }\n\n  enabled(): boolean {\n    return true;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","import app from 'flarum/forum/app';\nimport MentionableModel from './MentionableModel';\nimport type Post from 'flarum/common/models/Post';\nimport type Mithril from 'mithril';\nimport usernameHelper from 'flarum/common/helpers/username';\nimport avatar from 'flarum/common/helpers/avatar';\nimport highlight from 'flarum/common/helpers/highlight';\nimport { truncate } from 'flarum/common/utils/string';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\nimport EditPostComposer from 'flarum/forum/components/EditPostComposer';\nimport getCleanDisplayName from '../utils/getCleanDisplayName';\nimport type AtMentionFormat from './formats/AtMentionFormat';\n\nexport default class PostMention extends MentionableModel<Post, AtMentionFormat> {\n  type(): string {\n    return 'post';\n  }\n\n  /**\n   * If the user is replying to a discussion, or if they are editing a\n   * post, then we can suggest other posts in the discussion to mention.\n   * We will add the 5 most recent comments in the discussion which\n   * match any username characters that have been typed.\n   */\n  initialResults(): Post[] {\n    if (!app.composer.bodyMatches(ReplyComposer) && !app.composer.bodyMatches(EditPostComposer)) {\n      return [];\n    }\n\n    // @ts-ignore\n    const composerAttrs = app.composer.body.attrs;\n    const composerPost = composerAttrs.post;\n    const discussion = (composerPost && composerPost.discussion()) || composerAttrs.discussion;\n\n    return (\n      discussion\n        .posts()\n        // Filter to only comment posts, and replies before this message\n        .filter((post: Post) => post && post.contentType() === 'comment' && (!composerPost || post.number() < composerPost.number()))\n        // Sort by new to old\n        .sort((a: Post, b: Post) => b.createdAt().getTime() - a.createdAt().getTime())\n    );\n  }\n\n  /**\n   * Generates the syntax for mentioning of a post. Also cleans up the display name.\n   *\n   * @example <caption>Post mention</caption>\n   * // '@\"User\"#p13'\n   * // @\"Display name\"#pPostID\n   * forPostMention(user, 13) // User display name is 'User', post ID is 13\n   */\n  public replacement(post: Post): string {\n    const user = post.user();\n    const cleanText = getCleanDisplayName(user);\n    return this.format.format(cleanText, 'p', post.id());\n  }\n\n  suggestion(model: Post, typed: string): Mithril.Children {\n    const user = model.user() || null;\n    const username = usernameHelper(user);\n\n    if (typed) {\n      username.children = [highlight((username.text ?? '') as string, typed)];\n      delete username.text;\n    }\n\n    return (\n      <>\n        {avatar(user)}\n        {username}\n        {[\n          app.translator.trans('flarum-mentions.forum.composer.reply_to_post_text', { number: model.number() }),\n          ' — ',\n          truncate(model.contentPlain() ?? '', 200),\n        ]}\n      </>\n    );\n  }\n\n  matches(model: Post, typed: string): boolean {\n    const user = model.user();\n    const userMentionable = app.mentionFormats.mentionable('user')!;\n\n    return !typed || (user && userMentionable.matches(user, typed));\n  }\n\n  maxStoreMatchedResults(): number {\n    return 5;\n  }\n\n  /**\n   * Post mention suggestions are only offered from current discussion posts.\n   */\n  search(typed: string): Promise<Post[]> {\n    return Promise.resolve([]);\n  }\n\n  enabled(): boolean {\n    return true;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Group'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","import app from 'flarum/forum/app';\nimport Group from 'flarum/common/models/Group';\nimport MentionableModel from './MentionableModel';\nimport type Mithril from 'mithril';\nimport Badge from 'flarum/common/components/Badge';\nimport highlight from 'flarum/common/helpers/highlight';\nimport type AtMentionFormat from './formats/AtMentionFormat';\n\nexport default class GroupMention extends MentionableModel<Group, AtMentionFormat> {\n  type(): string {\n    return 'group';\n  }\n\n  initialResults(): Group[] {\n    return Array.from(\n      app.store.all<Group>('groups').filter((g: Group) => {\n        return g.id() !== Group.GUEST_ID && g.id() !== Group.MEMBER_ID;\n      })\n    );\n  }\n\n  /**\n   * Generates the mention syntax for a group mention.\n   *\n   * @\"Name Plural\"#gGroupID\n   *\n   * @example <caption>Group mention</caption>\n   * // '@\"Mods\"#g4'\n   * forGroup(group) // Group display name is 'Mods', group ID is 4\n   */\n  public replacement(group: Group): string {\n    return this.format.format(group.namePlural(), 'g', group.id());\n  }\n\n  suggestion(model: Group, typed: string): Mithril.Children {\n    let groupName: Mithril.Children = model.namePlural();\n\n    if (typed) {\n      groupName = highlight(groupName, typed);\n    }\n\n    return (\n      <>\n        <Badge className={`Avatar Badge Badge--group--${model.id()} Badge-icon`} color={model.color()} type=\"group\" icon={model.icon()} />\n        <span className=\"username\">{groupName}</span>\n      </>\n    );\n  }\n\n  matches(model: Group, typed: string): boolean {\n    if (!typed) return false;\n\n    const names = [model.namePlural().toLowerCase(), model.nameSingular().toLowerCase()];\n\n    return names.some((name) => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n\n  maxStoreMatchedResults(): null {\n    return null;\n  }\n\n  /**\n   * All groups are already loaded, so we don't need to search for them.\n   */\n  search(typed: string): Promise<Group[]> {\n    return Promise.resolve([]);\n  }\n\n  enabled(): boolean {\n    return app.session?.user?.canMentionGroups() ?? false;\n  }\n}\n","import MentionFormat from './MentionFormat';\nimport type MentionableModel from '../MentionableModel';\nimport UserMention from '../UserMention';\nimport PostMention from '../PostMention';\nimport GroupMention from '../GroupMention';\n\nexport default class AtMentionFormat extends MentionFormat {\n  public mentionables: (new (...args: any[]) => MentionableModel)[] = [UserMention, PostMention, GroupMention];\n  protected extendable: boolean = true;\n\n  public trigger(): string {\n    return '@';\n  }\n\n  public queryFromTyped(typed: string): string | null {\n    const matchTyped = typed.match(/^[\"“]?((?:(?!\"#).)+)$/);\n\n    return matchTyped ? matchTyped[1] : null;\n  }\n\n  public format(name: string, char: string | null = '', id: string | null = null): string {\n    return {\n      simple: `@${name}`,\n      safe: `@\"${name}\"#${char}${id}`,\n    }[id ? 'safe' : 'simple'];\n  }\n}\n","import app from 'flarum/forum/app';\nimport Badge from 'flarum/common/components/Badge';\nimport highlight from 'flarum/common/helpers/highlight';\nimport type Tag from 'flarum/tags/common/models/Tag';\nimport type Mithril from 'mithril';\nimport MentionableModel from './MentionableModel';\nimport type HashMentionFormat from './formats/HashMentionFormat';\n\nexport default class TagMention extends MentionableModel<Tag, HashMentionFormat> {\n  type(): string {\n    return 'tag';\n  }\n\n  initialResults(): Tag[] {\n    return Array.from(app.store.all<Tag>('tags'));\n  }\n\n  /**\n   * Generates the mention syntax for a tag mention.\n   *\n   * ~tagSlug\n   *\n   * @example <caption>Tag mention</caption>\n   * // ~general\n   * forTag(tag) // Tag display name is 'Tag', tag ID is 5\n   */\n  public replacement(tag: Tag): string {\n    return this.format.format(tag.slug());\n  }\n\n  matches(model: Tag, typed: string): boolean {\n    if (!typed) return false;\n\n    const names = [model.name().toLowerCase()];\n\n    return names.some((name) => name.toLowerCase().substr(0, typed.length) === typed);\n  }\n\n  maxStoreMatchedResults(): null {\n    return null;\n  }\n\n  async search(typed: string): Promise<Tag[]> {\n    return await app.store.find<Tag[]>('tags', { filter: { q: typed }, page: { limit: 5 } });\n  }\n\n  suggestion(model: Tag, typed: string): Mithril.Children {\n    let tagName: Mithril.Children = model.name();\n\n    if (typed) {\n      tagName = highlight(tagName, typed);\n    }\n\n    return (\n      <>\n        <Badge className=\"Avatar\" icon={model.icon()} color={model.color()} type=\"tag\" />\n        <span className=\"username\">{tagName}</span>\n      </>\n    );\n  }\n\n  enabled(): boolean {\n    return 'flarum-tags' in flarum.extensions;\n  }\n}\n","import MentionFormat from './MentionFormat';\nimport MentionableModel from '../MentionableModel';\nimport TagMention from '../TagMention';\n\nexport default class HashMentionFormat extends MentionFormat {\n  public mentionables: (new (...args: any[]) => MentionableModel)[] = [TagMention];\n  protected extendable: boolean = true;\n\n  public trigger(): string {\n    return '#';\n  }\n\n  public queryFromTyped(typed: string): string | null {\n    const matchTyped = typed.match(/^[-_\\p{L}\\p{N}\\p{M}]+$/giu);\n\n    return matchTyped ? matchTyped[0] : null;\n  }\n\n  public format(slug: string): string {\n    return `#${slug}`;\n  }\n}\n","import AtMentionFormat from './AtMentionFormat';\nimport HashMentionFormat from './HashMentionFormat';\nimport type MentionFormat from './MentionFormat';\nimport MentionableModel from '../MentionableModel';\n\nexport default class MentionFormats {\n  protected formats: MentionFormat[] = [new AtMentionFormat(), new HashMentionFormat()];\n\n  public get(symbol: string): MentionFormat | null {\n    return this.formats.find((f) => f.trigger() === symbol) ?? null;\n  }\n\n  public mentionable(type: string): MentionableModel | null {\n    for (const format of this.formats) {\n      const mentionable = format.getMentionable(type);\n\n      if (mentionable) return mentionable;\n    }\n\n    return null;\n  }\n\n  public extend(format: new () => MentionFormat) {\n    this.formats.push(new format());\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/User'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostsUserPage'];","import app from 'flarum/forum/app';\nimport PostsUserPage from 'flarum/forum/components/PostsUserPage';\n\n/**\n * The `MentionsUserPage` component shows post which user Mentioned at\n */\nexport default class MentionsUserPage extends PostsUserPage {\n  /**\n   * Load a new page of the user's activity feed.\n   *\n   * @param {Integer} [offset] The position to start getting results from.\n   * @return {Promise}\n   * @protected\n   */\n  loadResults(offset) {\n    return app.store.find('posts', {\n      filter: {\n        type: 'comment',\n        mentioned: this.user.id(),\n      },\n      page: { offset, limit: this.loadLimit },\n      sort: '-createdAt',\n    });\n  }\n}\n","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport User from 'flarum/common/models/User';\nimport MentionsUserPage from './components/MentionsUserPage';\n\nexport default [\n  new Extend.Routes() //\n    .add('user.mentions', '/u/:username/mentions', MentionsUserPage),\n\n  new Extend.Model(Post) //\n    .hasMany<Post>('mentionedBy')\n    .attribute<number>('mentionedByCount'),\n\n  new Extend.Model(User) //\n    .attribute<boolean>('canMentionGroups'),\n];\n","import app from 'flarum/forum/app';\nimport username from 'flarum/common/helpers/username';\nimport extractText from 'flarum/common/utils/extractText';\n\nexport function filterUserMentions(tag) {\n  let user;\n\n  if (app.forum.attribute('allowUsernameMentionFormat') && tag.hasAttribute('username'))\n    user = app.store.getBy('users', 'username', tag.getAttribute('username'));\n  else if (tag.hasAttribute('id')) user = app.store.getById('users', tag.getAttribute('id'));\n\n  if (user) {\n    tag.setAttribute('id', user.id());\n    tag.setAttribute('slug', user.slug());\n    tag.setAttribute('displayname', extractText(username(user)));\n\n    return true;\n  }\n\n  tag.invalidate();\n}\n\nexport function postFilterUserMentions(tag) {\n  tag.setAttribute('deleted', false);\n}\n\nexport function filterPostMentions(tag) {\n  const post = app.store.getById('posts', tag.getAttribute('id'));\n\n  if (post) {\n    tag.setAttribute('discussionid', post.discussion().id());\n    tag.setAttribute('number', post.number());\n    tag.setAttribute('displayname', extractText(username(post.user())));\n\n    return true;\n  }\n}\n\nexport function postFilterPostMentions(tag) {\n  tag.setAttribute('deleted', false);\n}\n\nexport function filterGroupMentions(tag) {\n  if (app.session?.user?.canMentionGroups()) {\n    const group = app.store.getById('groups', tag.getAttribute('id'));\n\n    if (group) {\n      tag.setAttribute('groupname', extractText(group.namePlural()));\n\n      return true;\n    }\n  }\n\n  tag.invalidate();\n}\n\nexport function postFilterGroupMentions(tag) {\n  if (app.session?.user?.canMentionGroups()) {\n    const group = app.store.getById('groups', tag.getAttribute('id'));\n\n    tag.setAttribute('color', group.color());\n    tag.setAttribute('icon', group.icon());\n    tag.setAttribute('deleted', false);\n  }\n}\n\nexport function filterTagMentions(tag) {\n  if ('flarum-tags' in flarum.extensions) {\n    const model = app.store.getBy('tags', 'slug', tag.getAttribute('slug'));\n\n    if (model) {\n      tag.setAttribute('id', model.id());\n      tag.setAttribute('tagname', model.name());\n\n      return true;\n    }\n  }\n\n  tag.invalidate();\n}\n\nexport function postFilterTagMentions(tag) {\n  if ('flarum-tags' in flarum.extensions) {\n    const model = app.store.getBy('tags', 'slug', tag.getAttribute('slug'));\n\n    tag.setAttribute('icon', model.icon());\n    tag.setAttribute('color', model.color());\n    tag.setAttribute('deleted', false);\n  }\n}\n","import GroupMentionedNotification from './components/GroupMentionedNotification';\nimport MentionsUserPage from './components/MentionsUserPage';\nimport PostMentionedNotification from './components/PostMentionedNotification';\nimport UserMentionedNotification from './components/UserMentionedNotification';\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport PostQuoteButton from './fragments/PostQuoteButton';\nimport getCleanDisplayName from './utils/getCleanDisplayName';\nimport getMentionText from './utils/getMentionText';\nimport * as reply from './utils/reply';\nimport selectedText from './utils/selectedText';\nimport * as textFormatter from './utils/textFormatter';\nimport MentionableModel from './mentionables/MentionableModel';\nimport MentionFormat from './mentionables/formats/MentionFormat';\nimport Mentionables from './extenders/Mentionables';\n\nexport default {\n  'mentions/components/MentionsUserPage': MentionsUserPage,\n  'mentions/components/PostMentionedNotification': PostMentionedNotification,\n  'mentions/components/UserMentionedNotification': UserMentionedNotification,\n  'mentions/components/GroupMentionedNotification': GroupMentionedNotification,\n  'mentions/fragments/AutocompleteDropdown': AutocompleteDropdown,\n  'mentions/fragments/PostQuoteButton': PostQuoteButton,\n  'mentions/utils/getCleanDisplayName': getCleanDisplayName,\n  'mentions/utils/getMentionText': getMentionText,\n  'mentions/utils/reply': reply,\n  'mentions/utils/selectedText': selectedText,\n  'mentions/utils/textFormatter': textFormatter,\n  'mentions/mentionables/MentionableModel': MentionableModel,\n  'mentions/mentionables/formats/MentionFormat': MentionFormat,\n  'mentions/extenders/Mentionables': Mentionables,\n};\n","import app from 'flarum/forum/app';\n\n/**\n * Fetches the mention text for a specified user (and optionally a post ID for replies or group).\n *\n * Automatically determines which mention syntax to be used based on the option in the\n * admin dashboard. Also performs display name clean-up automatically.\n *\n * @deprecated Use `app.mentionables.get('user').replacement(user)` instead. Will be removed in 2.0.\n */\nexport default function getMentionText(user, postId, group) {\n  if (user !== undefined && postId === undefined) {\n    return app.mentionables.get('user').replacement(user);\n  } else if (user !== undefined && postId !== undefined) {\n    return app.mentionables.get('post').replacement(app.store.getById('posts', postId));\n  } else if (group !== undefined) {\n    return app.mentionables.get('group').replacement(group);\n  }\n\n  throw 'No parameters were passed';\n}\n","import type ForumApplication from 'flarum/forum/ForumApplication';\nimport type IExtender from 'flarum/common/extenders/IExtender';\nimport type MentionableModel from '../mentionables/MentionableModel';\nimport type MentionFormat from '../mentionables/formats/MentionFormat';\n\nexport default class Mentionables implements IExtender<ForumApplication> {\n  protected formats: (new () => MentionFormat)[] = [];\n  protected mentionables: Record<string, (new (...args: any[]) => MentionableModel)[]> = {};\n\n  /**\n   * Register a new mention format.\n   * Must extend MentionFormat and have a unique unused trigger symbol.\n   */\n  format(format: new () => MentionFormat): this {\n    this.formats.push(format);\n\n    return this;\n  }\n\n  /**\n   * Register a new mentionable model to a mention format.\n   * Only works if the format has already been registered,\n   *  and the format allows using multiple mentionables.\n   *\n   * @param symbol The trigger symbol of the format to extend (ex: @).\n   * @param mentionable The mentionable instance to register.\n   *                    Must extend MentionableModel.\n   */\n  mentionable(symbol: string, mentionable: new (...args: any[]) => MentionableModel): this {\n    if (!this.mentionables[symbol]) {\n      this.mentionables[symbol] = [];\n    }\n\n    this.mentionables[symbol].push(mentionable);\n\n    return this;\n  }\n\n  extend(app: ForumApplication): void {\n    for (const format of this.formats) {\n      app.mentionFormats.extend(format);\n    }\n\n    for (const symbol in this.mentionables) {\n      const format = app.mentionFormats.get(symbol);\n\n      if (!format) continue;\n\n      for (const mentionable of this.mentionables[symbol]) {\n        format.extend(mentionable);\n      }\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core;","import { extend } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport NotificationGrid from 'flarum/forum/components/NotificationGrid';\nimport { getPlainContent } from 'flarum/common/utils/string';\nimport textContrastClass from 'flarum/common/helpers/textContrastClass';\nimport Post from 'flarum/forum/components/Post';\n\nimport addPostMentionPreviews from './addPostMentionPreviews';\nimport addMentionedByList from './addMentionedByList';\nimport addPostReplyAction from './addPostReplyAction';\nimport addPostQuoteButton from './addPostQuoteButton';\nimport addComposerAutocomplete from './addComposerAutocomplete';\nimport PostMentionedNotification from './components/PostMentionedNotification';\nimport UserMentionedNotification from './components/UserMentionedNotification';\nimport GroupMentionedNotification from './components/GroupMentionedNotification';\nimport MentionFormats from './mentionables/formats/MentionFormats';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport User from 'flarum/common/models/User';\nimport Model from 'flarum/common/Model';\n\napp.mentionFormats = new MentionFormats();\n\nexport { default as extend } from './extend';\n\napp.initializers.add('flarum-mentions', function () {\n  // For every mention of a post inside a post's content, set up a hover handler\n  // that shows a preview of the mentioned post.\n  addPostMentionPreviews();\n\n  // In the footer of each post, show information about who has replied (i.e.\n  // who the post has been mentioned by).\n  addMentionedByList();\n\n  // Add a 'reply' control to the footer of each post. When clicked, it will\n  // open up the composer and add a post mention to its contents.\n  addPostReplyAction();\n\n  // Show a Quote button when Post text is selected\n  addPostQuoteButton();\n\n  // After typing '@' in the composer, show a dropdown suggesting a bunch of\n  // posts or users that the user could mention.\n  addComposerAutocomplete();\n\n  app.notificationComponents.postMentioned = PostMentionedNotification;\n  app.notificationComponents.userMentioned = UserMentionedNotification;\n  app.notificationComponents.groupMentioned = GroupMentionedNotification;\n\n  // Add notification preferences.\n  extend(NotificationGrid.prototype, 'notificationTypes', function (items) {\n    items.add('postMentioned', {\n      name: 'postMentioned',\n      icon: 'fas fa-reply',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_post_mentioned_label'),\n    });\n\n    items.add('userMentioned', {\n      name: 'userMentioned',\n      icon: 'fas fa-at',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_user_mentioned_label'),\n    });\n\n    items.add('groupMentioned', {\n      name: 'groupMentioned',\n      icon: 'fas fa-at',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_group_mentioned_label'),\n    });\n  });\n\n  // Add mentions tab in user profile\n  extend(UserPage.prototype, 'navItems', function (items) {\n    const user = this.user;\n    items.add(\n      'mentions',\n      <LinkButton href={app.route('user.mentions', { username: user.slug() })} name=\"mentions\" icon=\"fas fa-at\">\n        {app.translator.trans('flarum-mentions.forum.user.mentions_link')}\n      </LinkButton>,\n      80\n    );\n  });\n\n  // Remove post mentions when rendering post previews.\n  getPlainContent.removeSelectors.push('a.PostMention');\n\n  // Apply color contrast fix on group mentions.\n  extend(Post.prototype, 'oncreate', function () {\n    this.$('.GroupMention--colored, .TagMention--colored').each(function () {\n      this.classList.add(textContrastClass(getComputedStyle(this).getPropertyValue('--color')));\n    });\n  });\n});\n\nexport * from './utils/textFormatter';\n\n// Expose compat API\nimport mentionsCompat from './compat';\nimport { compat } from '@flarum/core/forum';\n\nObject.assign(compat, mentionsCompat);\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport KeyboardNavigatable from 'flarum/common/utils/KeyboardNavigatable';\n\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport MentionableModels from './mentionables/MentionableModels';\n\nexport default function addComposerAutocomplete() {\n  const $container = $('<div class=\"ComposerBody-mentionsDropdownContainer\"></div>');\n  const dropdown = new AutocompleteDropdown();\n\n  extend(TextEditor.prototype, 'oncreate', function () {\n    const $editor = this.$('.TextEditor-editor').wrap('<div class=\"ComposerBody-mentionsWrapper\"></div>');\n\n    this.navigator = new KeyboardNavigatable();\n    this.navigator\n      .when(() => dropdown.active)\n      .onUp(() => dropdown.navigate(-1))\n      .onDown(() => dropdown.navigate(1))\n      .onSelect(dropdown.complete.bind(dropdown))\n      .onCancel(dropdown.hide.bind(dropdown))\n      .bindTo($editor);\n\n    $editor.after($container);\n  });\n\n  extend(TextEditor.prototype, 'buildEditorParams', function (params) {\n    let relMentionStart;\n    let absMentionStart;\n    let matchTyped;\n\n    let mentionables = new MentionableModels({\n      onmouseenter: function () {\n        dropdown.setIndex($(this).parent().index());\n      },\n      onclick: (replacement) => {\n        this.attrs.composer.editor.replaceBeforeCursor(absMentionStart - 1, replacement + ' ');\n\n        dropdown.hide();\n      },\n    });\n\n    const suggestionsInputListener = () => {\n      const selection = this.attrs.composer.editor.getSelectionRange();\n\n      const cursor = selection[0];\n\n      if (selection[1] - cursor > 0) return;\n\n      // Search backwards from the cursor for a mention triggering symbol. If we find one,\n      // we will want to show the correct autocomplete dropdown!\n      // Check classes implementing the IMentionableModel interface to see triggering symbols.\n      const lastChunk = this.attrs.composer.editor.getLastNChars(30);\n      absMentionStart = 0;\n      let activeFormat = null;\n      for (let i = lastChunk.length - 1; i >= 0; i--) {\n        const character = lastChunk.substr(i, 1);\n        activeFormat = app.mentionFormats.get(character);\n\n        if (activeFormat && (i === 0 || /\\s/.test(lastChunk.substr(i - 1, 1)))) {\n          relMentionStart = i + 1;\n          absMentionStart = cursor - lastChunk.length + i + 1;\n          mentionables.init(activeFormat.makeMentionables());\n          break;\n        }\n      }\n\n      dropdown.hide();\n      dropdown.active = false;\n\n      if (absMentionStart) {\n        const typed = lastChunk.substring(relMentionStart).toLowerCase();\n        matchTyped = activeFormat.queryFromTyped(typed);\n\n        if (!matchTyped) return;\n\n        mentionables.typed = matchTyped;\n\n        const buildSuggestions = () => {\n          // If the user has started to type a mention,\n          // then suggest models matching.\n          const suggestions = mentionables.buildSuggestions();\n\n          if (suggestions.length) {\n            dropdown.items = suggestions;\n            m.render($container[0], dropdown.render());\n\n            dropdown.show();\n            const coordinates = this.attrs.composer.editor.getCaretCoordinates(absMentionStart);\n            const width = dropdown.$().outerWidth();\n            const height = dropdown.$().outerHeight();\n            const parent = dropdown.$().offsetParent();\n            let left = coordinates.left;\n            let top = coordinates.top + 15;\n\n            // Keep the dropdown inside the editor.\n            if (top + height > parent.height()) {\n              top = coordinates.top - height - 15;\n            }\n            if (left + width > parent.width()) {\n              left = parent.width() - width;\n            }\n\n            // Prevent the dropdown from going off screen on mobile\n            top = Math.max(-(parent.offset().top - $(document).scrollTop()), top);\n            left = Math.max(-parent.offset().left, left);\n\n            dropdown.show(left, top);\n          } else {\n            dropdown.active = false;\n            dropdown.hide();\n          }\n        };\n\n        dropdown.active = true;\n\n        buildSuggestions();\n\n        dropdown.setIndex(0);\n        dropdown.$().scrollTop(0);\n\n        mentionables.search()?.then(buildSuggestions);\n      }\n    };\n\n    params.inputListeners.push(suggestionsInputListener);\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    items.add(\n      'mention',\n      <TextEditorButton onclick={() => this.attrs.composer.editor.insertAtCursor(' @')} icon=\"fas fa-at\">\n        {app.translator.trans('flarum-mentions.forum.composer.mention_tooltip')}\n      </TextEditorButton>\n    );\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default function addPostMentionPreviews() {\n  function addPreviews() {\n    const contentHtml = this.attrs.post.contentHtml();\n\n    if (contentHtml === this.oldPostContentHtml || this.isEditing()) return;\n\n    this.oldPostContentHtml = contentHtml;\n\n    const parentPost = this.attrs.post;\n    const $parentPost = this.$();\n\n    this.$().on(\n      'click',\n      '.UserMention:not(.UserMention--deleted), .PostMention:not(.PostMention--deleted), .TagMention:not(.TagMention--deleted)',\n      function (e) {\n        m.route.set(this.getAttribute('href'));\n        e.preventDefault();\n      }\n    );\n\n    this.$('.PostMention:not(.PostMention--deleted)').each(function () {\n      const $this = $(this);\n      const id = $this.data('id');\n      let timeout;\n\n      // Wrap the mention link in a wrapper element so that we can insert a\n      // preview popup as its sibling and relatively position it.\n      const $preview = $('<ul class=\"Dropdown-menu PostMention-preview fade\"/>');\n      $parentPost.append($preview);\n\n      const getPostElement = () => {\n        return $(`.PostStream-item[data-id=\"${id}\"]`);\n      };\n\n      const showPreview = () => {\n        // When the user hovers their mouse over the mention, look for the\n        // post that it's referring to in the stream, and determine if it's\n        // in the viewport. If it is, we will \"pulsate\" it.\n        const $post = getPostElement();\n        let visible = false;\n        if ($post.length) {\n          const top = $post.offset().top;\n          const scrollTop = window.pageYOffset;\n          if (top > scrollTop && top + $post.height() < scrollTop + $(window).height()) {\n            $post.addClass('pulsate');\n            visible = true;\n          }\n        }\n\n        // Otherwise, we will show a popup preview of the post. If the post\n        // hasn't yet been loaded, we will need to do that.\n        if (!visible) {\n          // Position the preview so that it appears above the mention.\n          // (The offsetParent should be .Post-body.)\n          const positionPreview = () => {\n            const previewHeight = $preview.outerHeight(true);\n            let offset = 0;\n\n            // If the preview goes off the top of the viewport, reposition it to\n            // be below the mention.\n            if ($this.offset().top - previewHeight < $(window).scrollTop() + $('#header').outerHeight()) {\n              offset += $this.outerHeight(true);\n            } else {\n              offset -= previewHeight;\n            }\n\n            $preview\n              .show()\n              .css('top', $this.offset().top - $parentPost.offset().top + offset)\n              .css('left', $this.offsetParent().offset().left - $parentPost.offset().left)\n              .css('max-width', $this.offsetParent().width());\n          };\n\n          const showPost = (post) => {\n            const discussion = post.discussion();\n\n            m.render($preview[0], [\n              discussion !== parentPost.discussion() && (\n                <li>\n                  <span className=\"PostMention-preview-discussion\">{discussion.title()}</span>\n                </li>\n              ),\n              <li>\n                <PostPreview post={post} />\n              </li>,\n            ]);\n            positionPreview();\n          };\n\n          const post = app.store.getById('posts', id);\n          if (post && post.discussion()) {\n            showPost(post);\n          } else {\n            m.render($preview[0], <LoadingIndicator />);\n            app.store.find('posts', id).then(showPost);\n            positionPreview();\n          }\n\n          setTimeout(() => $preview.off('transitionend').addClass('in'));\n        }\n      };\n\n      const hidePreview = () => {\n        getPostElement().removeClass('pulsate');\n        if ($preview.hasClass('in')) {\n          $preview.removeClass('in').one('transitionend', () => $preview.hide());\n        }\n      };\n\n      // On a touch (mobile) device we cannot hover the link to reveal the preview.\n      // Instead we cancel the navigation so that a click reveals the preview.\n      // Users can then click on the preview to go to the post if desired.\n      $this.on('touchend', (e) => {\n        if (e.cancelable) {\n          e.preventDefault();\n        }\n      });\n\n      $this\n        .add($preview)\n        .hover(\n          () => {\n            clearTimeout(timeout);\n            timeout = setTimeout(showPreview, 250);\n          },\n          () => {\n            clearTimeout(timeout);\n            getPostElement().removeClass('pulsate');\n            timeout = setTimeout(hidePreview, 250);\n          }\n        )\n        .on('touchend', (e) => {\n          showPreview();\n          e.stopPropagation();\n        });\n\n      $(document).on('touchend', hidePreview);\n    });\n  }\n\n  extend(CommentPost.prototype, 'oncreate', addPreviews);\n  extend(CommentPost.prototype, 'onupdate', addPreviews);\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport Link from 'flarum/common/components/Link';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport punctuateSeries from 'flarum/common/helpers/punctuateSeries';\nimport username from 'flarum/common/helpers/username';\nimport icon from 'flarum/common/helpers/icon';\nimport Button from 'flarum/common/components/Button';\nimport MentionedByModal from './components/MentionedByModal';\n\nexport default function addMentionedByList() {\n  function hidePreview() {\n    this.$('.Post-mentionedBy-preview')\n      .removeClass('in')\n      .one('transitionend', function () {\n        $(this).hide();\n      });\n  }\n\n  extend(CommentPost.prototype, 'oncreate', function () {\n    let timeout;\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n\n    if (replies && replies.length) {\n      const $preview = $('<ul class=\"Dropdown-menu Post-mentionedBy-preview fade\"/>');\n      this.$().append($preview);\n\n      const $parentPost = this.$();\n      const $this = this.$('.Post-mentionedBy');\n\n      const showPreview = () => {\n        if (!$preview.hasClass('in') && $preview.is(':visible')) return;\n\n        // When the user hovers their mouse over the list of people who have\n        // replied to the post, render a list of reply previews into a\n        // popup.\n        m.render(\n          $preview[0],\n          <>\n            {replies.map((reply) => (\n              <li data-number={reply.number()}>\n                <PostPreview post={reply} onclick={hidePreview.bind(this)} />\n              </li>\n            ))}\n            {replies.length < post.mentionedByCount() && (\n              <li className=\"Post-mentionedBy-preview-more\">\n                <Button\n                  className=\"PostPreview Button\"\n                  onclick={() => {\n                    hidePreview.call(this);\n                    app.modal.show(MentionedByModal, { post });\n                  }}\n                >\n                  <span className=\"PostPreview-content\">\n                    <span className=\"PostPreview-badge Avatar\">{icon('fas fa-reply-all')}</span>\n                    <span>\n                      {app.translator.trans('flarum-mentions.forum.post.mentioned_by_more_text', { count: post.mentionedByCount() - replies.length })}\n                    </span>\n                  </span>\n                </Button>\n              </li>\n            )}\n          </>\n        );\n\n        $preview\n          .show()\n          .css('top', $this.offset().top - $parentPost.offset().top + $this.outerHeight(true))\n          .css('left', $this.offsetParent().offset().left - $parentPost.offset().left)\n          .css('max-width', $parentPost.width());\n\n        setTimeout(() => $preview.off('transitionend').addClass('in'));\n      };\n\n      $this.add($preview).hover(\n        () => {\n          clearTimeout(timeout);\n          timeout = setTimeout(showPreview, 250);\n        },\n        () => {\n          clearTimeout(timeout);\n          timeout = setTimeout(hidePreview, 250);\n        }\n      );\n\n      // Whenever the user hovers their mouse over a particular name in the\n      // list of repliers, highlight the corresponding post in the preview\n      // popup.\n      this.$()\n        .find('.Post-mentionedBy-summary a')\n        .hover(\n          function () {\n            $preview.find('[data-number=\"' + $(this).data('number') + '\"]').addClass('active');\n          },\n          function () {\n            $preview.find('[data-number]').removeClass('active');\n          }\n        );\n    }\n  });\n\n  extend(CommentPost.prototype, 'footerItems', function (items) {\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n\n    if (replies && replies.length) {\n      const users = [];\n      const repliers = replies\n        .sort((reply) => (reply.user() === app.session.user ? -1 : 0))\n        .filter((reply) => {\n          const user = reply.user();\n          if (users.indexOf(user) === -1) {\n            users.push(user);\n            return true;\n          }\n        });\n\n      const limit = 4;\n      const overLimit = post.mentionedByCount() > limit;\n\n      // Create a list of unique users who have replied. So even if a user has\n      // replied twice, they will only be in this array once.\n      const names = repliers.slice(0, overLimit ? limit - 1 : limit).map((reply) => {\n        const user = reply.user();\n\n        return (\n          <Link href={app.route.post(reply)} onclick={hidePreview.bind(this)} data-number={reply.number()}>\n            {app.session.user === user ? app.translator.trans('flarum-mentions.forum.post.you_text') : username(user)}\n          </Link>\n        );\n      });\n\n      // If there are more users that we've run out of room to display, add a \"x\n      // others\" name to the end of the list. Clicking on it will display a modal\n      // with a full list of names.\n      if (overLimit) {\n        const count = post.mentionedByCount() - names.length;\n\n        names.push(app.translator.trans('flarum-mentions.forum.post.others_text', { count }));\n      }\n\n      items.add(\n        'replies',\n        <div className=\"Post-mentionedBy\">\n          <span className=\"Post-mentionedBy-summary\">\n            {icon('fas fa-reply')}\n            {app.translator.trans(`flarum-mentions.forum.post.mentioned_by${repliers[0].user() === app.session.user ? '_self' : ''}_text`, {\n              count: names.length,\n              users: punctuateSeries(names),\n            })}\n          </span>\n        </div>\n      );\n    }\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport Button from 'flarum/common/components/Button';\nimport CommentPost from 'flarum/forum/components/CommentPost';\n\nimport reply from './utils/reply';\n\nexport default function () {\n  extend(CommentPost.prototype, 'actionItems', function (items) {\n    const post = this.attrs.post;\n\n    if (post.isHidden() || (app.session.user && !post.discussion().canReply())) return;\n\n    items.add(\n      'reply',\n      <Button className=\"Button Button--link\" onclick={() => reply(post)}>\n        {app.translator.trans('flarum-mentions.forum.post.reply_link')}\n      </Button>\n    );\n  });\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\n\nimport PostQuoteButton from './fragments/PostQuoteButton';\nimport selectedText from './utils/selectedText';\n\nexport default function addPostQuoteButton() {\n  extend(CommentPost.prototype, 'oncreate', function () {\n    const post = this.attrs.post;\n\n    if (post.isHidden() || (app.session.user && !post.discussion().canReply())) return;\n\n    const $postBody = this.$('.Post-body');\n\n    // Wrap the quote button in a wrapper element so that we can render\n    // button into it.\n    const $container = $('<div class=\"Post-quoteButtonContainer\"></div>');\n\n    const button = new PostQuoteButton(post);\n\n    const handler = function (e) {\n      setTimeout(() => {\n        const content = selectedText($postBody);\n        if (content) {\n          button.content = content;\n          m.render($container[0], button.render());\n\n          const rects = window.getSelection().getRangeAt(0).getClientRects();\n          const firstRect = rects[0];\n\n          if (e.clientY < firstRect.bottom && e.clientX - firstRect.right < firstRect.left - e.clientX) {\n            button.showStart(firstRect.left, firstRect.top);\n          } else {\n            const lastRect = rects[rects.length - 1];\n            button.showEnd(lastRect.right, lastRect.bottom);\n          }\n        }\n      }, 1);\n    };\n\n    this.$().after($container).on('mouseup', handler);\n\n    if ('ontouchstart' in window) {\n      document.addEventListener('selectionchange', handler, false);\n    }\n  });\n}\n"],"names":["_typeof","require","_regeneratorRuntime","module","exports","__esModule","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","undefined","done","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","o","get","prop","r","flarum","core","compat","_setPrototypeOf","p","bind","_inheritsLoose","subClass","superClass","_extends","assign","target","arguments","source","apply","_defineProperties","props","descriptor","MentionedByModalState","params","page","limit","Constructor","protoProps","PaginatedListState","MentionedByModal","oninit","vnode","filter","mentionedPost","attrs","post","id","sort","refresh","className","title","app","content","isInitialLoading","getPages","map","items","reply","number","onclick","hasNext","loadNext","loading","isLoadingNext","Modal","insertMention","composer","quote","mention","replacement","fields","body","originalContent","cursorPosition","editor","getSelectionRange","preceding","precedingNewlines","match","insertAtCursor","Array","join","trim","replace","EditPostComposer","discussion","DiscussionControls","PostQuoteButton","view","icon","show","left","top","$this","$","parentOffset","offsetParent","offset","css","hideHandler","hide","document","on","showStart","window","scrollTop","outerHeight","showEnd","right","bottom","outerWidth","off","Fragment","selectedText","selection","getSelection","isCollapsed","range","getRangeAt","parent","commonAncestorContainer","contains","clone","append","cloneContents","find","replaceWith","alt","src","innerText","href","text","AutocompleteDropdown","active","index","keyWasJustPressed","item","navigate","delta","setIndex","clearTimeout","keyWasJustPressedTimeout","setTimeout","eq","click","scrollToItem","$dropdown","$items","rangedIndex","$item","removeClass","addClass","dropdownScroll","dropdownTop","dropdownBottom","itemTop","itemBottom","parseInt","animate","_objectWithoutPropertiesLoose","excluded","sourceKeys","indexOf","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","MentionsDropdownItem","mentionable","classList","children","Component","MentionableModels","dropdownItemAttrs","mentionables","results","typed","searched","search","throttle","typedLower","toLowerCase","includes","model","has","set","init","Map","initialResults","matches","makeSuggestion","suggestion","buildSuggestions","suggestions","enabled","from","max","maxStoreMatchedResults","splice","dropdownItem","PostMentionedNotification","notification","subject","replyNumber","user","fromUser","count","excerpt","truncate","contentPlain","Notification","UserMentionedNotification","GroupMentionedNotification","MentionFormat","instances","extendable","makeMentionables","Mentionable","getMentionable","extend","MentionableModel","format","getDeletedUserText","extractText","getCleanDisplayName","useDisplayName","username","UserMention","cleanText","usernameHelper","highlight","avatar","some","substr","q","PostMention","ReplyComposer","composerAttrs","composerPost","posts","contentType","b","createdAt","getTime","userMentionable","GroupMention","g","Group","group","namePlural","groupName","color","nameSingular","canMentionGroups","AtMentionFormat","trigger","queryFromTyped","matchTyped","char","simple","safe","TagMention","tag","slug","tagName","extensions","HashMentionFormat","MentionFormats","formats","symbol","f","MentionsUserPage","loadResults","mentioned","loadLimit","PostsUserPage","Extend","add","Post","hasMany","attribute","User","filterUserMentions","hasAttribute","getAttribute","setAttribute","invalidate","postFilterUserMentions","filterPostMentions","postFilterPostMentions","filterGroupMentions","postFilterGroupMentions","filterTagMentions","postFilterTagMentions","postId","textFormatter","mentionFormats","$container","dropdown","addPreviews","contentHtml","oldPostContentHtml","isEditing","parentPost","$parentPost","e","m","route","preventDefault","each","timeout","data","$preview","getPostElement","showPreview","$post","visible","pageYOffset","height","positionPreview","previewHeight","width","showPost","render","store","getById","hidePreview","hasClass","one","cancelable","hover","stopPropagation","CommentPost","addPostMentionPreviews","replies","mentionedBy","is","mentionedByCount","users","repliers","overLimit","names","punctuateSeries","addMentionedByList","isHidden","canReply","$postBody","button","handler","rects","getClientRects","firstRect","clientY","clientX","lastRect","after","addEventListener","TextEditor","$editor","navigator","KeyboardNavigatable","when","onUp","onDown","onSelect","onCancel","bindTo","relMentionStart","absMentionStart","onmouseenter","replaceBeforeCursor","inputListeners","cursor","lastChunk","getLastNChars","activeFormat","character","test","substring","coordinates","getCaretCoordinates","Math","NotificationGrid","label","UserPage","getPlainContent","textContrastClass","getComputedStyle","getPropertyValue","mentionsCompat"],"sourceRoot":""}