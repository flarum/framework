(()=>{var t={757:function(t){t.exports=function(){"use strict";var t=6e4,e=36e5,s="millisecond",n="second",r="minute",a="hour",i="day",o="week",u="month",l="quarter",d="year",c="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],s=t%100;return"["+t+(e[(s-20)%10]||e[s]||e[0])+"]"}},$=function(t,e,s){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(s)+t},v={s:$,z:function(t){var e=-t.utcOffset(),s=Math.abs(e),n=Math.floor(s/60),r=s%60;return(e<=0?"+":"-")+$(n,2,"0")+":"+$(r,2,"0")},m:function t(e,s){if(e.date()<s.date())return-t(s,e);var n=12*(s.year()-e.year())+(s.month()-e.month()),r=e.clone().add(n,u),a=s-r<0,i=e.clone().add(n+(a?-1:1),u);return+(-(n+(s-r)/(a?r-i:i-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:d,w:o,d:i,D:c,h:a,m:r,s:n,ms:s,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},g="en",y={};y[g]=p;var M=function(t){return t instanceof D},S=function t(e,s,n){var r;if(!e)return g;if("string"==typeof e){var a=e.toLowerCase();y[a]&&(r=a),s&&(y[a]=s,r=a);var i=e.split("-");if(!r&&i.length>1)return t(i[0])}else{var o=e.name;y[o]=e,r=o}return!n&&r&&(g=r),r||!n&&g},_=function(t,e){if(M(t))return t.clone();var s="object"==typeof e?e:{};return s.date=t,s.args=arguments,new D(s)},b=v;b.l=S,b.i=M,b.w=function(t,e){return _(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var D=function(){function p(t){this.$L=S(t.locale,null,!0),this.parse(t)}var $=p.prototype;return $.parse=function(t){this.$d=function(t){var e=t.date,s=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(m);if(n){var r=n[2]-1||0,a=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},$.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},$.$utils=function(){return b},$.isValid=function(){return!(this.$d.toString()===f)},$.isSame=function(t,e){var s=_(t);return this.startOf(e)<=s&&s<=this.endOf(e)},$.isAfter=function(t,e){return _(t)<this.startOf(e)},$.isBefore=function(t,e){return this.endOf(e)<_(t)},$.$g=function(t,e,s){return b.u(t)?this[e]:this.set(s,t)},$.unix=function(){return Math.floor(this.valueOf()/1e3)},$.valueOf=function(){return this.$d.getTime()},$.startOf=function(t,e){var s=this,l=!!b.u(e)||e,f=b.p(t),m=function(t,e){var n=b.w(s.$u?Date.UTC(s.$y,e,t):new Date(s.$y,e,t),s);return l?n:n.endOf(i)},h=function(t,e){return b.w(s.toDate()[t].apply(s.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(e)),s)},p=this.$W,$=this.$M,v=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case d:return l?m(1,0):m(31,11);case u:return l?m(1,$):m(0,$+1);case o:var y=this.$locale().weekStart||0,M=(p<y?p+7:p)-y;return m(l?v-M:v+(6-M),$);case i:case c:return h(g+"Hours",0);case a:return h(g+"Minutes",1);case r:return h(g+"Seconds",2);case n:return h(g+"Milliseconds",3);default:return this.clone()}},$.endOf=function(t){return this.startOf(t,!1)},$.$set=function(t,e){var o,l=b.p(t),f="set"+(this.$u?"UTC":""),m=(o={},o[i]=f+"Date",o[c]=f+"Date",o[u]=f+"Month",o[d]=f+"FullYear",o[a]=f+"Hours",o[r]=f+"Minutes",o[n]=f+"Seconds",o[s]=f+"Milliseconds",o)[l],h=l===i?this.$D+(e-this.$W):e;if(l===u||l===d){var p=this.clone().set(c,1);p.$d[m](h),p.init(),this.$d=p.set(c,Math.min(this.$D,p.daysInMonth())).$d}else m&&this.$d[m](h);return this.init(),this},$.set=function(t,e){return this.clone().$set(t,e)},$.get=function(t){return this[b.p(t)]()},$.add=function(s,l){var c,f=this;s=Number(s);var m=b.p(l),h=function(t){var e=_(f);return b.w(e.date(e.date()+Math.round(t*s)),f)};if(m===u)return this.set(u,this.$M+s);if(m===d)return this.set(d,this.$y+s);if(m===i)return h(1);if(m===o)return h(7);var p=(c={},c[r]=t,c[a]=e,c[n]=1e3,c)[m]||1,$=this.$d.getTime()+s*p;return b.w($,this)},$.subtract=function(t,e){return this.add(-1*t,e)},$.format=function(t){var e=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var n=t||"YYYY-MM-DDTHH:mm:ssZ",r=b.z(this),a=this.$H,i=this.$m,o=this.$M,u=s.weekdays,l=s.months,d=function(t,s,r,a){return t&&(t[s]||t(e,n))||r[s].slice(0,a)},c=function(t){return b.s(a%12||12,t,"0")},m=s.meridiem||function(t,e,s){var n=t<12?"AM":"PM";return s?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:b.s(o+1,2,"0"),MMM:d(s.monthsShort,o,l,3),MMMM:d(l,o),D:this.$D,DD:b.s(this.$D,2,"0"),d:String(this.$W),dd:d(s.weekdaysMin,this.$W,u,2),ddd:d(s.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(a),HH:b.s(a,2,"0"),h:c(1),hh:c(2),a:m(a,i,!0),A:m(a,i,!1),m:String(i),mm:b.s(i,2,"0"),s:String(this.$s),ss:b.s(this.$s,2,"0"),SSS:b.s(this.$ms,3,"0"),Z:r};return n.replace(h,(function(t,e){return e||p[t]||r.replace(":","")}))},$.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},$.diff=function(s,c,f){var m,h=b.p(c),p=_(s),$=(p.utcOffset()-this.utcOffset())*t,v=this-p,g=b.m(this,p);return g=(m={},m[d]=g/12,m[u]=g,m[l]=g/3,m[o]=(v-$)/6048e5,m[i]=(v-$)/864e5,m[a]=v/e,m[r]=v/t,m[n]=v/1e3,m)[h]||v,f?g:b.a(g)},$.daysInMonth=function(){return this.endOf(u).$D},$.$locale=function(){return y[this.$L]},$.locale=function(t,e){if(!t)return this.$L;var s=this.clone(),n=S(t,e,!0);return n&&(s.$L=n),s},$.clone=function(){return b.w(this.$d,this)},$.toDate=function(){return new Date(this.valueOf())},$.toJSON=function(){return this.isValid()?this.toISOString():null},$.toISOString=function(){return this.$d.toISOString()},$.toString=function(){return this.$d.toUTCString()},p}(),w=D.prototype;return _.prototype=w,[["$ms",s],["$s",n],["$m",r],["$H",a],["$W",i],["$M",u],["$y",d],["$D",c]].forEach((function(t){w[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),_.extend=function(t,e){return t.$i||(t(e,D,_),t.$i=!0),_},_.locale=S,_.isDayjs=M,_.unix=function(t){return _(1e3*t)},_.en=y[g],_.Ls=y,_.p={},_}()},221:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(n,r,a){var i=r.prototype;a.utc=function(t){return new r({date:t,utc:!0,args:arguments})},i.utc=function(e){var s=a(this.toDate(),{locale:this.$L,utc:!0});return e?s.add(this.utcOffset(),t):s},i.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var o=i.parse;i.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),o.call(this,t)};var u=i.init;i.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else u.call(this)};var l=i.utcOffset;i.utcOffset=function(n,r){var a=this.$utils().u;if(a(n))return this.$u?0:a(this.$offset)?l.call(this):this.$offset;if("string"==typeof n&&(n=function(t){void 0===t&&(t="");var n=t.match(e);if(!n)return null;var r=(""+n[0]).match(s)||["-",0,0],a=r[0],i=60*+r[1]+ +r[2];return 0===i?0:"+"===a?i:-i}(n),null===n))return this;var i=Math.abs(n)<=16?60*n:n,o=this;if(r)return o.$offset=i,o.$u=0===n,o;if(0!==n){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(i+u,t)).$offset=i,o.$x.$localOffset=u}else o=this.utc();return o};var d=i.format;i.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,e)},i.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var c=i.toDate;i.toDate=function(t){return"s"===t&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var f=i.diff;i.diff=function(t,e,s){if(t&&this.$u===t.$u)return f.call(this,t,e,s);var n=this.local(),r=a(t).local();return f.call(n,r,e,s)}}}()}},e={};function s(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,s),a.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";s.r(n),s.d(n,{extend:()=>q});const t=flarum.core.compat.extend,e=flarum.core.compat.app;var r=s.n(e);const a=flarum.core.compat["utils/UserControls"];var i=s.n(a);const o=flarum.core.compat["components/Button"];var u=s.n(o);const l=flarum.core.compat["components/Badge"];var d=s.n(l);const c=flarum.core.compat["models/User"];var f=s.n(c);const h=flarum.core.compat["forum/app"];var p=s.n(h);const $=flarum.core.compat["components/Modal"];var v=s.n($);const g=flarum.core.compat["utils/Stream"];var y=s.n(g);const M=flarum.core.compat["utils/withAttr"];var S=s.n(M);const _=flarum.core.compat["common/utils/ItemList"];var b=s.n(_),D=s(757),w=s.n(D),O=s(221),x=s.n(O);function T(t){return w().utc(t).isSame(w().utc("2038-01-01"))}w().extend(x());class U extends(v()){oninit(t){super.oninit(t);let e=this.attrs.user.suspendedUntil();const s=this.attrs.user.suspendReason(),n=this.attrs.user.suspendMessage();let r=null;new Date>e&&(e=null),e&&(r=9999===e.getFullYear()?"indefinitely":"limited"),this.status=y()(r),this.reason=y()(s),this.message=y()(n),this.daysRemaining=y()("limited"===r&&1-dayjs().diff(e,"days"))}className(){return"SuspendUserModal Modal--medium"}title(){return p().translator.trans("flarum-suspend.forum.suspend_user.title",{user:this.attrs.user})}content(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",null,p().translator.trans("flarum-suspend.forum.suspend_user.status_heading")),m("div",null,this.formItems().toArray())),m("div",{className:"Form-group"},m(u(),{className:"Button Button--primary",loading:this.loading,type:"submit"},p().translator.trans("flarum-suspend.forum.suspend_user.submit_button")))))}radioItems(){const t=new(b());return t.add("not-suspended",m("label",{className:"checkbox"},m("input",{type:"radio",name:"status",checked:!this.status(),value:"",onclick:S()("value",this.status)}),p().translator.trans("flarum-suspend.forum.suspend_user.not_suspended_label")),100),t.add("indefinitely",m("label",{className:"checkbox"},m("input",{type:"radio",name:"status",checked:"indefinitely"===this.status(),value:"indefinitely",onclick:S()("value",this.status)}),p().translator.trans("flarum-suspend.forum.suspend_user.indefinitely_label")),90),t.add("time-suspension",m("label",{className:"checkbox SuspendUserModal-days"},m("input",{type:"radio",name:"status",checked:"limited"===this.status(),value:"limited",onclick:t=>{this.status(t.target.value),m.redraw.sync(),this.$(".SuspendUserModal-days-input input").select(),t.redraw=!1}}),p().translator.trans("flarum-suspend.forum.suspend_user.limited_time_label"),"limited"===this.status()&&m("div",{className:"SuspendUserModal-days-input"},m("input",{type:"number",min:"0",value:this.daysRemaining(),oninput:S()("value",this.daysRemaining),className:"FormControl"}),p().translator.trans("flarum-suspend.forum.suspend_user.limited_time_days_text"))),80),t}formItems(){const t=new(b());return t.add("radioItems",m("div",{className:"Form-group"},this.radioItems().toArray()),100),t.add("reason",m("div",{className:"Form-group"},m("label",null,p().translator.trans("flarum-suspend.forum.suspend_user.reason"),m("textarea",{className:"FormControl",bidi:this.reason,placeholder:p().translator.trans("flarum-suspend.forum.suspend_user.placeholder_optional"),rows:"2"}))),90),t.add("message",m("div",{className:"Form-group"},m("label",null,p().translator.trans("flarum-suspend.forum.suspend_user.display_message"),m("textarea",{className:"FormControl",bidi:this.message,placeholder:p().translator.trans("flarum-suspend.forum.suspend_user.placeholder_optional"),rows:"2"}))),80),t}onsubmit(t){t.preventDefault(),this.loading=!0;let e=null;switch(this.status()){case"indefinitely":e=new Date("2038-01-01");break;case"limited":e=dayjs().add(this.daysRemaining(),"days").toDate()}this.attrs.user.save({suspendedUntil:e,suspendReason:this.reason(),suspendMessage:this.message()}).then((()=>this.hide()),this.loaded.bind(this))}}const N=flarum.core.compat["components/Notification"];var C=s.n(N);class k extends(C()){icon(){return"fas fa-ban"}href(){return p().route.user(this.attrs.notification.subject())}content(){const t=this.attrs.notification,e=t.content(),s=dayjs(e).from(t.createdAt(),!0);return T(e)?p().translator.trans("flarum-suspend.forum.notifications.user_suspended_indefinite_text"):p().translator.trans("flarum-suspend.forum.notifications.user_suspended_text",{timeReadable:s})}}class Y extends(C()){icon(){return"fas fa-ban"}href(){return p().route.user(this.attrs.notification.subject())}content(){return this.attrs.notification,p().translator.trans("flarum-suspend.forum.notifications.user_unsuspended_text")}}const I=flarum.core.compat["common/components/Modal"];var F=s.n(I);const H=flarum.core.compat["common/components/Button"];var j=s.n(H);const L=flarum.core.compat["common/helpers/fullTime"];var A=s.n(L);class W extends(F()){oninit(t){super.oninit(t),this.message=this.attrs.message,this.until=this.attrs.until}className(){return"SuspensionInfoModal Modal"}title(){return p().translator.trans("flarum-suspend.forum.suspension_info.title")}content(){const t=T(new Date(this.until))?p().translator.trans("flarum-suspend.forum.suspension_info.indefinite"):p().translator.trans("flarum-suspend.forum.suspension_info.limited",{date:A()(this.until)});return m("div",{className:"Modal-body"},m("div",{className:"Form Form--centered"},m("p",{className:"helpText"},this.message),m("p",{className:"helpText"},t),m("div",{className:"Form-group"},m(j(),{className:"Button Button--primary Button--block",onclick:this.hide.bind(this)},p().translator.trans("flarum-suspend.forum.suspension_info.dismiss_button")))))}hide(){localStorage.setItem("flarum-suspend.acknowledge-suspension",this.attrs.until.getTime()),this.attrs.state.close()}}function B(){return setTimeout((()=>{if(p().session.user){const t=p().session.user.suspendMessage(),e=p().session.user.suspendedUntil(),s=t&&e&&new Date<e,n=localStorage.getItem("flarum-suspend.acknowledge-suspension")===(null==e?void 0:e.getTime().toString());s&&!n?p().modal.show(W,{message:t,until:e}):localStorage.getItem("flarum-suspend.acknowledge-suspension")&&localStorage.removeItem("flarum-suspend.acknowledge-suspension")}}),0)}const R=flarum.core.compat["common/extenders"];var z=s.n(R);const P=flarum.core.compat["common/models/User"];var Z=s.n(P);const J=flarum.core.compat["common/Model"];var V=s.n(J);const q=[new(z().Model)(Z()).attribute("canSuspend").attribute("suspendedUntil",V().transformDate).attribute("suspendReason").attribute("suspendMessage")],E={"suspend/components/suspendUserModal":U,"suspend/components/suspensionInfoModal":W,"suspend/components/UserSuspendedNotification":k,"suspend/components/UserUnsuspendedNotification":Y,"suspend/checkForSuspension":B},Q=flarum.core;r().initializers.add("flarum-suspend",(()=>{r().notificationComponents.userSuspended=k,r().notificationComponents.userUnsuspended=Y,(0,t.extend)(i(),"moderationControls",((t,e)=>{e.canSuspend()&&t.add("suspend",m(u(),{icon:"fas fa-ban",onclick:()=>r().modal.show(U,{user:e})},r().translator.trans("flarum-suspend.forum.user_controls.suspend_button")))})),(0,t.extend)(f().prototype,"badges",(function(t){const e=this.suspendedUntil();new Date<e&&t.add("suspended",m(d(),{icon:"fas fa-ban",type:"suspended",label:r().translator.trans("flarum-suspend.forum.user_badge.suspended_tooltip")}),100)})),B()})),Object.assign(Q.compat,E)})(),module.exports=n})();
//# sourceMappingURL=forum.js.map