{"version":3,"sources":["webpack://@flarum/markdown/webpack/bootstrap","webpack://@flarum/markdown/external \"flarum.core.compat['extend']\"","webpack://@flarum/markdown/external \"flarum.core.compat['components/TextEditor']\"","webpack://@flarum/markdown/external \"flarum.core.compat['Component']\"","webpack://@flarum/markdown/./node_modules/mdarea/mdarea.min.js","webpack://@flarum/markdown/external \"flarum.core.compat['helpers/icon']\"","webpack://@flarum/markdown/./src/forum/polyfills.js","webpack://@flarum/markdown/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/markdown/./src/forum/components/MarkdownToolbar.js","webpack://@flarum/markdown/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@flarum/markdown/./src/forum/util/insertText.js","webpack://@flarum/markdown/./src/forum/util/styles.js","webpack://@flarum/markdown/./src/forum/util/apply.js","webpack://@flarum/markdown/./src/forum/components/MarkdownButton.js","webpack://@flarum/markdown/./src/forum/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","self","undefined","a","test","navigator","platform","f","_","g","y","b","`","~","v","[","(","{","<","K","]",")","}",">","e","this","_useTab","_useInline","_indent","_reOutdent","_reKey","_handleKey","setElement","RegExp","x","selectionStart","selectionEnd","arguments","length","window","InputEvent","dispatchEvent","constructor","getElement","_elem","removeEventListener","addEventListener","getValue","setValue","getIndent","setIndent","Array","join","replace","isTabUsed","useTab","ignoreTab","isInlineEnabled","enableInline","disableInline","destroy","defaultPrevented","target","substring","ctrlKey","altKey","metaKey","shiftKey","lastIndexOf","h","u","charAt","exec","line","offset","prefix","parseInt","preventDefault","apply","String","startsWith","search","pos","endsWith","this_len","_inheritsLoose","subClass","superClass","__proto__","modifierKey","userAgent","match","MarkdownToolbar","config","isInitialized","document","getElementById","props","for","shortcut","view","id","data-for","style","display","children","event","button","element","querySelector","click","Component","_extends","assign","source","canInsertText","isMultipleLines","string","trim","split","repeat","wordSelectionEnd","text","multiline","index","breakpoint","newlinesToSurroundSelectedText","textarea","newlinesToAppend","newlinesToPrepend","beforeSelection","slice","afterSelection","breaksBefore","breaksAfter","newlinesBeforeSelection","newlinesAfterSelection","blockStyle","arg","suffix","blockPrefix","blockSuffix","replaceNext","prefixSpace","scanFor","surroundWithNewlines","originalSelectionStart","originalSelectionEnd","selectedText","prefixToUse","suffixToUse","wordSelectionStart","expandedSelectionStart","expandedSelectionEnd","beginsWithPrefix","endsWithSuffix","expandSelectedText","hasReplaceNext","indexOf","ref","replacementText","position","Math","max","min","whitespaceEdges","trimFirst","leadingWhitespace","trailingWhitespace","styleSelectedText","styleArgs","result","orderedList","startOfLine","endOfLine","orderedListRegex","noInitialSelection","textToUnstyle","lines","linesBefore","linesToUnstyle","every","map","lengthDiff","len","results","push","_newlinesToSurroundSe2","_newlinesToSurroundSe","multilineStyle","_ref","before","after","contentEditable","execCommand","error","createEvent","initEvent","setSelectionRange","insertText","MarkdownButton","$","tooltip","className","title","data-hotkey","hotkey","onclick","onkeydown","keydown","icon","stylesToApply","toolbar","parentElement","field","dataset","focus","app","initializers","add","extend","TextEditor","textareaId","vdom","attrs","context","editor","MarkdownArea","onunload","items","translator","trans","MarkdownToolbar_MarkdownToolbar","MarkdownButton_MarkdownButton"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['components/TextEditor'];","module.exports = flarum.core.compat['Component'];","!function(e,t){\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof module&&module.exports?module.exports=t():e.MarkdownArea=t()}(\"undefined\"!=typeof self?self:this,function(){var a=/mac|iphone|ipad|ipod/i.test(navigator.platform)?\"metaKey\":\"ctrlKey\",o=/^[\"'`*_[({<>})\\]]$/,f=/[*_]/,_=/^[ \\t]*(?:(?:[-+*]|\\d+\\.)[ \\t]+(?:\\[[ x]][ \\t]+)?|>[ \\t]*)*(?::[ \\t]*)?/,c=/(?:[-+*]|\\d+\\.)[ \\t]+(?:\\[[ x]][ \\t]+)?$/,g=/[-+*\\[\\]x\\d.]/g,y=/[^ \\t]/g,p=/(\\d+)\\.(?=[ \\t]+$)/,m=/(?:(?:^[ \\t]+)?(?:[-+*]|\\d+\\.|[>:])(?:[ \\t]+\\[[ x]])?[ \\t]*|^[ \\t]+)$/,d=/^(?!$)/gm,b={\"`\":/^``$/m,\"~\":/^~~$/m},v={\"[\":\"]\",\"(\":\")\",\"{\":\"}\",\"<\":\">\"},K={\"]\":\"[\",\")\":\"(\",\"}\":\"{\",\">\":\"<\"};function e(e){this._useTab=!0,this._useInline=!0,this._indent=\"    \",this._reOutdent=/^[ ]{4}/gm,this._reKey=t(!0,!0),this._handleKey=this._handleKey.bind(this),this.setElement(e)}function t(e,t){return new RegExp(\"^(?:Enter\"+(e?\"|Tab\":\"\")+\"|[io\"+(t?\"\\\"'`*_([{<>}\\\\])\":\"\")+\"])$\")}function x(e,t,n,i){if(e.value=t,e.selectionStart=n,e.selectionEnd=3<arguments.length?i:n,\"InputEvent\"in window)try{var s=new InputEvent(\"input\");e.dispatchEvent(s)}catch(i){}}return e.prototype={constructor:e,getElement:function(){return this._elem},setElement:function(e){this._elem&&this._elem.removeEventListener(\"keydown\",this._handleKey),(this._elem=e).addEventListener(\"keydown\",this._handleKey)},getValue:function(){return this._elem.value},setValue:function(e){this._elem.value=e},getIndent:function(){return this._indent},setIndent:function(e){this._indent=\"number\"==typeof e?new Array(e+1).join(\" \"):(e+\"\").replace(/[^ \\t]/g,\" \"),this._reOutdent=new RegExp(\"^\"+this._indent,\"mg\")},isTabUsed:function(){return this._useTab},useTab:function(){this._useTab=!0,this._reKey=t(!0,this._useInline)},ignoreTab:function(){this._useTab=!1,this._reKey=t(!1,this._useInline)},isInlineEnabled:function(){return this._useInline},enableInline:function(){this._useInline=!0,this._reKey=t(this._useTab,!0)},disableInline:function(){this._useInline=!1,this._reKey=t(this._useTab,!1)},destroy:function(){this._elem.removeEventListener(\"keydown\",this._handleKey),this._elem=this._reKey=this._handleKey=this._indent=this._reOutdent=null},_handleKey:function(e){if(!e.defaultPrevented&&this._reKey.test(e.key)){var t=e.target.value.substring(0,e.target.selectionStart),n=e.target.value.substring(e.target.selectionStart,e.target.selectionEnd),i=e.target.value.substring(e.target.selectionEnd);if(\"Enter\"!==e.key||e.ctrlKey||e.altKey||e.metaKey)if(\"Tab\"===e.key&&!e.shiftKey||\"i\"===e.key&&e[a])!function(e,t,n,i,s){var r=t.length,l=t.lastIndexOf(\"\\n\")+1;l<r&&(n=t.substring(l)+n,t=t.substring(0,l));(l<r||!n)&&(r+=s.length);n?n=n.replace(d,s):t+=s;x(e,t+n+i,r,n?l+n.length:r)}(this._elem,t,n,i,this._indent);else if(\"Tab\"===e.key&&e.shiftKey||\"o\"===e.key&&e[a])!function(e,t,n,i,s,r){var l=t.length,h=t.lastIndexOf(\"\\n\")+1;h<l&&(n=t.substring(h)+n,t=t.substring(0,h),n.substring(0,s.length)===s&&(l-=s.length));n=n.replace(r,\"\"),x(e,t+n+i,l,h+n.length)}(this._elem,t,n,i,this._indent,this._reOutdent);else{if(!o.test(e.key))return;s=this._elem,r=t,l=n,h=i,u=e.key,l||u in v||h.charAt(0)!==u?!l&&(\"'\"===u||u in K)?x(s,r+u+h,r.length+1):!l&&u in b&&b[u].test(r)?x(s,r+u+\"language\\n\"+u+u+u+(\"\\n\"!==h.charAt(0)?\"\\n\":\"\")+h,r.length+1,r.length+9):x(s,r+(K[u]||u)+l+(v[u]||u)+h,r.length+1,r.length+1+l.length):x(s,r+(f.test(u)?u+u:\"\")+h,r.length+1)}else!function(e,t,n,i,s){var r=n?null:(l=t,h=l.lastIndexOf(\"\\n\")+1,u=l.substring(h),a=_.exec(u),{line:u,offset:h,prefix:a&&a[0]});var l,h,u,a;!n&&r.prefix?s||r.prefix!==r.line?!s&&(d=r.prefix,c.test(d))?t+=\"\\n\"+r.prefix.replace(p,function(e,t){return parseInt(t)+1+\".\"}):t+=\"\\n\"+(o=r.prefix,f=s,o.replace(f?y:g,\" \")):t=t.substring(0,r.offset)+r.prefix.replace(m,\"\"):t+=\"\\n\";var o,f;var d;x(e,t+i,t.length)}(this._elem,t,n,i,e.shiftKey);e.preventDefault()}var s,r,l,h,u}},e});\n//# sourceMappingURL=mdarea.min.map\n","module.exports = flarum.core.compat['helpers/icon'];","/*! https://mths.be/startswith v0.2.0 by @mathias */\nif (!String.prototype.startsWith) {\n  Object.defineProperty(String.prototype, 'startsWith', {\n    value: function(search, pos) {\n      pos = !pos || pos < 0 ? 0 : +pos;\n      return this.substring(pos, pos + search.length) === search;\n    }\n  });\n}\n\nif (!String.prototype.endsWith) {\n  String.prototype.endsWith = function(search, this_len) {\n    if (this_len === undefined || this_len > this.length) {\n      this_len = this.length;\n    }\n    return this.substring(this_len - search.length, this_len) === search;\n  };\n}\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Component from 'flarum/Component';\n\nconst modifierKey = navigator.userAgent.match(/Macintosh/) ? 'Meta' : 'Control';\n\nexport default class MarkdownToolbar extends Component {\n  config(isInitialized) {\n    if (isInitialized) return;\n\n    const field = document.getElementById(this.props.for);\n\n    field.addEventListener('keydown', this.shortcut.bind(this));\n  }\n\n  view() {\n    return <div id=\"MarkdownToolbar\" data-for={this.props.for} style={{ display: 'inline-block' }}>\n      {this.props.children}\n    </div>;\n  }\n\n  shortcut(event) {\n    if ((event.metaKey && modifierKey === 'Meta') || (event.ctrlKey && modifierKey === 'Control')) {\n      const button = this.element.querySelector(`[data-hotkey=\"${event.key}\"]`);\n\n      if (button) {\n        button.click();\n        event.preventDefault()\n      }\n    }\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","/*\n * Original Copyright GitHub, Inc. Licensed under the MIT License.\n * See license text at https://github.com/github/markdown-toolbar-element/blob/master/LICENSE.\n */\n\nexport let canInsertText = null;\n\nexport default (textarea, { text, selectionStart, selectionEnd }) => {\n  const originalSelectionStart = textarea.selectionStart;\n  const before = textarea.value.slice(0, originalSelectionStart);\n  const after = textarea.value.slice(textarea.selectionEnd);\n\n  if (canInsertText === null || canInsertText === true) {\n    textarea.contentEditable = 'true';\n    try {\n      canInsertText = document.execCommand('insertText', false, text);\n    }\n    catch (error) {\n      canInsertText = false;\n    }\n    textarea.contentEditable = 'false';\n  }\n  if (canInsertText && !textarea.value.slice(0, textarea.selectionStart).endsWith(text)) {\n    canInsertText = false;\n  }\n  if (!canInsertText) {\n    try {\n      document.execCommand('ms-beginUndoUnit');\n    }\n    catch (e) {\n      // Do nothing.\n    }\n    textarea.value = before + text + after;\n    try {\n      document.execCommand('ms-endUndoUnit');\n    }\n    catch (e) {\n      // Do nothing.\n    }\n\n    // fire custom event, works on IE\n    const event = document.createEvent('Event');\n\n    event.initEvent('input', true, true);\n\n    textarea.dispatchEvent(event);\n  }\n  if (selectionStart != null && selectionEnd != null) {\n    textarea.setSelectionRange(selectionStart, selectionEnd);\n  }\n  else {\n    textarea.setSelectionRange(originalSelectionStart, textarea.selectionEnd);\n  }\n};\n","/*\n * Original Copyright GitHub, Inc. Licensed under the MIT License.\n * See license text at https://github.com/github/markdown-toolbar-element/blob/master/LICENSE.\n */\n\nexport function isMultipleLines(string) {\n  return string.trim().split('\\n').length > 1;\n}\n\nexport function repeat(string, n) {\n  return Array(n + 1).join(string);\n}\n\nexport function wordSelectionStart(text, i) {\n  let index = i;\n\n  while (text[index] && text[index - 1] != null && !text[index - 1].match(/\\s/)) {\n    index--;\n  }\n\n  return index;\n}\n\nexport function wordSelectionEnd(text, i, multiline) {\n  let index = i;\n  const breakpoint = multiline ? /\\n/ : /\\s/;\n\n  while (text[index] && !text[index].match(breakpoint)) {\n    index++;\n  }\n\n  return index;\n}\n\nexport function expandSelectedText(textarea, prefixToUse, suffixToUse) {\n  let multiline = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  if (textarea.selectionStart === textarea.selectionEnd) {\n    textarea.selectionStart = wordSelectionStart(textarea.value, textarea.selectionStart);\n    textarea.selectionEnd = wordSelectionEnd(textarea.value, textarea.selectionEnd, multiline);\n  } else {\n    const expandedSelectionStart = textarea.selectionStart - prefixToUse.length;\n    const expandedSelectionEnd = textarea.selectionEnd + suffixToUse.length;\n    const beginsWithPrefix = textarea.value.slice(expandedSelectionStart, textarea.selectionStart) === prefixToUse;\n    const endsWithSuffix = textarea.value.slice(textarea.selectionEnd, expandedSelectionEnd) === suffixToUse;\n\n    if (beginsWithPrefix && endsWithSuffix) {\n      textarea.selectionStart = expandedSelectionStart;\n      textarea.selectionEnd = expandedSelectionEnd;\n    }\n  }\n\n  return textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n}\n\nexport function newlinesToSurroundSelectedText(textarea) {\n  const beforeSelection = textarea.value.slice(0, textarea.selectionStart);\n  const afterSelection = textarea.value.slice(textarea.selectionEnd);\n  const breaksBefore = beforeSelection.match(/\\n*$/);\n  const breaksAfter = afterSelection.match(/^\\n*/);\n  const newlinesBeforeSelection = breaksBefore ? breaksBefore[0].length : 0;\n  const newlinesAfterSelection = breaksAfter ? breaksAfter[0].length : 0;\n  let newlinesToAppend;\n  let newlinesToPrepend;\n\n  if (beforeSelection.match(/\\S/) && newlinesBeforeSelection < 2) {\n    newlinesToAppend = repeat('\\n', 2 - newlinesBeforeSelection);\n  }\n\n  if (afterSelection.match(/\\S/) && newlinesAfterSelection < 2) {\n    newlinesToPrepend = repeat('\\n', 2 - newlinesAfterSelection);\n  }\n\n  if (newlinesToAppend == null) {\n    newlinesToAppend = '';\n  }\n\n  if (newlinesToPrepend == null) {\n    newlinesToPrepend = '';\n  }\n\n  return {\n    newlinesToAppend,\n    newlinesToPrepend\n  };\n}\n\nexport const blockStyle = (textarea, arg) => {\n  let newlinesToAppend;\n  let newlinesToPrepend;\n  const { prefix, suffix, blockPrefix, blockSuffix, replaceNext, prefixSpace, scanFor, surroundWithNewlines } = arg;\n  const originalSelectionStart = textarea.selectionStart;\n  const originalSelectionEnd = textarea.selectionEnd;\n  let selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  let prefixToUse = isMultipleLines(selectedText) && blockPrefix.length > 0 ? `${blockPrefix}\\n` : prefix;\n  let suffixToUse = isMultipleLines(selectedText) && blockSuffix.length > 0 ? `\\n${blockSuffix}` : suffix;\n\n  if (prefixSpace) {\n    const beforeSelection = textarea.value[textarea.selectionStart - 1];\n    if (textarea.selectionStart !== 0 && beforeSelection != null && !beforeSelection.match(/\\s/)) {\n      prefixToUse = ` ${prefixToUse}`;\n    }\n  }\n\n  selectedText = expandSelectedText(textarea, prefixToUse, suffixToUse, arg.multiline);\n  let selectionStart = textarea.selectionStart;\n  let selectionEnd = textarea.selectionEnd;\n  const hasReplaceNext = replaceNext.length > 0 && suffixToUse.indexOf(replaceNext) > -1 && selectedText.length > 0;\n\n  if (surroundWithNewlines) {\n    const ref = newlinesToSurroundSelectedText(textarea);\n    newlinesToAppend = ref.newlinesToAppend;\n    newlinesToPrepend = ref.newlinesToPrepend;\n    prefixToUse = newlinesToAppend + prefix;\n    suffixToUse += newlinesToPrepend;\n  }\n\n  if (selectedText.startsWith(prefixToUse) && selectedText.endsWith(suffixToUse)) {\n    const replacementText = selectedText.slice(prefixToUse.length, selectedText.length - suffixToUse.length);\n    if (originalSelectionStart === originalSelectionEnd) {\n      let position = originalSelectionStart - prefixToUse.length;\n      position = Math.max(position, selectionStart);\n      position = Math.min(position, selectionStart + replacementText.length);\n      selectionStart = selectionEnd = position;\n    }\n    else {\n      selectionEnd = selectionStart + replacementText.length;\n    }\n    return { text: replacementText, selectionStart, selectionEnd };\n  }\n  else if (!hasReplaceNext) {\n    let replacementText = prefixToUse + selectedText + suffixToUse;\n    selectionStart = originalSelectionStart + prefixToUse.length;\n    selectionEnd = originalSelectionEnd + prefixToUse.length;\n    const whitespaceEdges = selectedText.match(/^\\s*|\\s*$/g);\n    if (arg.trimFirst && whitespaceEdges) {\n      const leadingWhitespace = whitespaceEdges[0] || '';\n      const trailingWhitespace = whitespaceEdges[1] || '';\n      replacementText = leadingWhitespace + prefixToUse + selectedText.trim() + suffixToUse + trailingWhitespace;\n      selectionStart += leadingWhitespace.length;\n      selectionEnd -= trailingWhitespace.length;\n    }\n    return { text: replacementText, selectionStart, selectionEnd };\n  }\n  else if (scanFor.length > 0 && selectedText.match(scanFor)) {\n    suffixToUse = suffixToUse.replace(replaceNext, selectedText);\n    const replacementText = prefixToUse + suffixToUse;\n    selectionStart = selectionEnd = selectionStart + prefixToUse.length;\n    return { text: replacementText, selectionStart, selectionEnd };\n  }\n  else {\n    const replacementText = prefixToUse + selectedText + suffixToUse;\n    selectionStart = selectionStart + prefixToUse.length + selectedText.length + suffixToUse.indexOf(replaceNext);\n    selectionEnd = selectionStart + replaceNext.length;\n    return { text: replacementText, selectionStart, selectionEnd };\n  }\n}\n\nexport const multilineStyle = (textarea, arg) => {\n  const { prefix, suffix, surroundWithNewlines } = arg;\n  let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  let selectionStart = textarea.selectionStart;\n  let selectionEnd = textarea.selectionEnd;\n  const lines = text.split('\\n');\n  const undoStyle = lines.every(line => line.startsWith(prefix) && line.endsWith(suffix));\n  if (undoStyle) {\n    text = lines.map(line => line.slice(prefix.length, line.length - suffix.length)).join('\\n');\n    selectionEnd = selectionStart + text.length;\n  }\n  else {\n    text = lines.map(line => prefix + line + suffix).join('\\n');\n    if (surroundWithNewlines) {\n      const { newlinesToAppend, newlinesToPrepend } = newlinesToSurroundSelectedText(textarea);\n      selectionStart += newlinesToAppend.length;\n      selectionEnd = selectionStart + text.length;\n      text = newlinesToAppend + text + newlinesToPrepend;\n    }\n  }\n  return { text, selectionStart, selectionEnd };\n}\n\nexport const orderedList = (textarea) => {\n  const orderedListRegex = /^\\d+\\.\\s+/;\n  const noInitialSelection = textarea.selectionStart === textarea.selectionEnd;\n  let selectionEnd;\n  let selectionStart;\n  let text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  let textToUnstyle = text;\n  let lines = text.split('\\n');\n  let startOfLine, endOfLine;\n  if (noInitialSelection) {\n    const linesBefore = textarea.value.slice(0, textarea.selectionStart).split(/\\n/);\n    startOfLine = textarea.selectionStart - linesBefore[linesBefore.length - 1].length;\n    endOfLine = wordSelectionEnd(textarea.value, textarea.selectionStart, true);\n    textToUnstyle = textarea.value.slice(startOfLine, endOfLine);\n  }\n  const linesToUnstyle = textToUnstyle.split('\\n');\n  const undoStyling = linesToUnstyle.every(line => orderedListRegex.test(line));\n  if (undoStyling) {\n    lines = linesToUnstyle.map(line => line.replace(orderedListRegex, ''));\n    text = lines.join('\\n');\n    if (noInitialSelection && startOfLine && endOfLine) {\n      const lengthDiff = linesToUnstyle[0].length - lines[0].length;\n      selectionStart = selectionEnd = textarea.selectionStart - lengthDiff;\n      textarea.selectionStart = startOfLine;\n      textarea.selectionEnd = endOfLine;\n    }\n  }\n  else {\n    lines = (function () {\n      let i;\n      let len;\n      let index;\n      const results = [];\n      for (index = i = 0, len = lines.length; i < len; index = ++i) {\n        const line = lines[index];\n        results.push(`${index + 1}. ${line}`);\n      }\n      return results;\n    })();\n    text = lines.join('\\n');\n    const { newlinesToAppend, newlinesToPrepend } = newlinesToSurroundSelectedText(textarea);\n    selectionStart = textarea.selectionStart + newlinesToAppend.length;\n    selectionEnd = selectionStart + text.length;\n    if (noInitialSelection)\n      selectionStart = selectionEnd;\n    text = newlinesToAppend + text + newlinesToPrepend;\n  }\n  return { text, selectionStart, selectionEnd };\n}\n","/*\n * Original Copyright GitHub, Inc. Licensed under the MIT License.\n * See license text at https://github.com/github/markdown-toolbar-element/blob/master/LICENSE.\n */\n\nimport insertText from './insertText';\nimport { blockStyle, isMultipleLines, multilineStyle, orderedList } from './styles';\n\nexport const styleSelectedText = (textarea, styleArgs) => {\n  const text = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n  let result;\n  if (styleArgs.orderedList) {\n    result = orderedList(textarea);\n  }\n  else if (styleArgs.multiline && isMultipleLines(text)) {\n    result = multilineStyle(textarea, styleArgs);\n  }\n  else {\n    result = blockStyle(textarea, styleArgs);\n  }\n\n  insertText(textarea, result);\n};\n\nexport default (button, stylesToApply) => {\n  const toolbar = button.parentElement;\n\n  const defaults = {\n    prefix: '',\n    suffix: '',\n    blockPrefix: '',\n    blockSuffix: '',\n    multiline: false,\n    replaceNext: '',\n    prefixSpace: false,\n    scanFor: '',\n    surroundWithNewlines: false,\n    orderedList: false,\n    trimFirst: false\n  };\n\n  const style = Object.assign({}, defaults, stylesToApply);\n\n  const field = document.getElementById(toolbar.dataset.for);\n\n  if (field) {\n    field.focus();\n    styleSelectedText(field, style);\n  }\n}\n","import Component from 'flarum/Component';\nimport icon from 'flarum/helpers/icon';\nimport apply from '../util/apply';\n\nconst modifierKey = navigator.userAgent.match(/Macintosh/) ? 'âŒ˜' : 'ctrl';\n\nexport default class MarkdownButton extends Component {\n  config(isInitialized) {\n    if (isInitialized) return;\n\n    this.$().tooltip();\n  }\n\n  view() {\n    return <button className=\"Button Button--icon Button--link\" title={this.title()} data-hotkey={this.props.hotkey}\n                   onclick={this.click.bind(this)} onkeydown={this.keydown.bind(this)}>\n      {icon(this.props.icon)}\n    </button>;\n  }\n\n  keydown(event) {\n    if (event.key === ' ' || event.key === 'Enter') {\n      event.preventDefault();\n      this.click();\n    }\n  }\n\n  click() {\n    return apply(this.element, this.props.style);\n  }\n\n  title() {\n    let tooltip = this.props.title;\n\n    if (this.props.hotkey) tooltip += ` <${modifierKey}-${this.props.hotkey}>`;\n\n    return tooltip;\n  }\n}\n","/*!\n * Includes modified code from GitHub Markdown Toolbar Element\n * https://github.com/github/markdown-toolbar-element/\n *\n * Original Copyright GitHub, Inc.\n * Released under the MIT license\n * https://github.com/github/markdown-toolbar-element/blob/master/LICENSE\n */\n\nimport { extend } from 'flarum/extend';\nimport TextEditor from 'flarum/components/TextEditor';\nimport MarkdownArea from 'mdarea';\n\nimport './polyfills';\nimport MarkdownToolbar from './components/MarkdownToolbar';\nimport MarkdownButton from './components/MarkdownButton';\n\napp.initializers.add('flarum-markdown', function(app) {\n\n  let index = 1;\n\n  extend(TextEditor.prototype, 'init', function() {\n    this.textareaId = 'textarea'+(index++);\n  });\n\n  extend(TextEditor.prototype, 'view', function(vdom) {\n    vdom.children[0].attrs.id = this.textareaId;\n  });\n\n  extend(TextEditor.prototype, 'configTextarea', function(value, element, isInitialized, context) {\n    if (isInitialized) return;\n\n    const editor = new MarkdownArea(element);\n    editor.disableInline();\n    editor.ignoreTab();\n\n    context.onunload = function() {\n      editor.destroy();\n    };\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function(items) {\n    const tooltip = name => app.translator.trans(`flarum-markdown.forum.composer.${name}_tooltip`);\n\n    items.add('markdown', (\n      <MarkdownToolbar for={this.textareaId}>\n        <MarkdownButton title={tooltip('header')} icon=\"fas fa-heading\" style={{ prefix: '### ' }} />\n        <MarkdownButton title={tooltip('bold')} icon=\"fas fa-bold\" style={{ prefix: '**', suffix: '**', trimFirst: true }} hotkey=\"b\" />\n        <MarkdownButton title={tooltip('italic')} icon=\"fas fa-italic\" style={{ prefix: '_', suffix: '_', trimFirst: true }} hotkey=\"i\" />\n        <MarkdownButton title={tooltip('quote')} icon=\"fas fa-quote-left\" style={{ prefix: '> ', multiline: true, surroundWithNewlines: true }} />\n        <MarkdownButton title={tooltip('code')} icon=\"fas fa-code\" style={{ prefix: '`', suffix: '`', blockPrefix: '```', blockSuffix: '```' }} />\n        <MarkdownButton title={tooltip('link')} icon=\"fas fa-link\" style={{ prefix: '[', suffix: '](url)', replaceNext: 'url', scanFor: 'https?://' }} />\n        <MarkdownButton title={tooltip('image')} icon=\"fas fa-image\" style={{ prefix: '![', suffix: '](src)', replaceNext: 'src', scanFor: 'https?://' }} />\n        <MarkdownButton title={tooltip('unordered_list')} icon=\"fas fa-list-ul\" style={{ prefix: '- ', multiline: true, surroundWithNewlines: true }} />\n        <MarkdownButton title={tooltip('ordered_list')} icon=\"fas fa-list-ol\" style={{ prefix: '1. ', multiline: true, orderedList: true }} />\n      </MarkdownToolbar>\n    ), 100);\n  });\n});\n"],"sourceRoot":""}