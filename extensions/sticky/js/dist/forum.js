(()=>{var t={n:o=>{var n=o&&o.__esModule?()=>o.default:()=>o;return t.d(n,{a:n}),n},d:(o,n)=>{for(var s in n)t.o(n,s)&&!t.o(o,s)&&Object.defineProperty(o,s,{enumerable:!0,get:n[s]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o),t.d(o,{extend:()=>A});const n=flarum.core.compat["forum/app"];var s=t.n(n);const c=flarum.core.compat["common/Model"];var r=t.n(c);const e=flarum.core.compat["common/models/Discussion"];var i=t.n(e);const a=flarum.core.compat["common/extend"],u=flarum.core.compat["common/components/Badge"];var p=t.n(u);const f=flarum.core.compat["forum/utils/DiscussionControls"];var l=t.n(f);const d=flarum.core.compat["forum/components/DiscussionPage"];var y=t.n(d);const k=flarum.core.compat["common/components/Button"];var v=t.n(k);const b=flarum.core.compat["forum/states/DiscussionListState"];var h=t.n(b);const _=flarum.core.compat["forum/components/DiscussionListItem"];var S=t.n(_);const P=flarum.core.compat["forum/components/IndexPage"];var x=t.n(P);const g=flarum.core.compat["common/utils/string"],O=flarum.core.compat["common/utils/classList"];var j=t.n(O);const D=flarum.core.compat["common/extenders"];var I=t.n(D);function L(t,o){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},L(t,o)}const M=flarum.core.compat["forum/components/EventPost"];var w=function(t){var o,n;function s(){return t.apply(this,arguments)||this}n=t,(o=s).prototype=Object.create(n.prototype),o.prototype.constructor=o,L(o,n);var c=s.prototype;return c.icon=function(){return"fas fa-thumbtack"},c.descriptionKey=function(){return this.attrs.post.content().sticky?"flarum-sticky.forum.post_stream.discussion_stickied_text":"flarum-sticky.forum.post_stream.discussion_unstickied_text"},s}(t.n(M)());const A=[(new(I().PostTypes)).add("discussionStickied",w)];s().initializers.add("flarum-sticky",(function(){i().prototype.isSticky=r().attribute("isSticky"),i().prototype.canSticky=r().attribute("canSticky"),(0,a.extend)(i().prototype,"badges",(function(t){this.isSticky()&&t.add("sticky",p().component({type:"sticky",label:s().translator.trans("flarum-sticky.forum.badge.sticky_tooltip"),icon:"fas fa-thumbtack"}),10)})),(0,a.extend)(l(),"moderationControls",(function(t,o){o.canSticky()&&t.add("sticky",v().component({icon:"fas fa-thumbtack",onclick:this.stickyAction.bind(o)},s().translator.trans(o.isSticky()?"flarum-sticky.forum.discussion_controls.unsticky_button":"flarum-sticky.forum.discussion_controls.sticky_button")))})),l().stickyAction=function(){this.save({isSticky:!this.isSticky()}).then((function(){s().current.matches(y())&&s().current.get("stream").update(),m.redraw()}))},(0,a.extend)(h().prototype,"requestParams",(function(t){(s().current.matches(x())||s().current.matches(y()))&&t.include.push("firstPost")})),(0,a.extend)(S().prototype,"infoItems",(function(t){var o=this.attrs.discussion;if(o.isSticky()&&!this.attrs.params.q&&!o.lastReadPostNumber()){var n=o.firstPost();if(n){var s=(0,g.truncate)(n.contentPlain(),175);t.add("excerpt",m("div",null,s),-100)}}})),(0,a.extend)(S().prototype,"elementAttrs",(function(t){this.attrs.discussion.isSticky()&&(t.className=j()(t.className,"DiscussionListItem--sticky"))}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map