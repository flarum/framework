{"version":3,"sources":["webpack://@flarum/mentions/webpack/bootstrap","webpack://@flarum/mentions/external \"flarum.core.compat['common/extend']\"","webpack://@flarum/mentions/external \"flarum.core.compat['app']\"","webpack://@flarum/mentions/external \"flarum.core.compat['extend']\"","webpack://@flarum/mentions/external \"flarum.core.compat['utils/string']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/components/PostPreview']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/helpers/username']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/CommentPost']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/components/EditPostComposer']\"","webpack://@flarum/mentions/external \"flarum.core.compat['Fragment']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/Notification']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/components/TextEditor']\"","webpack://@flarum/mentions/external \"flarum.core.compat['helpers/username']\"","webpack://@flarum/mentions/external \"flarum.core.compat['utils/extractText']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/NotificationGrid']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/Model']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/models/Post']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/components/Link']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/helpers/punctuateSeries']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/Button']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@flarum/mentions/external \"flarum.core.compat['helpers/icon']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/helpers/avatar']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/helpers/highlight']\"","webpack://@flarum/mentions/external \"flarum.core.compat['forum/utils/KeyboardNavigatable']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/utils/string']\"","webpack://@flarum/mentions/external \"flarum.core.compat['common/utils/throttleDebounce']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/UserPage']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/LinkButton']\"","webpack://@flarum/mentions/external \"flarum.core.compat['components/PostsUserPage']\"","webpack://@flarum/mentions/./src/forum/utils/getCleanDisplayName.js","webpack://@flarum/mentions/./src/forum/utils/getMentionText.js","webpack://@flarum/mentions/./src/forum/utils/reply.js","webpack://@flarum/mentions/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@flarum/mentions/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flarum/mentions/./src/forum/fragments/PostQuoteButton.js","webpack://@flarum/mentions/./src/forum/addPostQuoteButton.js","webpack://@flarum/mentions/./src/forum/utils/selectedText.js","webpack://@flarum/mentions/./src/forum/fragments/AutocompleteDropdown.js","webpack://@flarum/mentions/./src/forum/addComposerAutocomplete.js","webpack://@flarum/mentions/./src/forum/components/PostMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/UserMentionedNotification.js","webpack://@flarum/mentions/./src/forum/components/MentionsUserPage.js","webpack://@flarum/mentions/./src/forum/utils/textFormatter.js","webpack://@flarum/mentions/./src/forum/index.js","webpack://@flarum/mentions/./src/forum/addPostMentionPreviews.js","webpack://@flarum/mentions/./src/forum/addMentionedByList.js","webpack://@flarum/mentions/./src/forum/addPostReplyAction.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","getDeletedUserText","app","translator","trans","getCleanDisplayName","user","useDisplayName","displayName","username","replace","getMentionText","postId","undefined","ShouldUseOldFormat","id","insertMention","post","composer","quote","mention","fields","content","body","attrs","originalContent","cursorPosition","editor","getSelectionRange","preceding","slice","precedingNewlines","length","match","insertAtCursor","Array","join","trim","reply","bodyMatches","EditPostComposer","discussion","DiscussionControls","replyAction","then","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","PostQuoteButton","view","class","onclick","icon","className","show","left","top","$this","this","$","parentOffset","offsetParent","offset","css","hideHandler","hide","document","on","showStart","window","scrollTop","outerHeight","showEnd","right","bottom","outerWidth","off","Fragment","addPostQuoteButton","extend","CommentPost","isHidden","session","canReply","$postBody","$container","button","handler","e","setTimeout","selection","getSelection","rangeCount","range","getRangeAt","parent","commonAncestorContainer","contains","clone","append","cloneContents","find","replaceWith","alt","src","innerText","href","text","selectedText","render","rects","getClientRects","firstRect","clientY","clientX","lastRect","after","addEventListener","AutocompleteDropdown","items","active","index","keyWasJustPressed","map","item","navigate","delta","setIndex","clearTimeout","keyWasJustPressedTimeout","complete","eq","click","scrollToItem","$dropdown","$items","rangedIndex","$item","removeClass","addClass","dropdownScroll","dropdownTop","dropdownBottom","itemTop","itemBottom","parseInt","stop","animate","throttledSearch","throttle","typed","searched","returnedUsers","returnedUserIds","dropdown","buildSuggestions","typedLower","toLowerCase","includes","store","filter","q","page","limit","results","forEach","u","has","add","push","addComposerAutocomplete","TextEditor","$editor","wrap","navigator","KeyboardNavigatable","when","onUp","onDown","onSelect","onCancel","bindTo","params","relMentionStart","absMentionStart","matchTyped","from","all","Set","inputListeners","cursor","lastChunk","getLastNChars","substr","test","substring","makeSuggestion","replacement","usernameHelper","children","highlight","replaceBeforeCursor","applySuggestion","onmouseenter","avatar","userMatches","some","suggestions","ReplyComposer","composerAttrs","composerPost","posts","contentType","number","sort","a","b","createdAt","splice","truncate","contentPlain","coordinates","getCaretCoordinates","width","height","Math","max","PostMentionedNotification","notification","subject","route","replyNumber","fromUser","count","excerpt","Notification","UserMentionedNotification","MentionsUserPage","loadResults","type","mentioned","loadLimit","PostsUserPage","filterUserMentions","tag","forum","attribute","hasAttribute","getBy","getAttribute","getById","setAttribute","slug","extractText","invalidate","filterPostMentions","initializers","addPreviews","contentHtml","oldPostContentHtml","isEditing","parentPost","$parentPost","set","preventDefault","each","timeout","data","$preview","getPostElement","showPreview","$post","visible","pageYOffset","positionPreview","previewHeight","showPost","title","PostPreview","component","LoadingIndicator","hidePreview","hasClass","one","cancelable","hover","stopPropagation","addPostMentionPreviews","Post","mentionedBy","Model","hasMany","replies","is","data-number","users","repliers","indexOf","overLimit","names","punctuateSeries","addMentionedByList","notificationComponents","postMentioned","userMentioned","NotificationGrid","label","routes","path","UserPage","LinkButton","getPlainContent","removeSelectors"],"mappings":"2BACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QA0Df,OArDAF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,GAIjBlC,EAAoBA,EAAoBmC,EAAI,I,gBClFrDhC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,kB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAY,K,cCAzCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAe,Q,cCA5CnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,4B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,2B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,sC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAiB,U,cCA9CnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,4B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,qB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,sB,eCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,gC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,uC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,uB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,2B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,mC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,wB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,sB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,mC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,iB,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,uC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,mC,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,0B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,6B,cCApCnC,EAAOD,QAAUkC,OAAOC,KAAKC,OAAO,oC,cCApCnC,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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 36);\n","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/string'];","module.exports = flarum.core.compat['forum/components/CommentPost'];","module.exports = flarum.core.compat['forum/components/PostPreview'];","module.exports = flarum.core.compat['common/helpers/username'];","module.exports = flarum.core.compat['components/CommentPost'];","module.exports = flarum.core.compat['forum/components/EditPostComposer'];","module.exports = flarum.core.compat['Fragment'];","module.exports = flarum.core.compat['components/Notification'];","module.exports = flarum.core.compat['common/components/TextEditor'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['components/NotificationGrid'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/Model'];","module.exports = flarum.core.compat['common/models/Post'];","module.exports = flarum.core.compat['common/components/Link'];","module.exports = flarum.core.compat['common/helpers/punctuateSeries'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['forum/utils/DiscussionControls'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['common/components/TextEditorButton'];","module.exports = flarum.core.compat['forum/components/ReplyComposer'];","module.exports = flarum.core.compat['common/helpers/avatar'];","module.exports = flarum.core.compat['common/helpers/highlight'];","module.exports = flarum.core.compat['forum/utils/KeyboardNavigatable'];","module.exports = flarum.core.compat['common/utils/string'];","module.exports = flarum.core.compat['common/utils/throttleDebounce'];","module.exports = flarum.core.compat['components/UserPage'];","module.exports = flarum.core.compat['components/LinkButton'];","module.exports = flarum.core.compat['components/PostsUserPage'];","/**\n * Whether to use the old mentions format.\n *\n * `'@username'` or `'@\"Display name\"'`\n */\nexport const shouldUseOldFormat = () => app.forum.attribute('allowUsernameMentionFormat') || false;\n\nconst getDeletedUserText = () => app.translator.trans('core.lib.username.deleted_text');\n\n/**\n * Fetches a user's username or display name.\n *\n * Chooses based on the format option set in the admin settings page.\n *\n * @param user An instance of the User model to fetch the username for\n * @param useDisplayName If `true`, uses `user.displayName()`, otherwise, uses `user.username()`\n */\nexport default function getCleanDisplayName(user, useDisplayName = true) {\n  if (!user) return getDeletedUserText().replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n\n  const text = (useDisplayName ? user.displayName() : user.username()) || getDeletedUserText();\n\n  return text.replace(/\"#[a-z]{0,3}[0-9]+/, '_');\n}\n","import getCleanDisplayName, { ShouldUseOldFormat } from './getCleanDisplayName';\n\n/**\n * Fetches the mention text for a specified user (and optionally a post ID for replies).\n *\n * Automatically determines which mention syntax to be used based on the option in the\n * admin dashboard. Also performs display name clean-up automatically.\n *\n * @example <caption>New display name syntax</caption>\n * // '@\"User\"#1'\n * getMentionText(User) // User is ID 1, display name is 'User'\n *\n * @example <caption>Replying</caption>\n * // '@\"User\"#p13'\n * getMentionText(User, 13) // User display name is 'User', post ID is 13\n *\n * @example <caption>Using old syntax</caption>\n * // '@username'\n * getMentionText(User) // User's username is 'username'\n */\nexport default function getMentionText(user, postId) {\n  if (postId === undefined) {\n    if (ShouldUseOldFormat()) {\n      // Plain @username\n      const cleanText = getCleanDisplayName(user, false);\n      return `@${cleanText}`;\n    }\n    // @\"Display name\"#UserID\n    const cleanText = getCleanDisplayName(user);\n    return `@\"${cleanText}\"${user.id()}`;\n  } else {\n    // @\"Display name\"#pPostID\n    const cleanText = getCleanDisplayName(user);\n    return `@\"${cleanText}\"#p${postId}`;\n  }\n}\n","import DiscussionControls from 'flarum/forum/utils/DiscussionControls';\nimport EditPostComposer from 'flarum/forum/components/EditPostComposer';\nimport getMentionText from './getMentionText';\n\nfunction insertMention(post, composer, quote) {\n  const user = post.user();\n  const mention = getMentionText(user, post.id());\n\n  // If the composer is empty, then assume we're starting a new reply.\n  // In which case we don't want the user to have to confirm if they\n  // close the composer straight away.\n  if (!composer.fields.content()) {\n    composer.body.attrs.originalContent = mention;\n  }\n\n  const cursorPosition = composer.editor.getSelectionRange()[0];\n  const preceding = composer.fields.content().slice(0, cursorPosition);\n  const precedingNewlines = preceding.length == 0 ? 0 : 3 - preceding.match(/(\\n{0,2})$/)[0].length;\n\n  composer.editor.insertAtCursor(\n    Array(precedingNewlines).join('\\n') + // Insert up to two newlines, depending on preceding whitespace\n      (quote ? '> ' + mention + quote.trim().replace(/\\n/g, '\\n> ') + '\\n\\n' : mention),\n    false\n  );\n}\n\nexport default function reply(post, quote) {\n  if (app.composer.bodyMatches(EditPostComposer) && app.composer.body.attrs.post.discussion() === post.discussion()) {\n    // If we're already editing a post in the discussion of post we're quoting,\n    // insert the mention directly.\n    insertMention(post, app.composer, quote);\n  } else {\n    // The default \"Reply\" action behavior will only open a new composer if\n    // necessary, but it will always be a ReplyComposer, hence the exceptional\n    // case above.\n    DiscussionControls.replyAction.call(post.discussion()).then((composer) => insertMention(post, composer, quote));\n  }\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import Fragment from 'flarum/Fragment';\nimport icon from 'flarum/helpers/icon';\n\nimport reply from '../utils/reply';\n\nexport default class PostQuoteButton extends Fragment {\n  constructor(post) {\n    super();\n\n    this.post = post;\n  }\n\n  view() {\n    return (\n      <button class=\"Button PostQuoteButton\" onclick={() => {\n        reply(this.post, this.content);\n      }}>\n        {icon('fas fa-quote-left', { className: 'Button-icon' })}\n        {app.translator.trans('flarum-mentions.forum.post.quote_button')}\n      </button>\n    );\n  }\n\n  show(left, top) {\n    const $this = this.$().show();\n    const parentOffset = $this.offsetParent().offset();\n\n    $this\n      .css('left', left - parentOffset.left)\n      .css('top', top - parentOffset.top);\n\n\n    this.hideHandler = this.hide.bind(this);\n    $(document).on('mouseup', this.hideHandler);\n  }\n\n  showStart(left, top) {\n    const $this = this.$();\n\n    this.show(left, $(window).scrollTop() + top - $this.outerHeight() - 5);\n  }\n\n  showEnd(right, bottom) {\n    const $this = this.$();\n\n    this.show(right - $this.outerWidth(), $(window).scrollTop() + bottom + 5);\n  }\n\n  hide() {\n    this.$().hide();\n    $(document).off('mouseup', this.hideHandler);\n  }\n}\n","import { extend } from 'flarum/extend';\nimport CommentPost from 'flarum/components/CommentPost';\n\nimport PostQuoteButton from './fragments/PostQuoteButton';\nimport selectedText from './utils/selectedText';\n\nexport default function addPostQuoteButton() {\n  extend(CommentPost.prototype, 'oncreate', function() {\n    const post = this.attrs.post;\n\n    if (post.isHidden() || (app.session.user && !post.discussion().canReply())) return;\n\n    const $postBody = this.$('.Post-body');\n\n    // Wrap the quote button in a wrapper element so that we can render\n    // button into it.\n    const $container = $('<div class=\"Post-quoteButtonContainer\"></div>');\n\n    const button = new PostQuoteButton(post);\n\n    const handler = function(e) {\n      setTimeout(() => {\n        const content = selectedText($postBody);\n        if (content) {\n          button.content = content;\n          m.render($container[0], button.render());\n\n          const rects = window.getSelection().getRangeAt(0).getClientRects();\n          const firstRect = rects[0];\n\n          if (e.clientY < firstRect.bottom && e.clientX - firstRect.right < firstRect.left - e.clientX) {\n            button.showStart(firstRect.left, firstRect.top);\n          } else {\n            const lastRect = rects[rects.length - 1];\n            button.showEnd(lastRect.right, lastRect.bottom);\n          }\n        }\n      }, 1);\n    };\n\n    this.$().after($container).on('mouseup', handler);\n\n    if ('ontouchstart' in window) {\n      document.addEventListener('selectionchange', handler, false);\n    }\n  });\n}\n","/**\n * Finds the selected text in the provided composer body.\n */\nexport default function selectedText(body) {\n  const selection = window.getSelection();\n\n  if (selection?.rangeCount) {\n    const range = selection.getRangeAt(0);\n    const parent = range.commonAncestorContainer;\n\n    if (body[0] === parent || $.contains(body[0], parent)) {\n      const clone = $('<div>').append(range.cloneContents());\n\n      // Replace emoji images with their shortcode (found in alt attribute)\n      clone.find('img.emoji').replaceWith(function () {\n        return this.alt;\n      });\n\n      // Replace all other images with a Markdown image\n      clone.find('img').replaceWith(function () {\n        return `![](${this.src})`;\n      });\n\n      // Replace all links with a Markdown link\n      clone.find('a').replaceWith(function () {\n        return `[${this.innerText}](${this.href})`;\n      });\n\n      return clone.text();\n    }\n  }\n  return '';\n}\n","import Fragment from 'flarum/Fragment';\n\nexport default class AutocompleteDropdown extends Fragment {\n  items = [];\n  active = false;\n  index = 0;\n  keyWasJustPressed = false;\n\n  view() {\n    return (\n      <ul className=\"Dropdown-menu MentionsDropdown\">\n        {this.items.map(item => <li>{item}</li>)}\n      </ul>\n    );\n  }\n\n  show(left, top) {\n    this.$().show().css({\n      left: left + 'px',\n      top: top + 'px'\n    });\n    this.active = true;\n  }\n\n  hide() {\n    this.$().hide();\n    this.active = false;\n  }\n\n  navigate(delta) {\n    this.keyWasJustPressed = true;\n    this.setIndex(this.index + delta, true);\n    clearTimeout(this.keyWasJustPressedTimeout);\n    this.keyWasJustPressedTimeout = setTimeout(() => this.keyWasJustPressed = false, 500);\n  }\n\n  complete() {\n    this.$('li').eq(this.index).find('button').click();\n  }\n\n  setIndex(index, scrollToItem) {\n    if (this.keyWasJustPressed && !scrollToItem) return;\n\n    const $dropdown = this.$();\n    const $items = $dropdown.find('li');\n    let rangedIndex = index;\n\n    if (rangedIndex < 0) {\n      rangedIndex = $items.length - 1;\n    } else if (rangedIndex >= $items.length) {\n      rangedIndex = 0;\n    }\n\n    this.index = rangedIndex;\n\n    const $item = $items.removeClass('active').eq(rangedIndex).addClass('active');\n\n    if (scrollToItem) {\n      const dropdownScroll = $dropdown.scrollTop();\n      const dropdownTop = $dropdown.offset().top;\n      const dropdownBottom = dropdownTop + $dropdown.outerHeight();\n      const itemTop = $item.offset().top;\n      const itemBottom = itemTop + $item.outerHeight();\n\n      let scrollTop;\n      if (itemTop < dropdownTop) {\n        scrollTop = dropdownScroll - dropdownTop + itemTop - parseInt($dropdown.css('padding-top'), 10);\n      } else if (itemBottom > dropdownBottom) {\n        scrollTop = dropdownScroll - dropdownBottom + itemBottom + parseInt($dropdown.css('padding-bottom'), 10);\n      }\n\n      if (typeof scrollTop !== 'undefined') {\n        $dropdown.stop(true).animate({ scrollTop }, 100);\n      }\n    }\n  }\n}\n","import { extend } from 'flarum/common/extend';\nimport TextEditor from 'flarum/common/components/TextEditor';\nimport TextEditorButton from 'flarum/common/components/TextEditorButton';\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\nimport EditPostComposer from 'flarum/forum/components/EditPostComposer';\nimport avatar from 'flarum/common/helpers/avatar';\nimport usernameHelper from 'flarum/common/helpers/username';\nimport highlight from 'flarum/common/helpers/highlight';\nimport KeyboardNavigatable from 'flarum/forum/utils/KeyboardNavigatable';\nimport { truncate } from 'flarum/common/utils/string';\nimport { throttle } from 'flarum/common/utils/throttleDebounce';\n\nimport AutocompleteDropdown from './fragments/AutocompleteDropdown';\nimport getMentionText from './utils/getMentionText';\n\nconst throttledSearch = throttle(\n  250, // 250ms timeout\n  function (typed, searched, returnedUsers, returnedUserIds, dropdown, buildSuggestions) {\n    const typedLower = typed.toLowerCase();\n    if (!searched.includes(typedLower)) {\n      app.store.find('users', { filter: { q: typed }, page: { limit: 5 } }).then((results) => {\n        results.forEach((u) => {\n          if (!returnedUserIds.has(u.id())) {\n            returnedUserIds.add(u.id());\n            returnedUsers.push(u);\n          }\n        });\n        if (dropdown.active) buildSuggestions();\n      });\n      searched.push(typedLower);\n    }\n  }\n);\n\nexport default function addComposerAutocomplete() {\n  const $container = $('<div class=\"ComposerBody-mentionsDropdownContainer\"></div>');\n  const dropdown = new AutocompleteDropdown();\n\n  extend(TextEditor.prototype, 'oncreate', function () {\n    const $editor = this.$('.TextEditor-editor').wrap('<div class=\"ComposerBody-mentionsWrapper\"></div>');\n\n    this.navigator = new KeyboardNavigatable();\n    this.navigator\n      .when(() => dropdown.active)\n      .onUp(() => dropdown.navigate(-1))\n      .onDown(() => dropdown.navigate(1))\n      .onSelect(dropdown.complete.bind(dropdown))\n      .onCancel(dropdown.hide.bind(dropdown))\n      .bindTo($editor);\n\n    $editor.after($container);\n  });\n\n  extend(TextEditor.prototype, 'buildEditorParams', function (params) {\n    const searched = [];\n    let relMentionStart;\n    let absMentionStart;\n    let typed;\n    let matchTyped;\n\n    // We store users returned from an API here to preserve order in which they are returned\n    // This prevents the user list jumping around while users are returned.\n    // We also use a hashset for user IDs to provide O(1) lookup for the users already in the list.\n    const returnedUsers = Array.from(app.store.all('users'));\n    const returnedUserIds = new Set(returnedUsers.map((u) => u.id()));\n\n    const applySuggestion = (replacement) => {\n      app.composer.editor.replaceBeforeCursor(absMentionStart - 1, replacement + ' ');\n\n      dropdown.hide();\n    };\n\n    params.inputListeners.push(function () {\n      const selection = app.composer.editor.getSelectionRange();\n\n      const cursor = selection[0];\n\n      if (selection[1] - cursor > 0) return;\n\n      // Search backwards from the cursor for an '@' symbol. If we find one,\n      // we will want to show the autocomplete dropdown!\n      const lastChunk = app.composer.editor.getLastNChars(30);\n      absMentionStart = 0;\n      for (let i = lastChunk.length - 1; i >= 0; i--) {\n        const character = lastChunk.substr(i, 1);\n        if (character === '@' && (i == 0 || /\\s/.test(lastChunk.substr(i - 1, 1)))) {\n          relMentionStart = i + 1;\n          absMentionStart = cursor - lastChunk.length + i + 1;\n          break;\n        }\n      }\n\n      dropdown.hide();\n      dropdown.active = false;\n\n      if (absMentionStart) {\n        typed = lastChunk.substring(relMentionStart).toLowerCase();\n        matchTyped = typed.match(/^[\"|“]((?:(?!\"#).)+)$/);\n        typed = (matchTyped && matchTyped[1]) || typed;\n\n        const makeSuggestion = function (user, replacement, content, className = '') {\n          const username = usernameHelper(user);\n\n          if (typed) {\n            username.children = [highlight(username.text, typed)];\n            delete username.text;\n          }\n\n          return (\n            <button\n              className={'PostPreview ' + className}\n              onclick={() => applySuggestion(replacement)}\n              onmouseenter={function () {\n                dropdown.setIndex($(this).parent().index());\n              }}\n            >\n              <span className=\"PostPreview-content\">\n                {avatar(user)}\n                {username} {content}\n              </span>\n            </button>\n          );\n        };\n\n        const userMatches = function (user) {\n          const names = [user.username(), user.displayName()];\n\n          return names.some((name) => name.toLowerCase().substr(0, typed.length) === typed);\n        };\n\n        const buildSuggestions = () => {\n          const suggestions = [];\n\n          // If the user has started to type a username, then suggest users\n          // matching that username.\n          if (typed) {\n            returnedUsers.forEach((user) => {\n              if (!userMatches(user)) return;\n\n              suggestions.push(makeSuggestion(user, getMentionText(user), '', 'MentionsDropdown-user'));\n            });\n          }\n\n          // If the user is replying to a discussion, or if they are editing a\n          // post, then we can suggest other posts in the discussion to mention.\n          // We will add the 5 most recent comments in the discussion which\n          // match any username characters that have been typed.\n          if (app.composer.bodyMatches(ReplyComposer) || app.composer.bodyMatches(EditPostComposer)) {\n            const composerAttrs = app.composer.body.attrs;\n            const composerPost = composerAttrs.post;\n            const discussion = (composerPost && composerPost.discussion()) || composerAttrs.discussion;\n\n            if (discussion) {\n              discussion\n                .posts()\n                // Filter to only comment posts, and replies before this message\n                .filter((post) => post && post.contentType() === 'comment' && (!composerPost || post.number() < composerPost.number()))\n                // Sort by new to old\n                .sort((a, b) => b.createdAt() - a.createdAt())\n                // Filter to where the user matches what is being typed\n                .filter((post) => {\n                  const user = post.user();\n                  return user && userMatches(user);\n                })\n                // Get the first 5\n                .splice(0, 5)\n                // Make the suggestions\n                .forEach((post) => {\n                  const user = post.user();\n                  suggestions.push(\n                    makeSuggestion(\n                      user,\n                      getMentionText(user, post.id()),\n                      [\n                        app.translator.trans('flarum-mentions.forum.composer.reply_to_post_text', { number: post.number() }),\n                        ' — ',\n                        truncate(post.contentPlain(), 200),\n                      ],\n                      'MentionsDropdown-post'\n                    )\n                  );\n                });\n            }\n          }\n\n          if (suggestions.length) {\n            dropdown.items = suggestions;\n            m.render($container[0], dropdown.render());\n\n            dropdown.show();\n            const coordinates = app.composer.editor.getCaretCoordinates(absMentionStart);\n            const width = dropdown.$().outerWidth();\n            const height = dropdown.$().outerHeight();\n            const parent = dropdown.$().offsetParent();\n            let left = coordinates.left;\n            let top = coordinates.top + 15;\n\n            // Keep the dropdown inside the editor.\n            if (top + height > parent.height()) {\n              top = coordinates.top - height - 15;\n            }\n            if (left + width > parent.width()) {\n              left = parent.width() - width;\n            }\n\n            // Prevent the dropdown from going off screen on mobile\n            top = Math.max(-(parent.offset().top - $(document).scrollTop()), top);\n            left = Math.max(-parent.offset().left, left);\n\n            dropdown.show(left, top);\n          } else {\n            dropdown.active = false;\n            dropdown.hide();\n          }\n        };\n\n        dropdown.active = true;\n\n        buildSuggestions();\n\n        dropdown.setIndex(0);\n        dropdown.$().scrollTop(0);\n\n        // Don't send API calls searching for users until at least 2 characters have been typed.\n        // This focuses the mention results on users and posts in the discussion.\n        if (typed.length > 1) {\n          throttledSearch(typed, searched, returnedUsers, returnedUserIds, dropdown, buildSuggestions);\n        }\n      }\n    });\n  });\n\n  extend(TextEditor.prototype, 'toolbarItems', function (items) {\n    items.add(\n      'mention',\n      <TextEditorButton onclick={() => this.attrs.composer.editor.insertAtCursor(' @')} icon=\"fas fa-at\">\n        {app.translator.trans('flarum-mentions.forum.composer.mention_tooltip')}\n      </TextEditorButton>\n    );\n  });\n}\n","import Notification from 'flarum/components/Notification';\nimport { truncate } from 'flarum/utils/string';\n\nexport default class PostMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-reply';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const post = notification.subject();\n    const content = notification.content();\n\n    return app.route.discussion(post.discussion(), content && content.replyNumber);\n  }\n\n  content() {\n    const notification = this.attrs.notification;\n    const user = notification.fromUser();\n\n    return app.translator.trans('flarum-mentions.forum.notifications.post_mentioned_text', {user, count: 1});\n  }\n\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\n","import Notification from 'flarum/components/Notification';\nimport { truncate } from 'flarum/utils/string';\n\nexport default class UserMentionedNotification extends Notification {\n  icon() {\n    return 'fas fa-at';\n  }\n\n  href() {\n    const post = this.attrs.notification.subject();\n\n    return app.route.discussion(post.discussion(), post.number());\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n\n    return app.translator.trans('flarum-mentions.forum.notifications.user_mentioned_text', {user});\n  }\n\n  excerpt() {\n    return truncate(this.attrs.notification.subject().contentPlain(), 200);\n  }\n}\n","import PostsUserPage from 'flarum/components/PostsUserPage';\n\n/**\n * The `MentionsUserPage` component shows post which user Mentioned at\n */\nexport default class MentionsUserPage extends PostsUserPage {\n  /**\n   * Load a new page of the user's activity feed.\n   *\n   * @param {Integer} [offset] The position to start getting results from.\n   * @return {Promise}\n   * @protected\n   */\n  loadResults(offset) {\n    return app.store.find('posts', {\n      filter: {\n        type: 'comment',\n        mentioned: this.user.id()\n      },\n      page: {offset, limit: this.loadLimit},\n      sort: '-createdAt'\n    });\n  }\n}\n","import username from 'flarum/helpers/username';\nimport extractText from 'flarum/utils/extractText';\n\nexport function filterUserMentions(tag) {\n  let user;\n\n  if (app.forum.attribute('allowUsernameMentionFormat') && tag.hasAttribute('username'))\n    user = app.store.getBy('users', 'username', tag.getAttribute('username'));\n  else if (tag.hasAttribute('id'))\n    user = app.store.getById('users', tag.getAttribute('id'));\n\n  if (user) {\n    tag.setAttribute('id', user.id());\n    tag.setAttribute('slug', user.slug());\n    tag.setAttribute('displayname', extractText(username(user)));\n\n    return true;\n  }\n\n  tag.invalidate();\n}\n\nexport function filterPostMentions(tag) {\n  const post = app.store.getById('posts', tag.getAttribute('id'));\n\n  if (post) {\n    tag.setAttribute('discussionid', post.discussion().id());\n    tag.setAttribute('number', post.number());\n    tag.setAttribute('displayname', extractText(username(post.user())));\n\n    return true;\n  }\n}\n","import { extend } from 'flarum/extend';\nimport app from 'flarum/app';\nimport NotificationGrid from 'flarum/components/NotificationGrid';\nimport { getPlainContent } from 'flarum/utils/string';\n\nimport addPostMentionPreviews from './addPostMentionPreviews';\nimport addMentionedByList from './addMentionedByList';\nimport addPostReplyAction from './addPostReplyAction';\nimport addPostQuoteButton from './addPostQuoteButton';\nimport addComposerAutocomplete from './addComposerAutocomplete';\nimport PostMentionedNotification from './components/PostMentionedNotification';\nimport UserMentionedNotification from './components/UserMentionedNotification';\nimport UserPage from 'flarum/components/UserPage'\nimport LinkButton from 'flarum/components/LinkButton';\nimport MentionsUserPage from './components/MentionsUserPage';\n\napp.initializers.add('flarum-mentions', function() {\n  // For every mention of a post inside a post's content, set up a hover handler\n  // that shows a preview of the mentioned post.\n  addPostMentionPreviews();\n\n  // In the footer of each post, show information about who has replied (i.e.\n  // who the post has been mentioned by).\n  addMentionedByList();\n\n  // Add a 'reply' control to the footer of each post. When clicked, it will\n  // open up the composer and add a post mention to its contents.\n  addPostReplyAction();\n\n  // Show a Quote button when Post text is selected\n  addPostQuoteButton();\n\n  // After typing '@' in the composer, show a dropdown suggesting a bunch of\n  // posts or users that the user could mention.\n  addComposerAutocomplete();\n\n  app.notificationComponents.postMentioned = PostMentionedNotification;\n  app.notificationComponents.userMentioned = UserMentionedNotification;\n\n  // Add notification preferences.\n  extend(NotificationGrid.prototype, 'notificationTypes', function(items) {\n    items.add('postMentioned', {\n      name: 'postMentioned',\n      icon: 'fas fa-reply',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_post_mentioned_label')\n    });\n\n    items.add('userMentioned', {\n      name: 'userMentioned',\n      icon: 'fas fa-at',\n      label: app.translator.trans('flarum-mentions.forum.settings.notify_user_mentioned_label')\n    });\n  });\n\n  // Add mentions tab in user profile\n  app.routes['user.mentions'] = {path: '/u/:username/mentions', component: MentionsUserPage};\n  extend(UserPage.prototype, 'navItems', function(items) {\n    const user = this.user;\n    items.add('mentions',\n      LinkButton.component({\n        href: app.route('user.mentions', {username: user.slug()}),\n        name: 'mentions',\n        icon: 'fas fa-at'\n      }, app.translator.trans('flarum-mentions.forum.user.mentions_link')),\n      80\n    );\n  });\n\n  // Remove post mentions when rendering post previews.\n  getPlainContent.removeSelectors.push('a.PostMention');\n});\n\nexport * from './utils/textFormatter';\n","import { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default function addPostMentionPreviews() {\n  function addPreviews() {\n    const contentHtml = this.attrs.post.contentHtml();\n\n    if (contentHtml === this.oldPostContentHtml || this.isEditing()) return;\n\n    this.oldPostContentHtml = contentHtml;\n\n    const parentPost = this.attrs.post;\n    const $parentPost = this.$();\n\n    this.$().on('click', '.UserMention:not(.UserMention--deleted), .PostMention:not(.PostMention--deleted)', function (e) {\n      m.route.set(this.getAttribute('href'));\n      e.preventDefault();\n    });\n\n    this.$('.PostMention:not(.PostMention--deleted)').each(function () {\n      const $this = $(this);\n      const id = $this.data('id');\n      let timeout;\n\n      // Wrap the mention link in a wrapper element so that we can insert a\n      // preview popup as its sibling and relatively position it.\n      const $preview = $('<ul class=\"Dropdown-menu PostMention-preview fade\"/>');\n      $parentPost.append($preview);\n\n      const getPostElement = () => {\n        return $(`.PostStream-item[data-id=\"${id}\"]`);\n      };\n\n      const showPreview = () => {\n        // When the user hovers their mouse over the mention, look for the\n        // post that it's referring to in the stream, and determine if it's\n        // in the viewport. If it is, we will \"pulsate\" it.\n        const $post = getPostElement();\n        let visible = false;\n        if ($post.length) {\n          const top = $post.offset().top;\n          const scrollTop = window.pageYOffset;\n          if (top > scrollTop && top + $post.height() < scrollTop + $(window).height()) {\n            $post.addClass('pulsate');\n            visible = true;\n          }\n        }\n\n        // Otherwise, we will show a popup preview of the post. If the post\n        // hasn't yet been loaded, we will need to do that.\n        if (!visible) {\n          // Position the preview so that it appears above the mention.\n          // (The offsetParent should be .Post-body.)\n          const positionPreview = () => {\n            const previewHeight = $preview.outerHeight(true);\n            let offset = 0;\n\n            // If the preview goes off the top of the viewport, reposition it to\n            // be below the mention.\n            if ($this.offset().top - previewHeight < $(window).scrollTop() + $('#header').outerHeight()) {\n              offset += $this.outerHeight(true);\n            } else {\n              offset -= previewHeight;\n            }\n\n            $preview\n              .show()\n              .css('top', $this.offset().top - $parentPost.offset().top + offset)\n              .css('left', $this.offsetParent().offset().left - $parentPost.offset().left)\n              .css('max-width', $this.offsetParent().width());\n          };\n\n          const showPost = (post) => {\n            const discussion = post.discussion();\n\n            m.render($preview[0], [\n              discussion !== parentPost.discussion() ? (\n                <li>\n                  <span className=\"PostMention-preview-discussion\">{discussion.title()}</span>\n                </li>\n              ) : (\n                ''\n              ),\n              <li>{PostPreview.component({ post })}</li>,\n            ]);\n            positionPreview();\n          };\n\n          const post = app.store.getById('posts', id);\n          if (post && post.discussion()) {\n            showPost(post);\n          } else {\n            m.render($preview[0], LoadingIndicator.component());\n            app.store.find('posts', id).then(showPost);\n            positionPreview();\n          }\n\n          setTimeout(() => $preview.off('transitionend').addClass('in'));\n        }\n      };\n\n      const hidePreview = () => {\n        getPostElement().removeClass('pulsate');\n        if ($preview.hasClass('in')) {\n          $preview.removeClass('in').one('transitionend', () => $preview.hide());\n        }\n      };\n\n      // On a touch (mobile) device we cannot hover the link to reveal the preview.\n      // Instead we cancel the navigation so that a click reveals the preview.\n      // Users can then click on the preview to go to the post if desired.\n      $this.on('touchend', (e) => {\n        if (e.cancelable) {\n          e.preventDefault();\n        }\n      });\n\n      $this\n        .add($preview)\n        .hover(\n          () => {\n            clearTimeout(timeout);\n            timeout = setTimeout(showPreview, 250);\n          },\n          () => {\n            clearTimeout(timeout);\n            getPostElement().removeClass('pulsate');\n            timeout = setTimeout(hidePreview, 250);\n          }\n        )\n        .on('touchend', (e) => {\n          showPreview();\n          e.stopPropagation();\n        });\n\n      $(document).on('touchend', hidePreview);\n    });\n  }\n\n  extend(CommentPost.prototype, 'oncreate', addPreviews);\n  extend(CommentPost.prototype, 'onupdate', addPreviews);\n}\n","import { extend } from 'flarum/common/extend';\nimport Model from 'flarum/common/Model';\nimport Post from 'flarum/common/models/Post';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport Link from 'flarum/common/components/Link';\nimport PostPreview from 'flarum/forum/components/PostPreview';\nimport punctuateSeries from 'flarum/common/helpers/punctuateSeries';\nimport username from 'flarum/common/helpers/username';\nimport icon from 'flarum/common/helpers/icon';\n\nexport default function addMentionedByList() {\n  Post.prototype.mentionedBy = Model.hasMany('mentionedBy');\n\n  function hidePreview() {\n    this.$('.Post-mentionedBy-preview')\n      .removeClass('in')\n      .one('transitionend', function () {\n        $(this).hide();\n      });\n  }\n\n  extend(CommentPost.prototype, 'oncreate', function () {\n    let timeout;\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n\n    if (replies && replies.length) {\n      const $preview = $('<ul class=\"Dropdown-menu Post-mentionedBy-preview fade\"/>');\n      this.$().append($preview);\n\n      const $parentPost = this.$();\n      const $this = this.$('.Post-mentionedBy');\n\n      const showPreview = () => {\n        if (!$preview.hasClass('in') && $preview.is(':visible')) return;\n\n        // When the user hovers their mouse over the list of people who have\n        // replied to the post, render a list of reply previews into a\n        // popup.\n        m.render(\n          $preview[0],\n          replies.map((reply) => (\n            <li data-number={reply.number()}>\n              {PostPreview.component({\n                post: reply,\n                onclick: hidePreview.bind(this),\n              })}\n            </li>\n          ))\n        );\n\n        $preview\n          .show()\n          .css('top', $this.offset().top - $parentPost.offset().top + $this.outerHeight(true))\n          .css('left', $this.offsetParent().offset().left - $parentPost.offset().left)\n          .css('max-width', $parentPost.width());\n\n        setTimeout(() => $preview.off('transitionend').addClass('in'));\n      };\n\n      $this.add($preview).hover(\n        () => {\n          clearTimeout(timeout);\n          timeout = setTimeout(showPreview, 250);\n        },\n        () => {\n          clearTimeout(timeout);\n          timeout = setTimeout(hidePreview, 250);\n        }\n      );\n\n      // Whenever the user hovers their mouse over a particular name in the\n      // list of repliers, highlight the corresponding post in the preview\n      // popup.\n      this.$()\n        .find('.Post-mentionedBy-summary a')\n        .hover(\n          function () {\n            $preview.find('[data-number=\"' + $(this).data('number') + '\"]').addClass('active');\n          },\n          function () {\n            $preview.find('[data-number]').removeClass('active');\n          }\n        );\n    }\n  });\n\n  extend(CommentPost.prototype, 'footerItems', function (items) {\n    const post = this.attrs.post;\n    const replies = post.mentionedBy();\n\n    if (replies && replies.length) {\n      const users = [];\n      const repliers = replies\n        .sort((reply) => (reply.user() === app.session.user ? -1 : 0))\n        .filter((reply) => {\n          const user = reply.user();\n          if (users.indexOf(user) === -1) {\n            users.push(user);\n            return true;\n          }\n        });\n\n      const limit = 4;\n      const overLimit = repliers.length > limit;\n\n      // Create a list of unique users who have replied. So even if a user has\n      // replied twice, they will only be in this array once.\n      const names = repliers.slice(0, overLimit ? limit - 1 : limit).map((reply) => {\n        const user = reply.user();\n\n        return (\n          <Link href={app.route.post(reply)} onclick={hidePreview.bind(this)} data-number={reply.number()}>\n            {app.session.user === user ? app.translator.trans('flarum-mentions.forum.post.you_text') : username(user)}\n          </Link>\n        );\n      });\n\n      // If there are more users that we've run out of room to display, add a \"x\n      // others\" name to the end of the list. Clicking on it will display a modal\n      // with a full list of names.\n      if (overLimit) {\n        const count = repliers.length - names.length;\n\n        names.push(app.translator.trans('flarum-mentions.forum.post.others_text', { count }));\n      }\n\n      items.add(\n        'replies',\n        <div className=\"Post-mentionedBy\">\n          <span className=\"Post-mentionedBy-summary\">\n            {icon('fas fa-reply')}\n            {app.translator.trans('flarum-mentions.forum.post.mentioned_by' + (repliers[0].user() === app.session.user ? '_self' : '') + '_text', {\n              count: names.length,\n              users: punctuateSeries(names),\n            })}\n          </span>\n        </div>\n      );\n    }\n  });\n}\n","import { extend } from 'flarum/extend';\nimport Button from 'flarum/components/Button';\nimport CommentPost from 'flarum/components/CommentPost';\n\nimport reply from './utils/reply';\n\nexport default function () {\n  extend(CommentPost.prototype, 'actionItems', function (items) {\n\n    const post = this.attrs.post;\n\n    if (post.isHidden() || (app.session.user && !post.discussion().canReply())) return;\n\n    items.add('reply',\n      <Button className='Button Button--link' onclick={() => reply(post)}>\n        {app.translator.trans('flarum-mentions.forum.post.reply_link')}\n      </Button>\n    );\n  });\n}\n"],"sourceRoot":""}