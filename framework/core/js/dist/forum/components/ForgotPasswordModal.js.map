{"version":3,"file":"forum/components/ForgotPasswordModal.js","mappings":"0NAYe,MAAMA,UAA4B,IAC/CC,cACEC,SAASC,YAIT,OAAgBC,KAAM,aAAS,IAC/B,OAAgBA,KAAM,WAAW,EACnC,CACAC,OAAOC,GACLJ,MAAMG,OAAOC,GACbF,KAAKG,OAAQ,OAAOH,KAAKI,MAAMD,OAAS,GAC1C,CACAE,YACE,MAAO,kCACT,CACAC,QACE,OAAO,qBAAqB,mCAC9B,CACAC,UACE,OAAIP,KAAKQ,QACAC,EAAE,MAAO,CACdJ,UAAW,cACVI,EAAE,IAAM,CACTJ,UAAW,kBACVI,EAAE,IAAK,CACRJ,UAAW,YACV,qBAAqB,kDAAmDI,EAAE,MAAO,CAClFJ,UAAW,4BACVI,EAAE,IAAQ,CACXJ,UAAW,uCACXK,QAASV,KAAKW,KAAKC,KAAKZ,OACvB,qBAAqB,iDAEnBS,EAAE,MAAO,CACdJ,UAAW,cACVI,EAAE,IAAM,CACTJ,UAAW,iBACXQ,YAAa,qBAAqB,oCACjCb,KAAKc,SAASC,WACnB,CACAD,SACE,MAAME,EAAQ,IAAI,IACZC,GAAa,OAAY,qBAAqB,iDAmBpD,OAlBAD,EAAME,IAAI,QAAST,EAAE,MAAO,CAC1BJ,UAAW,cACVI,EAAE,QAAS,CACZJ,UAAW,cACXc,KAAM,QACNC,KAAM,QACNC,YAAaJ,EACb,aAAcA,EACdK,KAAMtB,KAAKG,MACXoB,SAAUvB,KAAKwB,WACZ,IACLR,EAAME,IAAI,SAAUT,EAAE,MAAO,CAC3BJ,UAAW,4BACVI,EAAE,IAAQ,CACXJ,UAAW,uCACXe,KAAM,SACNI,QAASxB,KAAKwB,SACb,qBAAqB,+CAAgD,IACjER,CACT,CACAS,SAASC,GACPA,EAAEC,iBACF3B,KAAKwB,SAAU,EACf,YAAY,CACVI,OAAQ,OACRC,IAAK,oBAAoB,UAAY,UACrCC,KAAM9B,KAAK+B,gBACXC,aAAchC,KAAKiC,QAAQrB,KAAKZ,QAC/BkC,MAAK,KACNlC,KAAKQ,SAAU,EACfR,KAAKmC,WAAa,IAAI,IACrBC,OAAM,SAAUF,KAAKlC,KAAKqC,OAAOzB,KAAKZ,MAC3C,CACA+B,gBAIE,MAHa,CACX5B,MAAOH,KAAKG,QAGhB,CACA8B,QAAQK,GACe,MAAjBA,EAAMC,QAAkBD,EAAME,QAChCF,EAAME,MAAMjC,QAAU,qBAAqB,iDAE7CT,MAAMmC,QAAQK,EAChB,EAEFG,OAAOC,IAAIxB,IAAI,OAAQ,uCAAwCtB,E","sources":["webpack://@flarum/core/./src/forum/components/ForgotPasswordModal.tsx"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport app from '../../forum/app';\nimport FormModal from '../../common/components/FormModal';\nimport Button from '../../common/components/Button';\nimport extractText from '../../common/utils/extractText';\nimport Stream from '../../common/utils/Stream';\nimport ItemList from '../../common/utils/ItemList';\nimport Form from '../../common/components/Form';\n/**\n * The `ForgotPasswordModal` component displays a modal which allows the user to\n * enter their email address and request a link to reset their password.\n */\nexport default class ForgotPasswordModal extends FormModal {\n  constructor() {\n    super(...arguments);\n    /**\n     * The value of the email input.\n     */\n    _defineProperty(this, \"email\", void 0);\n    _defineProperty(this, \"success\", false);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.email = Stream(this.attrs.email || '');\n  }\n  className() {\n    return 'ForgotPasswordModal Modal--small';\n  }\n  title() {\n    return app.translator.trans('core.forum.forgot_password.title');\n  }\n  content() {\n    if (this.success) {\n      return m(\"div\", {\n        className: \"Modal-body\"\n      }, m(Form, {\n        className: \"Form--centered\"\n      }, m(\"p\", {\n        className: \"helpText\"\n      }, app.translator.trans('core.forum.forgot_password.email_sent_message')), m(\"div\", {\n        className: \"Form-group Form-controls\"\n      }, m(Button, {\n        className: \"Button Button--primary Button--block\",\n        onclick: this.hide.bind(this)\n      }, app.translator.trans('core.forum.forgot_password.dismiss_button')))));\n    }\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(Form, {\n      className: \"Form--centered\",\n      description: app.translator.trans('core.forum.forgot_password.text')\n    }, this.fields().toArray()));\n  }\n  fields() {\n    const items = new ItemList();\n    const emailLabel = extractText(app.translator.trans('core.forum.forgot_password.email_placeholder'));\n    items.add('email', m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"input\", {\n      className: \"FormControl\",\n      name: \"email\",\n      type: \"email\",\n      placeholder: emailLabel,\n      \"aria-label\": emailLabel,\n      bidi: this.email,\n      disabled: this.loading\n    })), 50);\n    items.add('submit', m(\"div\", {\n      className: \"Form-group Form-controls\"\n    }, m(Button, {\n      className: \"Button Button--primary Button--block\",\n      type: \"submit\",\n      loading: this.loading\n    }, app.translator.trans('core.forum.forgot_password.submit_button'))), -10);\n    return items;\n  }\n  onsubmit(e) {\n    e.preventDefault();\n    this.loading = true;\n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/forgot',\n      body: this.requestParams(),\n      errorHandler: this.onerror.bind(this)\n    }).then(() => {\n      this.success = true;\n      this.alertAttrs = null;\n    }).catch(() => {}).then(this.loaded.bind(this));\n  }\n  requestParams() {\n    const data = {\n      email: this.email()\n    };\n    return data;\n  }\n  onerror(error) {\n    if (error.status === 404 && error.alert) {\n      error.alert.content = app.translator.trans('core.forum.forgot_password.not_found_message');\n    }\n    super.onerror(error);\n  }\n}\nflarum.reg.add('core', 'forum/components/ForgotPasswordModal', ForgotPasswordModal);"],"names":["ForgotPasswordModal","constructor","super","arguments","this","oninit","vnode","email","attrs","className","title","content","success","m","onclick","hide","bind","description","fields","toArray","items","emailLabel","add","name","type","placeholder","bidi","disabled","loading","onsubmit","e","preventDefault","method","url","body","requestParams","errorHandler","onerror","then","alertAttrs","catch","loaded","error","status","alert","flarum","reg"],"sourceRoot":""}