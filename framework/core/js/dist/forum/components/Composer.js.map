{"version":3,"file":"forum/components/Composer.js","mappings":"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","sources":["webpack://@flarum/core/./src/forum/components/ComposerButton.js","webpack://@flarum/core/./src/forum/components/Composer.js"],"sourcesContent":["import Button from '../../common/components/Button';\n\n/**\n * The `ComposerButton` component displays a button suitable for the composer\n * controls.\n */\nexport default class ComposerButton extends Button {\n  static initAttrs(attrs) {\n    super.initAttrs(attrs);\n    attrs.className = attrs.className || 'Button Button--icon Button--link';\n  }\n}\nflarum.reg.add('core', 'forum/components/ComposerButton', ComposerButton);","import app from '../../forum/app';\nimport Component from '../../common/Component';\nimport ItemList from '../../common/utils/ItemList';\nimport ComposerButton from './ComposerButton';\nimport listItems from '../../common/helpers/listItems';\nimport classList from '../../common/utils/classList';\nimport ComposerState from '../states/ComposerState';\n\n/**\n * The `Composer` component displays the composer. It can be loaded with a\n * content component with `load` and then its position/state can be altered with\n * `show`, `hide`, `close`, `minimize`, `fullScreen`, and `exitFullScreen`.\n */\nexport default class Composer extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    /**\n     * The composer's \"state\".\n     *\n     * @type {ComposerState}\n     */\n    this.state = this.attrs.state;\n\n    /**\n     * Whether or not the composer currently has focus.\n     *\n     * @type {Boolean}\n     */\n    this.active = false;\n\n    // Store the initial position so that we can trigger animations correctly.\n    this.prevPosition = this.state.position;\n  }\n  view() {\n    const body = this.state.body;\n    const classes = {\n      normal: this.state.position === ComposerState.Position.NORMAL,\n      minimized: this.state.position === ComposerState.Position.MINIMIZED,\n      fullScreen: this.state.position === ComposerState.Position.FULLSCREEN,\n      active: this.active,\n      visible: this.state.isVisible()\n    };\n\n    // Set up a handler so that clicks on the content will show the composer.\n    const showIfMinimized = this.state.position === ComposerState.Position.MINIMIZED ? this.state.show.bind(this.state) : undefined;\n    const ComposerBody = body.componentClass;\n    return m(\"div\", {\n      className: 'Composer ' + classList(classes)\n    }, m(\"div\", {\n      className: \"Composer-handle\",\n      oncreate: this.configHandle.bind(this)\n    }), m(\"ul\", {\n      className: \"Composer-controls\"\n    }, listItems(this.controlItems().toArray())), m(\"div\", {\n      className: \"Composer-content\",\n      onclick: showIfMinimized\n    }, ComposerBody && m(ComposerBody, Object.assign({}, body.attrs, {\n      composer: this.state,\n      disabled: classes.minimized\n    }))));\n  }\n  onupdate(vnode) {\n    super.onupdate(vnode);\n    if (this.state.position === this.prevPosition) {\n      // Set the height of the Composer element and its contents on each redraw,\n      // so that they do not lose it if their DOM elements are recreated.\n      this.updateHeight();\n    } else {\n      this.animatePositionChange();\n      this.prevPosition = this.state.position;\n    }\n  }\n  oncreate(vnode) {\n    super.oncreate(vnode);\n    this.initializeHeight();\n    this.$().hide().css('bottom', -this.state.computedHeight());\n\n    // Whenever any of the inputs inside the composer are have focus, we want to\n    // add a class to the composer to draw attention to it.\n    this.$().on('focus blur', ':input,.TextEditor-editorContainer', e => {\n      this.active = e.type === 'focusin';\n      m.redraw();\n    });\n\n    // When the escape key is pressed on any inputs, close the composer.\n    this.$().on('keydown', ':input,.TextEditor-editorContainer', 'esc', () => this.state.close());\n    this.handlers = {};\n    $(window).on('resize', this.handlers.onresize = this.updateHeight.bind(this)).resize();\n    $(document).on('mousemove', this.handlers.onmousemove = this.onmousemove.bind(this)).on('mouseup', this.handlers.onmouseup = this.onmouseup.bind(this));\n  }\n  onremove(vnode) {\n    super.onremove(vnode);\n    $(window).off('resize', this.handlers.onresize);\n    $(document).off('mousemove', this.handlers.onmousemove).off('mouseup', this.handlers.onmouseup);\n  }\n\n  /**\n   * Add the necessary event handlers to the composer's handle so that it can\n   * be used to resize the composer.\n   */\n  configHandle(vnode) {\n    const composer = this;\n    $(vnode.dom).css('cursor', 'row-resize').bind('dragstart mousedown', e => e.preventDefault()).mousedown(function (e) {\n      composer.mouseStart = e.clientY;\n      composer.heightStart = composer.$().height();\n      composer.handle = $(this);\n      $('body').css('cursor', 'row-resize');\n    });\n  }\n\n  /**\n   * Resize the composer according to mouse movement.\n   *\n   * @param {MouseEvent} e\n   */\n  onmousemove(e) {\n    if (!this.handle) return;\n\n    // Work out how much the mouse has been moved, and set the height\n    // relative to the old one based on that. Then update the content's\n    // height so that it fills the height of the composer, and update the\n    // body's padding.\n    const deltaPixels = this.mouseStart - e.clientY;\n    this.changeHeight(this.heightStart + deltaPixels);\n\n    // Update the body's padding-bottom so that no content on the page will ever\n    // get permanently hidden behind the composer. If the user is already\n    // scrolled to the bottom of the page, then we will keep them scrolled to\n    // the bottom after the padding has been updated.\n    const scrollTop = $(window).scrollTop();\n    const anchorToBottom = scrollTop > 0 && scrollTop + $(window).height() >= $(document).height();\n    this.updateBodyPadding(anchorToBottom);\n  }\n\n  /**\n   * Finish resizing the composer when the mouse is released.\n   */\n  onmouseup() {\n    if (!this.handle) return;\n    this.handle = null;\n    $('body').css('cursor', '');\n  }\n\n  /**\n   * Draw focus to the first focusable content element (the text editor).\n   */\n  focus() {\n    var _this$attrs$state$bod, _this$attrs$state$bod2;\n    this.$(((_this$attrs$state$bod = (_this$attrs$state$bod2 = this.attrs.state.body.componentClass).focusOnSelector) == null ? void 0 : _this$attrs$state$bod.call(_this$attrs$state$bod2)) || '.Composer-content :input:enabled:visible, .TextEditor-editor').first().focus();\n  }\n\n  /**\n   * Update the DOM to reflect the composer's current height. This involves\n   * setting the height of the composer's root element, and adjusting the height\n   * of any flexible elements inside the composer's body.\n   */\n  updateHeight() {\n    const height = this.state.computedHeight();\n    const $flexible = this.$('.Composer-flexible');\n    this.$().height(height);\n    if ($flexible.length) {\n      const headerHeight = $flexible.offset().top - this.$().offset().top;\n      const paddingBottom = parseInt($flexible.css('padding-bottom'), 10);\n      const footerHeight = this.$('.Composer-footer').outerHeight(true);\n      $flexible.height(this.$().outerHeight() - headerHeight - paddingBottom - footerHeight);\n    }\n  }\n\n  /**\n   * Update the amount of padding-bottom on the body so that the page's\n   * content will still be visible above the composer when the page is\n   * scrolled right to the bottom.\n   */\n  updateBodyPadding() {\n    const visible = this.state.position !== ComposerState.Position.HIDDEN && this.state.position !== ComposerState.Position.MINIMIZED && app.screen() !== 'phone';\n    const paddingBottom = visible ? this.state.computedHeight() - parseInt($('#app').css('padding-bottom'), 10) : 0;\n    $('#content').css({\n      paddingBottom\n    });\n  }\n\n  /**\n   * Trigger the right animation depending on the desired new position.\n   */\n  animatePositionChange() {\n    // When exiting full-screen mode: focus content\n    if (this.prevPosition === ComposerState.Position.FULLSCREEN && this.state.position === ComposerState.Position.NORMAL) {\n      this.focus();\n      return;\n    }\n    switch (this.state.position) {\n      case ComposerState.Position.HIDDEN:\n        return this.hide();\n      case ComposerState.Position.MINIMIZED:\n        return this.minimize();\n      case ComposerState.Position.FULLSCREEN:\n        return this.focus();\n      case ComposerState.Position.NORMAL:\n        return this.show();\n    }\n  }\n\n  /**\n   * Animate the Composer into the new position by changing the height.\n   */\n  animateHeightChange() {\n    const $composer = this.$().stop(true);\n    const oldHeight = $composer.outerHeight();\n    const scrollTop = $(window).scrollTop();\n    $composer.show();\n    this.updateHeight();\n    const newHeight = $composer.outerHeight();\n    if (this.prevPosition === ComposerState.Position.HIDDEN) {\n      $composer.css({\n        bottom: -newHeight,\n        height: newHeight\n      });\n    } else {\n      $composer.css({\n        height: oldHeight\n      });\n    }\n    const animation = $composer.animate({\n      bottom: 0,\n      height: newHeight\n    }, 'fast').promise();\n    this.updateBodyPadding();\n    $(window).scrollTop(scrollTop);\n    return animation;\n  }\n\n  /**\n   * Show the Composer backdrop.\n   */\n  showBackdrop() {\n    this.$backdrop = $('<div/>').addClass('composer-backdrop').appendTo('body');\n  }\n\n  /**\n   * Hide the Composer backdrop.\n   */\n  hideBackdrop() {\n    if (this.$backdrop) this.$backdrop.remove();\n  }\n\n  /**\n   * Animate the composer sliding up from the bottom to take its normal height.\n   *\n   * @private\n   */\n  show() {\n    this.animateHeightChange().then(() => this.focus());\n    if (app.screen() === 'phone') {\n      // On safari fixed position doesn't properly work on mobile,\n      // So we use absolute and set the top value.\n      // https://github.com/flarum/core/issues/2652\n\n      // Due to another safari bug, `scrollTop` is unreliable when\n      // at the very bottom of the page AND opening the composer.\n      // So we fallback to a calculated version of scrollTop.\n      // https://github.com/flarum/core/issues/2683\n      const scrollElement = document.documentElement;\n      const topOfViewport = Math.min(scrollElement.scrollTop, scrollElement.scrollHeight - scrollElement.clientHeight);\n      this.$().css('top', $('.App').is('.mobile-safari') ? topOfViewport : 0);\n      this.showBackdrop();\n    }\n  }\n\n  /**\n   * Animate closing the composer.\n   *\n   * @private\n   */\n  hide() {\n    const $composer = this.$();\n\n    // Animate the composer sliding down off the bottom edge of the viewport.\n    // Only when the animation is completed, update other elements on the page.\n    $composer.stop(true).animate({\n      bottom: -$composer.height()\n    }, 'fast', () => {\n      $composer.hide();\n      this.hideBackdrop();\n      this.updateBodyPadding();\n    });\n  }\n\n  /**\n   * Shrink the composer until only its title is visible.\n   *\n   * @private\n   */\n  minimize() {\n    this.animateHeightChange();\n    this.$().css('top', 'auto');\n    this.hideBackdrop();\n  }\n\n  /**\n   * Build an item list for the composer's controls.\n   *\n   * @return {ItemList<import('mithril').Children>}\n   */\n  controlItems() {\n    const items = new ItemList();\n    if (this.state.position === ComposerState.Position.FULLSCREEN) {\n      items.add('exitFullScreen', m(ComposerButton, {\n        icon: \"fas fa-compress\",\n        title: app.translator.trans('core.forum.composer.exit_full_screen_tooltip'),\n        onclick: this.state.exitFullScreen.bind(this.state)\n      }));\n    } else {\n      if (this.state.position !== ComposerState.Position.MINIMIZED) {\n        items.add('minimize', m(ComposerButton, {\n          icon: classList('fas minimize', {\n            'fa-minus': app.screen() !== 'phone',\n            'fa-times': app.screen() === 'phone'\n          }),\n          title: app.translator.trans('core.forum.composer.minimize_tooltip'),\n          onclick: this.state.minimize.bind(this.state),\n          itemClassName: \"App-backControl\"\n        }));\n        items.add('fullScreen', m(ComposerButton, {\n          icon: \"fas fa-expand\",\n          title: app.translator.trans('core.forum.composer.full_screen_tooltip'),\n          onclick: this.state.fullScreen.bind(this.state)\n        }));\n      }\n      items.add('close', m(ComposerButton, {\n        icon: \"fas fa-times\",\n        title: app.translator.trans('core.forum.composer.close_tooltip'),\n        onclick: this.state.close.bind(this.state)\n      }));\n    }\n    return items;\n  }\n\n  /**\n   * Initialize default Composer height.\n   */\n  initializeHeight() {\n    this.state.height = localStorage.getItem('composerHeight');\n    if (!this.state.height) {\n      this.state.height = this.defaultHeight();\n    }\n  }\n\n  /**\n   * Default height of the Composer in case none is saved.\n   * @returns {number}\n   */\n  defaultHeight() {\n    return this.$().height();\n  }\n\n  /**\n   * Save a new Composer height and update the DOM.\n   * @param {number} height\n   */\n  changeHeight(height) {\n    this.state.height = height;\n    this.updateHeight();\n    localStorage.setItem('composerHeight', this.state.height);\n  }\n}\nflarum.reg.add('core', 'forum/components/Composer', Composer);"],"names":["ComposerButton","Button","static","attrs","super","initAttrs","className","flarum","reg","add","Composer","Component","oninit","vnode","this","state","active","prevPosition","position","view","body","classes","normal","ComposerState","minimized","fullScreen","visible","isVisible","showIfMinimized","show","bind","undefined","ComposerBody","componentClass","m","classList","oncreate","configHandle","listItems","controlItems","toArray","onclick","Object","assign","composer","disabled","onupdate","updateHeight","animatePositionChange","initializeHeight","$","hide","css","computedHeight","on","e","type","redraw","close","handlers","window","onresize","resize","document","onmousemove","onmouseup","onremove","off","dom","preventDefault","mousedown","mouseStart","clientY","heightStart","height","handle","deltaPixels","changeHeight","scrollTop","anchorToBottom","updateBodyPadding","focus","_this$attrs$state$bod","_this$attrs$state$bod2","focusOnSelector","call","first","$flexible","length","headerHeight","offset","top","paddingBottom","parseInt","footerHeight","outerHeight","app","minimize","animateHeightChange","$composer","stop","oldHeight","newHeight","bottom","animation","animate","promise","showBackdrop","$backdrop","addClass","appendTo","hideBackdrop","remove","then","scrollElement","documentElement","topOfViewport","Math","min","scrollHeight","clientHeight","is","items","ItemList","icon","title","exitFullScreen","itemClassName","localStorage","getItem","defaultHeight","setItem"],"sourceRoot":""}